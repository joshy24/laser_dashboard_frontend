{"ast":null,"code":"var _jsxFileName = \"/Users/user/laser/laser_dashboard_frontend/client/src/Dashboard.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport red_circle from './icons/emergency_with_circle.gif';\nimport blue_circle from './icons/call_with_circle.gif';\nimport emergency_icon from './icons/emergency.gif';\nimport call_icon from './icons/call.gif';\nimport './App.css'; //import police_car from './icons/vector/police_car.svg'\n//import police_car_enroute from './icons/vector/police_car_yellow.svg'\n\nimport police_car from './icons/PNG/police_car.png';\nimport police_car_using from './icons/PNG/police_car_using.png';\nimport police_car_using_other from './icons/PNG/police_car_other_using.png';\nimport police_car_in_focus from './icons/PNG/police_car_in_focus.png';\nimport fire_car from './icons/PNG/fire_truck.png';\nimport fire_car_using from './icons/PNG/fire_truck_using.png';\nimport fire_car_using_other from './icons/PNG/fire_truck_other_using.png';\nimport fire_car_in_focus from './icons/PNG/fire_truck_in_focus.png';\nimport ambulance from './icons/PNG/ambulance.png';\nimport ambulance_using from './icons/PNG/ambulance_using.png';\nimport ambulance_using_other from './icons/PNG/ambulance_other_using.png';\nimport ambulance_in_focus from './icons/PNG/ambulance_in_focus.png';\nimport alert from \"./sounds/alert.mp3\";\nimport { Map, Marker, GoogleApiWrapper } from 'google-maps-react';\nimport io from \"socket.io-client\";\nimport Sidebar from './components/Sidebar';\nimport Action from './components/Action';\nimport AgentDetails from './components/AgentDetails';\nimport LocationSidebar from './components/LocationSideBar';\nimport AddCallManually from './components/AddCallManually';\nimport ConfirmAddressNotFound from './components/ConfirmAddressNotFound';\nimport TopPanel from './components/TopPanel';\nimport Latest from './components/Latest';\nimport RouteStatus from './components/RouteStatus';\nimport ConfirmAction from './components/ConfirmAction';\nimport Utils from './utils/Utils';\nimport Persistence from './utils/Persistence';\nimport Sound from 'react-sound'; //Refactor \n\nimport { usePubNub } from 'pubnub-react';\nimport Geocode from \"react-geocode\";\nimport Loader from './components/Loader';\nimport * as API from './api/Api';\nimport AuthHelperMethods from './auth/AuthHelperMethods';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Auth = new AuthHelperMethods();\nconst utils = new Utils();\nconst persistence = new Persistence();\nconst mapStyle = {\n  height: '100vh',\n  width: '100%'\n}; //const socket_io_url = 'http://18.192.254.193';\n\nconst socket_io_url = 'http://192.168.233.39:3080';\nlet todays_date = new Date().toISOString();\nlet today = null;\nlet pubnub = null;\nlet browserAdmin = null;\n\nconst Dashboard = _ref => {\n  _s();\n\n  let {\n    logout,\n    google\n  } = _ref;\n  return function (logout) {\n    pubnub = usePubNub();\n    const [mapDetails, setMapDetails] = useState({\n      showConfirm: {\n        action: \"\",\n        status: false\n      },\n      latest: [],\n      locations: [],\n      emergencies: [],\n      filtered_locations: [],\n      filtered_emergencies: [],\n      side_bar_open: false,\n      agent_side_bar_open: false,\n      location_side_bar_open: false,\n      manual_location_side_bar: false,\n      clicked_user: {},\n      clicked_agent: {},\n      center: {\n        lat: 6.5244,\n        lng: 3.3792\n      },\n      selected_call: \"Calls (All)\",\n      selected_emergency: \"Emergencies (All)\",\n      zoom: 11,\n      show_red_circle: false,\n      show_blue_circle: false,\n      clicked_marker_id: \"\",\n      play_sound: false,\n      channels_list: [\"lllaser\"],\n      agents_in_focus: [],\n      laser_agents: [],\n      //all agents\n      monitoring_grid: [],\n      responses_available: false,\n      route_responses_from_agents: [],\n      action: \"loading\",\n      action_message: \"\",\n      tracked_area: \"lllaser\",\n      //the user in which the admin is currently viewing whether the user wants to be tracked or not\n      date: new Date(),\n      message: \"\",\n      selected_manual_call: \"Emergency Management(LASEMA)\",\n      selected_manual_gender: \"Male\",\n      manual_name: \"\",\n      manual_phone: \"\",\n      manual_address: \"\",\n      showConfirmManualLocation: false,\n      isLoading: false\n    });\n    useEffect(() => {\n      browserAdmin = Auth.getAdmin(); //Refactor  ---------------------------------------------------------------------\n      //subscribe to the parent channel to receive location updates from agents\n\n      pubnub.subscribe({\n        channels: mapDetails.channels_list\n      }); //Refactor End  ---------------------------------------------------------------------\n\n      setMapDetails({ ...mapDetails,\n        laser_agents: []\n      });\n      var responses = persistence.getCompletedEmergenciesResponse();\n\n      if (responses && responses.length > 0) {\n        setMapDetails({ ...mapDetails,\n          route_responses_from_agents: responses\n        });\n      }\n\n      loadSocketIO();\n      loadPubnub();\n      loadShit();\n    }, []);\n\n    const loadPubnub = () => {\n      pubnub.addListener({\n        status: st => {\n          if (st.category === \"PNNetworkUpCategory\") {\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"You are back online.\"\n            });\n            getMonitoringGridFromServerAndReconcileAssignedAgents();\n          }\n\n          if (st.category === \"PNConnectedCategory\") {//intentionally left blank\n          }\n\n          if (st.category === \"PNReconnectedCategory\") {\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"You are back online.\"\n            });\n            getMonitoringGridFromServerAndReconcileAssignedAgents();\n          }\n\n          if (st.category === \"PNNetworkIssuesCategory\") {\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"It appears there is a network issue.\"\n            });\n          }\n\n          if (st.category === \"PNNetworkDownCategory\") {\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"It appears the network is down.\"\n            });\n          }\n\n          if (st.category === \"PNTimeoutCategory\") {\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"Could not connect to the internet.\"\n            });\n          }\n        },\n        message: event => {\n          const message = event.message;\n          /*var tracked_user_id =   mapDetails.tracked_users.find(id => id === message.channel);\n           if(tracked_user_id){\n                  //the message is from a user currently being monitored\n                  if(message.userMetadata && message.userMetadata.action === \"user_location_update\"){\n                      var arr =   mapDetails.emergencies.map(emergency => {\n                          if(emergency.user === tracked_user_id){\n                              emergency.latitude = message.message.latitude;\n                              emergency.longitude = message.message.longitude;\n                              return emergency;\n                          }\n                          else{\n                              return emergency;\n                          }\n                      })\n                       //var found_emergency =   mapDetails.emergencies.find(emergency => emergency.user ===   mapDetails.tracked_user_id);\n                       (state => {\n                          return{\n                              emergencies: arr\n                          }\n                      })\n                  }\n          }*/\n\n          utils.getAdminEmergencyMonitored(browserAdmin._id, mapDetails.monitoring_grid).then(emergency_full_row => {\n            var emergency_monitored = emergency_full_row.emergency;\n\n            if (message.channel === emergency_monitored._id) {\n              if (message.userMetadata && message.userMetadata.action === \"user_location_update\") {\n                var arr = mapDetails.emergencies.map(emergency => {\n                  if (emergency.user === emergency_monitored.user) {\n                    emergency.latitude = message.message.latitude;\n                    emergency.longitude = message.message.longitude;\n                    return emergency;\n                  } else {\n                    return emergency;\n                  }\n                }); //var found_emergency =   mapDetails.emergencies.find(emergency => emergency.user ===   mapDetails.tracked_user_id);\n\n                setMapDetails({ ...mapDetails,\n                  emergencies: arr\n                });\n              }\n            }\n          }).catch(err => {}); //if(message.channel ===   mapDetails.tracked_area ){\n\n          if (message.userMetadata && message.userMetadata.action === \"agent_location_update\") {\n            try {\n              console.log(message.message.agent);\n            } catch (err) {}\n\n            utils.updateAgentLocation(message.message, mapDetails.laser_agents, mapDetails.monitoring_grid, browserAdmin._id).then(sorted_agents => {\n              setMapDetails({ ...mapDetails,\n                laser_agents: sorted_agents\n              });\n            }).catch(err => {\n              console.log(err);\n            });\n          } //}\n          //we check the response of an agent that has been assigned, whether the agent sent a message to decilne\n\n\n          if (message.userMetadata && message.userMetadata.action === \"route_request_response\") {\n            //we check which agent is responding to the emergency request\n            var emergency_agent = message.message;\n\n            if (message.channel === emergency_agent._id) {\n              showLoading();\n              var assigned_agents = persistence.getAssignedAgents(); //we get the agent full profile from the persisted listof assigned agents\n\n              utils.getAgentFromAssignedAgentsInPersistence(assigned_agents, emergency_agent._id).then(agent_found => {\n                //we proceed to remove the agent from the emergency and update the monitoring grid and all other parts of the system\n                removeAgentFromEmergencyAfterDecliningRequest(agent_found);\n              }).catch(err => {\n                setMapDetails({ ...mapDetails,\n                  action: \"message\",\n                  action_message: \"Agent \" + emergency_agent.firstname + \" declined to attend to emergency but an error occurred updating the system. Please manually remove the agent from emergency\"\n                });\n              });\n            }\n          }\n\n          if (message.userMetadata && message.userMetadata.action === \"route_completed\") {\n            //show message that agent has completed route\n            var responses = persistence.getCompletedEmergenciesResponse();\n            utils.getAdminEmergencyMonitored(browserAdmin._id, mapDetails.monitoring_grid).then(emergency_monitored => {\n              var assigned_agents = persistence.getAssignedAgents(); //we get the agent full profile from the persisted listof assigned agents\n\n              utils.getAgentFromAssignedAgentsInPersistence(assigned_agents, message.message._id).then(agent_found => {\n                if (responses && responses.length > 0) {\n                  responses.push({\n                    agent: agent_found,\n                    user: emergency_monitored.emergency\n                  });\n                } else {\n                  responses = [{\n                    agent: agent_found,\n                    user: emergency_monitored.emergency\n                  }];\n                }\n\n                persistence.saveCompletedEmergenciesResponse(responses);\n                setMapDetails({ ...mapDetails,\n                  route_responses_from_agents: responses\n                });\n              }).catch(err => {});\n            }).catch(err => {});\n          }\n        }\n      });\n    };\n\n    const loadSocketIO = () => {\n      /*const socket = socketIOClient(socket_io_url, {\n         //withCredentials: true\n      });*/\n      const socket = io(socket_io_url);\n      socket.on(\"connect\", () => console.log(\"connected to socket io\"));\n      socket.on(\"reconnect\", attempt => {\n        console.log(\"Socket IO Reconnected\"); //successfully reconnected\n        //get the lastest data\n      }); //Listen for data on the \"outgoing data\" namespace and supply a callback for what to do when we get one. In this case, we set a state variable\n\n      socket.on(\"emergency\", data => {\n        if (data) {\n          let arr = mapDetails.emergencies;\n          let lat = mapDetails.latest;\n          let fe = mapDetails.filtered_emergencies;\n          fe.push(data);\n          lat.push(data);\n          arr.push(data);\n          setMapDetails({ ...mapDetails,\n            play_sound: true,\n            latest: lat,\n            clicked_marker_id: data._id,\n            zoom: 18,\n            emergencies: arr,\n            filtered_emergencies: fe,\n            center: {\n              lat: data.latitude,\n              lng: data.longitude\n            }\n          });\n        }\n      });\n      socket.on(\"call\", data => {\n        if (data) {\n          let arr = mapDetails.locations;\n          let lat = mapDetails.latest;\n          lat.push(data);\n          arr.push(data);\n          setMapDetails({ ...mapDetails,\n            play_sound: true,\n            latest: lat,\n            clicked_marker_id: data._id,\n            zoom: 18,\n            locations: arr,\n            center: {\n              lat: data.latitude,\n              lng: data.longitude\n            }\n          });\n        }\n      });\n      socket.on(\"monitoring_update\", id => {\n        if (id !== browserAdmin._id) {\n          //pull the monitoring grid and re-evaluate variables\n          //show loading UI\n          showLoading();\n          var monitoring_grid = [];\n          API.getMonitoringGrid().then(response => {\n            monitoring_grid = response.data;\n            utils.reconcileAllAgentsWithMonitoringGrid(mapDetails.laser_agents, response.data, browserAdmin._id).then(lasers => {\n              setMapDetails({ ...mapDetails,\n                monitoring_grid: monitoring_grid,\n                laser_agents: lasers\n              });\n              hideLoading();\n            }).catch(err => {\n              setMapDetails({ ...mapDetails,\n                monitoring_grid: monitoring_grid\n              });\n              hideLoading();\n            });\n          }).catch(err => {\n            setMapDetails({ ...mapDetails,\n              monitoring_grid: monitoring_grid\n            });\n            hideLoading();\n          });\n        }\n      });\n    };\n\n    const loadShit = async () => {\n      await getMonitoringGridFromServerAndReconcileAssignedAgents();\n      await getLocations();\n      await getEmergencies();\n    };\n\n    useEffect(() => {\n      console.log(mapDetails.latest);\n    }, [mapDetails]);\n\n    function showLoading() {\n      setMapDetails({ ...mapDetails,\n        isLoading: true\n      });\n    }\n\n    function hideLoading() {\n      setMapDetails({ ...mapDetails,\n        isLoading: false\n      });\n    }\n\n    function logout() {\n      logout();\n    }\n\n    const showMonitoredEmergency = async e => {\n      console.log(mapDetails.monitoring_grid);\n      const emergency_full_row = await utils.getAdminEmergencyMonitored(browserAdmin._id, mapDetails.monitoring_grid);\n\n      if (emergency_full_row && emergency_full_row.emergency) {\n        var item = emergency_full_row.emergency;\n\n        switch (item.laser_type) {\n          case \"emergency\":\n            setMapDetails({ ...mapDetails,\n              clicked_user: item,\n              side_bar_open: true,\n              location_side_bar_open: false,\n              agent_side_bar_open: false,\n              center: {\n                lat: item.latitude,\n                lng: item.longitude\n              },\n              zoom: 19,\n              show_red_circle: true,\n              show_blue_circle: false,\n              clicked_marker_id: item._id\n            });\n\n          case \"call\":\n            setMapDetails({ ...mapDetails,\n              clicked_user: item,\n              side_bar_open: false,\n              location_side_bar_open: true,\n              agent_side_bar_open: false,\n              center: {\n                lat: item.latitude,\n                lng: item.longitude\n              },\n              zoom: 19,\n              show_red_circle: false,\n              show_blue_circle: true,\n              clicked_marker_id: item._id\n            });\n            break;\n        }\n      } else {\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"You are not monitoring any emergency or call at the moment\"\n        });\n      }\n    };\n\n    function showConfirmResolveEmergency(e) {\n      e.preventDefault();\n      setMapDetails({ ...mapDetails,\n        showConfirm: {\n          action: \"emergency\",\n          status: true\n        },\n        message: \"Are you sure you want to mark this emergency issue as resolved ?\"\n      });\n    }\n\n    function showConfirmResolveLocation() {\n      setMapDetails({ ...mapDetails,\n        showConfirm: {\n          action: \"location\",\n          status: true\n        },\n        message: \"Are you sure you want to mark this call as resolved ?\"\n      });\n    }\n\n    const removeAgentFromRoute = async (e, agent) => {\n      showLoading();\n      const result = await utils.removeAgentFromBrowserAdminMonitoringGrid(agent, browserAdmin._id, mapDetails.monitoring_grid, mapDetails.laser_agents);\n\n      if (result) {\n        //result[0] //monitoring_grid\n        //result[1] //laser agents\n        const save_result = await API.saveMonitoringGrid(result[0]);\n\n        if (save_result) {\n          if (save_result.data === \"successful\") {\n            //persist agents incase the user reloads the page or closes the browser\n            var assigned_agents = persistence.getAssignedAgents();\n            var new_assigned_agents = utils.removeAgentFromListOfAssignedAgentsForPersistsnce(agent, assigned_agents);\n\n            if (new_assigned_agents.length > 0) {\n              persistence.saveAssignedAgents(new_assigned_agents);\n            } else {\n              persistence.deleteAssignedAgents();\n            } //Refactor  ---------------------------------------------------------------------\n            //unsubscribe from agents channel\n\n\n            pubnub.unsubscribe({\n              channels: [agent.agent._id]\n            });\n\n            try {\n              //tell agent to leave the emergency\n              const result = await pubnub.publish({\n                message: {\n                  pn_gcm: {\n                    data: {\n                      notification_body: \"You need to abandon route. Tap to open app\",\n                      data: {},\n                      action: \"leave_route\"\n                    }\n                  }\n                },\n                channel: agent.agent._id,\n                sendByPost: false,\n                // true to send via POST\n                storeInHistory: false //override default storage options\n\n              });\n            } catch (status) {} //Refactor End  ---------------------------------------------------------------------\n            //we set state and update the monitoring grid and the laser agents list\n\n\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"Agent \" + agent.agent.firstname + \" was successfully removed from monitoring the emergency\",\n              monitoring_grid: result[0],\n              laser_agents: result[1],\n              agent_side_bar_open: false,\n              clicked_agent: {}\n            });\n            hideLoading();\n          }\n\n          if (save_result.data === \"unsuccessful\") {\n            hideLoading();\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"An error occurred removing the agent from the emergency\"\n            });\n          }\n        } else {\n          hideLoading();\n          setMapDetails({ ...mapDetails,\n            action: \"message\",\n            action_message: \"An error occurred removing the agent from the emergency\"\n          });\n        }\n      } else {\n        hideLoading();\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"An error occurred removing the agent from the emergency\"\n        });\n      }\n    };\n\n    const removeAgentFromRouteAndCloseRouteResponse = async (e, route_response) => {\n      var agent = route_response.agent;\n      showLoading();\n      const result = await utils.removeAgentFromBrowserAdminMonitoringGrid(agent, browserAdmin._id, mapDetails.monitoring_grid, mapDetails.laser_agents);\n\n      if (result) {\n        //result[0] //monitoring_grid\n        //result[1] //laser agents\n        const save_result = await API.saveMonitoringGrid(result[0]);\n\n        if (save_result) {\n          if (save_result.data === \"successful\") {\n            //persist agents incase the user reloads the page or closes the browser\n            var assigned_agents = persistence.getAssignedAgents();\n            var new_assigned_agents = utils.removeAgentFromListOfAssignedAgentsForPersistsnce(agent, assigned_agents);\n\n            if (new_assigned_agents.length > 0) {\n              persistence.saveAssignedAgents(new_assigned_agents);\n            } else {\n              persistence.deleteAssignedAgents();\n            } //Refactor  ---------------------------------------------------------------------\n            //unsubscribe from agents channel\n\n\n            pubnub.unsubscribe({\n              channels: [agent.agent._id]\n            }); //End Refactor  ---------------------------------------------------------------------\n\n            var route_response_array = mapDetails.route_responses_from_agents;\n            route_response_array.splice(route_response_array.indexOf(route_response), 1); //persist route complete responses array\n\n            persistence.saveCompletedEmergenciesResponse(route_response_array); //we set state and update the monitoring grid and the laser agents list\n\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"Agent \" + agent.agent.firstname + \" was successfully removed from monitoring the emergency\",\n              monitoring_grid: result[0],\n              laser_agents: result[1],\n              agent_side_bar_open: false,\n              clicked_agent: {},\n              route_responses_from_agents: route_response_array\n            });\n            hideLoading();\n          }\n\n          if (save_result.data === \"unsuccessful\") {\n            hideLoading();\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"An error occurred removing the agent from the emergency\"\n            });\n          }\n        } else {\n          hideLoading();\n          setMapDetails({ ...mapDetails,\n            action: \"message\",\n            action_message: \"An error occurred removing the agent from the emergency\"\n          });\n        }\n      } else {\n        hideLoading();\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"An error occurred removing the agent from the emergency\"\n        });\n      }\n    };\n\n    const addAgentToMonitoring = async (e, agent) => {\n      const monitored_result = utils.checkIfEmergencyMonitoredByBrowserAdmin(browserAdmin._id, mapDetails.monitoring_grid);\n\n      if (monitored_result) {\n        var check_result = await utils.checkIfOtherAdminIsUsingAgent(browserAdmin._id, agent, mapDetails.monitoring_grid);\n\n        if (check_result) {\n          setMapDetails({ ...mapDetails,\n            action: \"message\",\n            action_message: \"Another admin has assigned agent \" + agent.agent.firstname + \" to an emergency\"\n          });\n        } else {\n          //we continue\n          //add agent to monitoring grid and save on the server\n          const grid_and_agents_array = await utils.setAgentOnMonitoringGridAndChangeAgentStatus(agent, mapDetails.monitoring_grid, browserAdmin._id, mapDetails.laser_agents);\n          var new_monitoring_grid = grid_and_agents_array[0];\n          var new_laser_agents = grid_and_agents_array[1];\n          const result = await API.saveMonitoringGrid(new_monitoring_grid);\n\n          if (result.data === \"successful\") {\n            //we get the emregency monitored from the monitoring grid which is the central source of truth\n            const emergency_full_row = await utils.getAdminEmergencyMonitored(browserAdmin._id, mapDetails.monitoring_grid);\n            var emergency_monitored = emergency_full_row.emergency;\n\n            if (emergency_monitored) {\n              //Refactor  ---------------------------------------------------------------------\n              //we tell the agent to open the new route and go to the emergency or call\n              try {\n                const result = await pubnub.publish({\n                  message: {\n                    pn_gcm: {\n                      data: {\n                        notification_body: \"You have a new route. Tap to open app.\",\n                        data: emergency_monitored.phone_number ? {\n                          full_name: emergency_monitored.full_name,\n                          _id: emergency_monitored.user,\n                          phone_number: emergency_monitored.phone_number,\n                          latitude: emergency_monitored.latitude,\n                          longitude: emergency_monitored.longitude\n                        } : {\n                          full_name: emergency_monitored.full_name,\n                          _id: emergency_monitored.user,\n                          latitude: emergency_monitored.latitude,\n                          longitude: emergency_monitored.longitude\n                        },\n                        action: \"route_request\"\n                      }\n                    }\n                  },\n                  channel: agent.agent._id,\n                  sendByPost: false,\n                  // true to send via POST\n                  storeInHistory: false //override default storage options\n\n                });\n              } catch (status) {} //Refactor End  ---------------------------------------------------------------------\n              //we subscribe the admin to the agents id channel\n\n\n              var list = mapDetails.channels_list;\n\n              if (list.indexOf(agent.agent._id) === -1) {\n                list.push(agent.agent._id);\n              } //Refactor  ---------------------------------------------------------------------\n\n\n              pubnub.subscribe({\n                channels: list\n              }); //End Refactor  ---------------------------------------------------------------------\n              //persist agents incase the user reloads the page or closes the browser\n\n              var assigned_agents = persistence.getAssignedAgents();\n              var new_assigned_agents = utils.addAgentToListOfAssignedAgentsForPersistence(agent, assigned_agents);\n              persistence.saveAssignedAgents(new_assigned_agents); //we then update state\n\n              setMapDetails({ ...mapDetails,\n                monitoring_grid: new_monitoring_grid,\n                laser_agents: new_laser_agents,\n                //channels_list: list,\n                action: \"message\",\n                action_message: \"Agent \" + agent.agent.firstname + \" has been successfully assigned to the emergency\"\n              });\n            }\n          }\n\n          if (result.data === \"unsuccessful\") {\n            //the grid was NOT successfully saved \n            //show message\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"The system could NOT successfully assign the agent to the emergency\"\n            });\n          }\n        }\n      } else {}\n    };\n\n    const startMonitoring = async (e, item) => {\n      try {\n        //check if another admin is monitoring the emergency\n        const boolean_value = await utils.checkIfEmergencyMonitoredByOtherAdmin(mapDetails.monitoring_grid, item, browserAdmin._id);\n\n        if (boolean_value) {\n          //the emergency is being monitored by another admin\n          //tell the browser admin about this\n          setMapDetails({ ...mapDetails,\n            action: \"message\",\n            action_message: \"Another admin is already monitoring the selected emergency\"\n          });\n        } else {\n          //we continue by editing the monitoring_grid and persisting it\n          const new_monitoring_grid = await utils.setEmergencyOnMonitoringGrid(item, mapDetails.monitoring_grid, browserAdmin._id);\n          const result = await API.saveMonitoringGrid(new_monitoring_grid);\n\n          if (result.data === \"successful\") {\n            //the grid was successfully saved \n            //change monitoring grid in local state\n            //subscribe to channel if user chose to be tracked\n            //show message\n            var list = mapDetails.channels_list ? mapDetails.channels_list : []; //we subscribe to the items channel ONLY if the item is trackable\n\n            if (item.is_trackable) {\n              if (list.indexOf(item.user) === -1) {\n                //remove old user from list\n                //unsubscribe from old user\n                list.push(item.user);\n              } //Refactor  ---------------------------------------------------------------------\n\n\n              pubnub.subscribe({\n                channels: list\n              }); //Refactor End  ---------------------------------------------------------------------\n            }\n\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"You are now monitoring \" + item.full_name,\n              channels_list: list,\n              monitoring_grid: new_monitoring_grid\n            });\n          }\n\n          if (result.data === \"unsuccessful\") {\n            //the grid was NOT successfully saved \n            //show message\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"The system could not initiate the monitoring of that emergency\"\n            });\n          }\n        }\n      } catch (err) {\n        console.log({\n          err\n        }); //show message\n\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"Error occurred initiating monitoring of emergency\"\n        });\n      }\n    };\n\n    const hideConfirm = () => {\n      setMapDetails({ ...mapDetails,\n        showConfirm: {\n          action: \"\",\n          status: false\n        },\n        message: \"\"\n      });\n    };\n\n    const closeAction = e => {\n      setMapDetails({ ...mapDetails,\n        action: \"close\",\n        action_message: \"\"\n      });\n    };\n\n    const closeSideBar = e => {\n      setMapDetails({ ...mapDetails,\n        play_sound: false,\n        side_bar_open: false,\n        location_side_bar_open: false,\n        manual_location_side_bar: false,\n        agent_side_bar_open: false,\n        selected_location: {},\n        selected_emergency: {},\n        clicked_marker_id: \"\"\n      });\n    };\n\n    const closeAgentSideBar = e => {\n      setMapDetails({ ...mapDetails,\n        clicked_agent: {},\n        agent_side_bar_open: false\n      });\n    };\n\n    const closeRouteResponse = route_response => {\n      let array = mapDetails.route_responses_from_agents;\n      array.splice(array.indexOf(route_response), 1);\n      setMapDetails({ ...mapDetails,\n        route_responses_from_agents: array\n      });\n    };\n\n    const getSelectedAgentsIds = () => {};\n\n    const setSelectedAgentsFromIds = ids => {}; //we get the monitoring grid from the server and update our variables\n\n\n    const getMonitoringGridFromServerAndReconcileAssignedAgents = async () => {\n      const response = await API.getMonitoringGrid();\n\n      if (response) {\n        setUpAssignedAgentsIfAny(response.data);\n        const emergency_full_row = await utils.getAdminEmergencyMonitored(browserAdmin._id, response.data);\n        var admin_emergency = emergency_full_row.emergency;\n\n        if (admin_emergency) {\n          //we need to subscribe to the emergencies user id to receive location updates\n          if (mapDetails.channels_list.indexOf(admin_emergency.user) === -1) {\n            var list = mapDetails.channels_list.concat([admin_emergency.user]); //Refactor  ---------------------------------------------------------------------\n\n            pubnub.subscribe({\n              channels: list\n            }); //Refactor End ---------------------------------------------------------------------\n\n            console.log(response.data);\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"You are monitoring \" + admin_emergency.full_name,\n              monitoring_grid: response.data,\n              channels_list: list\n            });\n            hideLoading();\n          } else {\n            //Refactor  ---------------------------------------------------------------------\n            pubnub.subscribe({\n              channels: mapDetails.channels_list\n            }); //Refactor End  ---------------------------------------------------------------------\n\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"You are monitoring \" + admin_emergency.full_name,\n              monitoring_grid: response.data\n            });\n            hideLoading();\n          }\n        } else {\n          setMapDetails({ ...mapDetails,\n            monitoring_grid: response.data\n          });\n          hideLoading();\n        }\n      } else {\n        //show appropriate message\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"An error occurred. Please check the network.\"\n        });\n        hideLoading();\n      }\n    };\n\n    const setUpAssignedAgentsIfAny = async monitoring_grid => {\n      var assigned_agents = persistence.getAssignedAgents();\n\n      if (assigned_agents && assigned_agents.length > 0) {\n        var result = await utils.reconcileAssignedAgentsListWithMonitoringGrid(browserAdmin._id, assigned_agents, monitoring_grid); //result[0] //assigned agents list\n        //result[1] //laser agents\n\n        if (result[0].length > 0) {\n          persistence.saveAssignedAgents(result[0]); //we subscribe to the id of each agent\n\n          let list = mapDetails.channels_list.concat(result[0]); //Refactor  ---------------------------------------------------------------------\n\n          pubnub.subscribe({\n            channels: list\n          }); //Refactor End  ---------------------------------------------------------------------\n\n          setMapDetails({ ...mapDetails,\n            laser_agents: result[1],\n            channels_list: list\n          });\n        } else {\n          persistence.deleteAssignedAgents();\n          setMapDetails({ ...mapDetails,\n            laser_agents: result[1]\n          });\n        }\n      }\n    };\n\n    const removeAgentFromEmergencyAfterDecliningRequest = async agent => {\n      showLoading();\n      const result = await utils.removeAgentFromBrowserAdminMonitoringGrid(agent, browserAdmin._id, mapDetails.monitoring_grid, mapDetails.laser_agents);\n\n      if (result) {\n        //result[0] //monitoring_grid\n        //result[1] //laser agents\n        const save_result = await API.saveMonitoringGrid(result[0]);\n\n        if (save_result) {\n          if (save_result.data === \"successful\") {\n            //persist agents incase the user reloads the page or closes the browser\n            var assigned_agents = persistence.getAssignedAgents();\n            var new_assigned_agents = utils.removeAgentFromListOfAssignedAgentsForPersistsnce(agent, assigned_agents);\n\n            if (new_assigned_agents.length > 0) {\n              persistence.saveAssignedAgents(new_assigned_agents);\n            } else {\n              persistence.deleteAssignedAgents();\n            } //Refactor  ---------------------------------------------------------------------\n            //unsubscribe from agents channel\n\n\n            pubnub.unsubscribe({\n              channels: [agent.agent._id]\n            }); //Refactor End  ---------------------------------------------------------------------\n            //we set state and update the monitoring grid and the laser agents list\n\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"Agent \" + agent.agent.firstname + \" declined the request to attend to the emergency\",\n              monitoring_grid: result[0],\n              laser_agents: result[1],\n              agent_side_bar_open: false,\n              clicked_agent: {}\n            });\n            hideLoading();\n          }\n\n          if (save_result.data === \"unsuccessful\") {\n            hideLoading();\n            setMapDetails({ ...mapDetails,\n              action: \"message\",\n              action_message: \"An error occurred removing the agent from the emergency\"\n            });\n          }\n        } else {\n          hideLoading();\n          setMapDetails({ ...mapDetails,\n            action: \"message\",\n            action_message: \"An error occurred removing the agent from the emergency\"\n          });\n        }\n      } else {\n        hideLoading();\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"An error occurred removing the agent from the emergency\"\n        });\n      }\n    }; //this is not showing the agents in the same lga\n\n\n    const getAgentsAroundEmergency = async () => {\n      //show the agents around an emergency\n      //search to see if an emergency is being monitored by the admin browser\n      utils.checkIfEmergencyMonitoredByBrowserAdmin(browserAdmin._id, mapDetails.monitoring_grid).then(async boolean_value => {\n        if (boolean_value) {\n          //Refactor  ---------------------------------------------------------------------\n          //ideally this should be sent to those agents in the emergency's LGA\n          //for now we are publishing to all agents \n          try {\n            await pubnub.publish({\n              message: {\n                pn_gcm: {\n                  data: {\n                    notification_body: \"Tap to open the Laser App\",\n                    data: {},\n                    action: \"send_location\"\n                  }\n                }\n              },\n              channel: mapDetails.tracked_area,\n              sendByPost: false,\n              // true to send via POST\n              storeInHistory: false //override default storage     \n\n            });\n          } catch (status) {} //Refactor End  ---------------------------------------------------------------------\n\n\n          utils.getAdminEmergencyMonitored(browserAdmin._id, mapDetails.monitoring_grid).then(emergency_monitored => {\n            //admin is monitoring an emergency or call\n            //check for the agents in emergency LGA\n            utils.setAgentsInFocus(mapDetails.agents_in_focus, emergency_monitored.emergency, mapDetails.laser_agents).then(result => {\n              //we set the state for the laser agents and the agents in focus\n              setMapDetails({ ...mapDetails,\n                laser_agents: result[0],\n                agents_in_focus: result[1]\n              });\n            }).catch(err => {\n              setMapDetails({ ...mapDetails,\n                action: \"message\",\n                action_message: \"An error occurred seeking agents around emergency\"\n              });\n            });\n          }).catch(err => {});\n        } else {\n          setMapDetails({ ...mapDetails,\n            action: \"message\",\n            action_message: \"You are NOT monitoring any emergency or call\"\n          });\n        }\n      }).catch(err => {\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"An error occurred seeking agents around emergency\"\n        });\n      });\n    };\n\n    const latestClicked = item => {\n      switch (item.laser_type) {\n        case \"emergency\":\n          setMapDetails({ ...mapDetails,\n            clicked_user: item,\n            side_bar_open: true,\n            location_side_bar_open: false,\n            agent_side_bar_open: false,\n            center: {\n              lat: item.latitude,\n              lng: item.longitude\n            },\n            zoom: 19,\n            show_red_circle: true,\n            show_blue_circle: false,\n            clicked_marker_id: item._id\n          });\n          break;\n\n        case \"call\":\n          setMapDetails({ ...mapDetails,\n            clicked_user: item,\n            side_bar_open: false,\n            location_side_bar_open: true,\n            agent_side_bar_open: false,\n            center: {\n              lat: item.latitude,\n              lng: item.longitude\n            },\n            zoom: 19,\n            show_red_circle: false,\n            show_blue_circle: true,\n            clicked_marker_id: item._id\n          });\n          break;\n      }\n    };\n\n    const openManualLocation = () => {\n      setMapDetails({ ...mapDetails,\n        manual_location_side_bar: true,\n        side_bar_open: false,\n        location_side_bar_open: false,\n        agent_side_bar_open: false\n      });\n    };\n\n    const onCalendarOpen = () => {\n      setMapDetails({ ...mapDetails,\n        play_sound: false,\n        side_bar_open: false,\n        location_side_bar_open: false,\n        agent_side_bar_open: false\n      });\n    };\n\n    const onDateChange = date => {\n      //We add 1 hour to the date because the date axios is sending to the server is 1 hour behind what it should be\n      date = new Date(date);\n      date.setHours(date.getHours() + 1);\n      setMapDetails({ ...mapDetails,\n        play_sound: false,\n        date: date,\n        show_red_circle: false,\n        show_blue_circle: false,\n        clicked_marker_id: \" \",\n        action: \"loading\",\n        action_message: \"\",\n        selected_call: \"Calls (All)\",\n        selected_emergency: \"Emergencies (All)\"\n      });\n      getLocationsDate(date);\n      getEmergenciesDate(date);\n    };\n\n    const onCallsChanged = e => {\n      e.preventDefault();\n      const target = e.target;\n      const value = target.value;\n      const name = target.name;\n      let arr = [];\n\n      if (mapDetails.locations.length > 0) {\n        if (value === \"Calls (All)\") {\n          setMapDetails({ ...mapDetails,\n            play_sound: false,\n            filtered_locations: mapDetails.locations,\n            side_bar_open: false,\n            selected_call: value,\n            agent_side_bar_open: false,\n            location_side_bar_open: false,\n            show_blue_circle: false\n          });\n        } else if (value === \"None\") {\n          setMapDetails({ ...mapDetails,\n            play_sound: false,\n            filtered_locations: [],\n            side_bar_open: false,\n            selected_call: value,\n            agent_side_bar_open: false,\n            location_side_bar_open: false,\n            show_blue_circle: false\n          });\n        } else {\n          mapDetails.locations.map(emer => {\n            if (emer.reason.includes(value.toLowerCase())) {\n              arr.push(emer);\n            }\n          });\n\n          if (arr.length > 0) {\n            setMapDetails({ ...mapDetails,\n              play_sound: false,\n              filtered_locations: arr,\n              selected_call: value,\n              side_bar_open: false,\n              agent_side_bar_open: false,\n              location_side_bar_open: false,\n              show_blue_circle: false\n            });\n          } else {\n            //show message that there are no locations found for that parameter\n            setMapDetails({ ...mapDetails,\n              play_sound: false,\n              filtered_locations: [],\n              selected_call: value,\n              side_bar_open: false,\n              location_side_bar_open: false,\n              show_blue_circle: false\n            });\n          }\n        }\n      } else {\n        setMapDetails({ ...mapDetails,\n          selected_call: value\n        });\n      }\n    };\n\n    const onEmergenciesChanged = e => {\n      const target = e.target;\n      const value = target.value;\n      const name = target.name;\n      let arr = [];\n\n      if (mapDetails.emergencies.length > 0) {\n        if (value === \"Emergencies (All)\") {\n          setMapDetails({ ...mapDetails,\n            play_sound: false,\n            filtered_emergencies: mapDetails.emergencies,\n            side_bar_open: false,\n            selected_emergency: value,\n            location_side_bar_open: false,\n            agent_side_bar_open: false,\n            show_red_circle: false\n          });\n        } else if (value === \"None\") {\n          setMapDetails({ ...mapDetails,\n            play_sound: false,\n            filtered_emergencies: [],\n            selected_emergency: value,\n            side_bar_open: false,\n            agent_side_bar_open: false,\n            location_side_bar_open: false,\n            show_red_circle: false\n          });\n        } else {\n          mapDetails.emergencies.map(emer => {\n            if (emer.reasons && emer.reasons.length > 0) {\n              emer.reasons.map(reason => {\n                if (value.toLowerCase().includes(reason)) {\n                  arr.push(emer);\n                }\n              });\n            }\n          });\n\n          if (arr.length > 0) {\n            setMapDetails({ ...mapDetails,\n              play_sound: false,\n              filtered_emergencies: arr,\n              selected_emergency: value,\n              side_bar_open: false,\n              agent_side_bar_open: false,\n              location_side_bar_open: false,\n              show_red_circle: false\n            });\n          } else {\n            //show message that there are no emregencies found for that parameter\n            setMapDetails({ ...mapDetails,\n              play_sound: false,\n              filtered_emergencies: [],\n              side_bar_open: false,\n              selected_emergency: value,\n              agent_side_bar_open: false,\n              location_side_bar_open: false,\n              show_red_circle: false\n            });\n          }\n        }\n      } else {\n        setMapDetails({ ...mapDetails,\n          selected_emergency: value\n        });\n      }\n    };\n\n    const onCallClicked = (location, e) => {\n      setMapDetails({ ...mapDetails,\n        play_sound: false,\n        clicked_user: location,\n        clicked_agent: {},\n        side_bar_open: false,\n        agent_side_bar_open: false,\n        manual_location_side_bar: false,\n        location_side_bar_open: true,\n        center: {\n          lat: location.latitude,\n          lng: location.longitude\n        },\n        zoom: 19,\n        show_red_circle: false,\n        show_blue_circle: true,\n        clicked_marker_id: location._id\n      });\n    };\n\n    const onEmergencyClicked = (emergency, e) => {\n      setMapDetails({ ...mapDetails,\n        play_sound: false,\n        clicked_user: emergency,\n        clicked_agent: {},\n        side_bar_open: true,\n        manual_location_side_bar: false,\n        agent_side_bar_open: false,\n        location_side_bar_open: false,\n        center: {\n          lat: emergency.latitude,\n          lng: emergency.longitude\n        },\n        zoom: 19,\n        show_red_circle: true,\n        show_blue_circle: false,\n        clicked_marker_id: emergency._id\n      });\n    };\n\n    const onAgentClicked = (agent, e) => {\n      setMapDetails({ ...mapDetails,\n        play_sound: false,\n        clicked_agent: agent,\n        manual_location_side_bar: false,\n        agent_side_bar_open: true\n      });\n    };\n\n    const getLocationsMarkers = () => {\n      let locations_ui;\n\n      if (mapDetails.filtered_locations && mapDetails.filtered_locations.length > 0) {\n        locations_ui = mapDetails.filtered_locations.map(loc => {\n          return /*#__PURE__*/_jsxDEV(Marker, {\n            onClick: e => onCallClicked(loc, e),\n            name: loc.reason,\n            title: loc.full_name,\n            position: {\n              lat: loc.latitude,\n              lng: loc.longitude\n            },\n            icon: {\n              url: mapDetails.clicked_marker_id === loc._id ? blue_circle : call_icon\n            }\n          }, loc._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1544,\n            columnNumber: 25\n          }, _this);\n        });\n      } else {\n        locations_ui = \"\";\n      }\n\n      return locations_ui;\n    };\n\n    const getEmergenciesMarkers = () => {\n      let emergencies_ui;\n      let emergencies_to_show = mapDetails.filtered_emergencies.concat(mapDetails.filtered_emergencies);\n\n      if (emergencies_to_show.length > 0) {\n        emergencies_ui = emergencies_to_show.map(emer => {\n          return /*#__PURE__*/_jsxDEV(Marker, {\n            onClick: e => onEmergencyClicked(emer, e),\n            name: emer.reasons[0],\n            title: emer.full_name,\n            position: {\n              lat: emer.latitude,\n              lng: emer.longitude\n            },\n            icon: {\n              url: mapDetails.clicked_marker_id === emer._id ? red_circle : emergency_icon\n            }\n          }, emer._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1568,\n            columnNumber: 22\n          }, _this);\n        });\n      } else {\n        emergencies_ui = \"\";\n      }\n\n      return emergencies_ui;\n    };\n\n    const getAgentMarkers = () => {\n      let agents_ui;\n\n      if (mapDetails.laser_agents.length > 0) {\n        agents_ui = mapDetails.laser_agents.map((agent, i) => {\n          return /*#__PURE__*/_jsxDEV(Marker, {\n            onClick: e => onAgentClicked(agent, e),\n            name: agent.full_address,\n            title: agent.full_address,\n            position: {\n              lat: agent.latitude,\n              lng: agent.longitude\n            } //\n            ,\n            icon: {\n              url: getAgentIcon(agent),\n              anchor: new google.maps.Point(40, 40),\n              scaledSize: new google.maps.Size(40, 40)\n            }\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1591,\n            columnNumber: 26\n          }, _this);\n        });\n      } else {\n        agents_ui = \"\";\n      }\n\n      return agents_ui;\n    };\n\n    const getAgentIcon = agent => {\n      if (agent) {\n        //we got the icon\n        switch (agent.agent.department) {\n          case \"police\":\n            switch (agent.status) {\n              case \"idle\":\n                return police_car;\n                break;\n\n              case \"infocus\":\n                return police_car_in_focus;\n                break;\n\n              case \"using\":\n                return police_car_using;\n                break;\n\n              case \"using_by_other\":\n                return police_car_using_other;\n                break;\n            }\n\n            break;\n\n          case \"fire\":\n            switch (agent.status) {\n              case \"idle\":\n                return fire_car;\n                break;\n\n              case \"infocus\":\n                return fire_car_in_focus;\n                break;\n\n              case \"using\":\n                return fire_car_using;\n                break;\n\n              case \"using_by_other\":\n                return fire_car_using_other;\n                break;\n            }\n\n            break;\n\n          case \"hospital\":\n            switch (agent.status) {\n              case \"idle\":\n                return ambulance;\n                break;\n\n              case \"infocus\":\n                return ambulance_in_focus;\n                break;\n\n              case \"using\":\n                return ambulance_using;\n                break;\n\n              case \"using_by_other\":\n                return ambulance_using_other;\n                break;\n            }\n\n            break;\n        }\n      }\n    };\n\n    const getEmergencies = async () => {\n      const response = await API.getEmergencies({\n        date: today\n      });\n\n      if (response == \"error\") {\n        //show error message\n        setMapDetails({ ...mapDetails,\n          action: \"err_emergency_load\",\n          emergencies: [],\n          filtered_emergencies: []\n        });\n        return;\n      }\n\n      if (response && response.data && response.data.emergencies && response.data.emergencies.length > 0) {\n        var loc = mapDetails.latest;\n\n        for (var i = 0; i < response.data.emergencies.length; i++) {\n          if (!loc.includes(response.data.emergencies[i])) {\n            loc.push(response.data.emergencies[i]);\n          }\n        }\n\n        loc = utils.sortDates(loc);\n\n        if (mapDetails.action === \"loading\") {\n          setMapDetails({ ...mapDetails,\n            action: \"close\",\n            latest: loc,\n            emergencies: response.data.emergencies,\n            filtered_emergencies: response.data.emergencies\n          });\n        } else {\n          setMapDetails({ ...mapDetails,\n            latest: loc,\n            emergencies: response.data.emergencies,\n            filtered_emergencies: response.data.emergencies\n          });\n        }\n      } else {\n        setMapDetails({ ...mapDetails,\n          action: \"close\",\n          emergencies: [],\n          filtered_emergencies: []\n        });\n      }\n    };\n\n    const getLocations = async () => {\n      const response = await API.getLocations({\n        date: today\n      });\n\n      if (response == \"error\") {\n        //show error message\n        setMapDetails({ ...mapDetails,\n          action: \"err_calls_load\",\n          locations: [],\n          filtered_locations: []\n        });\n        return;\n      }\n\n      if (response && response.data && response.data.locations && response.data.locations.length > 0) {\n        var loc = mapDetails.latest;\n\n        for (var i = 0; i < response.data.locations.length; i++) {\n          if (!loc.includes(response.data.locations[i])) {\n            loc.push(response.data.locations[i]);\n          }\n        }\n\n        loc = utils.sortDates(loc);\n\n        if (mapDetails.action === \"loading\") {\n          setMapDetails({ ...mapDetails,\n            action: \"close\",\n            latest: loc,\n            locations: response.data.locations,\n            filtered_locations: response.data.locations\n          });\n        } else {\n          setMapDetails({ ...mapDetails,\n            latest: loc,\n            locations: response.data.locations,\n            filtered_locations: response.data.locations\n          });\n        }\n      } else {\n        setMapDetails({ ...mapDetails,\n          action: \"close\",\n          locations: [],\n          filtered_locations: []\n        });\n      }\n    };\n\n    const handleSongFinishedPlaying = () => {\n      setMapDetails({ ...mapDetails,\n        play_sound: false\n      });\n    };\n\n    const onFieldChanged = e => {\n      const target = e.target;\n      const value = target.type === 'checkbox' ? target.checked : target.value;\n      const name = target.name;\n      setMapDetails({ ...mapDetails,\n        [name]: value\n      });\n    };\n\n    const onManualCallChanged = e => {\n      const target = e.target;\n      const value = target.value;\n      setMapDetails({ ...mapDetails,\n        selected_manual_call: value\n      });\n    };\n\n    const onManualGenderChanged = e => {\n      const target = e.target;\n      const value = target.value;\n      setMapDetails({ ...mapDetails,\n        selected_manual_gender: value\n      });\n    };\n\n    const onSubmitManualCallDetails = e => {\n      e.preventDefault();\n\n      if (mapDetails.selected_manual_call.length <= 0) {\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"Please enter a valid reason for call from the drop down\"\n        });\n        return;\n      }\n\n      if (mapDetails.manual_phone.lenght <= 0) {\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"Please enter a valid phone number\"\n        });\n        return;\n      }\n\n      if (mapDetails.selected_manual_gender.length <= 0) {\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"Please enter a valid gender\"\n        });\n        return;\n      }\n\n      if (mapDetails.manual_name.length <= 0) {\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"Please enter a valid name\"\n        });\n        return;\n      }\n\n      if (mapDetails.manual_address.length <= 0) {\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"Please enter an address\"\n        });\n        return;\n      } //show loading\n      //translate address to longitude and latitude\n\n\n      setMapDetails({ ...mapDetails,\n        action: \"loading\",\n        action_message: \"\"\n      });\n      Geocode.fromAddress(mapDetails.manual_address).then(response => {\n        const {\n          lat,\n          lng\n        } = response.results[0].geometry.location;\n        var location = {\n          action: mapDetails.selected_manual_call,\n          longitude: lng,\n          latitude: lat,\n          full_address: mapDetails.manual_address,\n          full_name: mapDetails.manual_name,\n          phone_number: mapDetails.manual_phone\n        };\n        saveManualLocation(location);\n      }, error => {\n        console.error(error);\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"We could not find that address\",\n          showConfirmManualLocation: true\n        });\n      });\n    };\n\n    const showConfirmManualLocation = () => {\n      setMapDetails({ ...mapDetails,\n        showConfirmManualLocation: true\n      });\n    };\n\n    const hideConfirmManualLocation = () => {\n      setMapDetails({ ...mapDetails,\n        showConfirmManualLocation: false\n      });\n    };\n\n    const tryAgainClicked = () => {\n      _this.hideConfirmManualLocation();\n\n      setMapDetails({ ...mapDetails,\n        action: \"loading\",\n        action_message: \"\"\n      });\n      Geocode.fromAddress(mapDetails.manual_address).then(response => {\n        const {\n          lat,\n          lng\n        } = response.results[0].geometry.location;\n        var location = {\n          action: mapDetails.selected_manual_call,\n          longitude: lng,\n          latitude: lat,\n          full_address: mapDetails.manual_address,\n          full_name: mapDetails.manual_name,\n          phone_number: mapDetails.manual_phone\n        };\n\n        _this.saveManualLocation(location);\n      }, error => {\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"We could not find that address\"\n        });\n      });\n    };\n\n    const continueConfirmAddressNotFoundClicked = () => {\n      _this.hideConfirmManualLocation();\n      /*\n       this.setState({\n          action: \"loading\",\n          action_message: \"\"\n      });\n       var location = {\n          action: mapDetails.selected_manual_call,\n          longitude: lng,\n          latitude: lat,\n          full_address: mapDetails.manual_address,\n          full_name: mapDetails.manual_name,\n          phone_number: mapDetails.manual_phone\n      }\n       this.saveManualLocation(location);*/\n\n    };\n\n    const closeConfirmAddressNotFoundClicked = () => {\n      setMapDetails({ ...mapDetails,\n        action: \"message\",\n        action_message: \"\"\n      });\n\n      _this.hideConfirmManualLocation();\n    };\n\n    const saveManualLocation = async location => {\n      const response = await API.createManualLocation(location);\n\n      if (response == \"error\") {\n        //show error message\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"An error occurred saving the location. Please try again\"\n        });\n        return;\n      }\n\n      if (response && response.data) {\n        if (response.data.response === \"out_of_lagos\") {\n          setMapDetails({ ...mapDetails,\n            action: \"message\",\n            action_message: \"That location is outside Lagos State\"\n          });\n          return;\n        }\n\n        setMapDetails({ ...mapDetails,\n          action: \"message\",\n          action_message: \"The location has been saved and is displayed on the map\",\n          selected_manual_call: \"Emergency Management(LASEMA)\",\n          selected_manual_gender: \"Male\",\n          manual_name: \"\",\n          manual_phone: \"\",\n          manual_address: \"\",\n          manual_location_side_bar: false\n        });\n        /*this.setState(state => {\n            let arr = state.locations;\n            let lat = state.latest;\n            \n            lat.push(response.data.response);\n            arr.push(response.data.response)\n             return {\n                play_sound: true,\n                latest: lat,\n                clicked_marker_id: response.data.response._id,\n                zoom: 18,\n                locations: arr,\n                center: {\n                    lat: response.data.response.latitude,\n                    lng: response.data.response.longitude\n                }\n            }\n        })*/\n      }\n    };\n\n    const getLocationsDate = async date => {\n      const response = await API.getLocations({\n        date\n      });\n\n      if (response == \"error\") {\n        setMapDetails({ ...mapDetails,\n          action: \"err_calls_load\",\n          locations: [],\n          filtered_locations: []\n        });\n        return;\n      }\n\n      if (response && response.data && response.data.locations) {\n        if (mapDetails.action === \"loading\") {\n          setMapDetails({ ...mapDetails,\n            action: \"close\",\n            locations: response.data.locations,\n            filtered_locations: response.data.locations\n          });\n        } else {\n          setMapDetails({ ...mapDetails,\n            locations: response.data.locations,\n            filtered_locations: response.data.locations\n          });\n        }\n      } else {\n        setMapDetails({ ...mapDetails,\n          action: \"close\",\n          locations: [],\n          filtered_locations: []\n        });\n      }\n    };\n\n    const getEmergenciesDate = async date => {\n      const response = await API.getEmergencies({\n        date\n      });\n\n      if (response == \"error\") {\n        setMapDetails({ ...mapDetails,\n          action: \"err_emergency_load\",\n          emergencies: [],\n          filtered_emergencies: []\n        });\n        return;\n      }\n\n      if (response && response.data && response.data.emergencies) {\n        if (mapDetails.action === \"loading\") {\n          setMapDetails({ ...mapDetails,\n            action: \"close\",\n            emergencies: response.data.emergencies,\n            filtered_emergencies: response.data.emergencies\n          });\n        } else {\n          setMapDetails({ ...mapDetails,\n            emergencies: response.data.emergencies,\n            filtered_emergencies: response.data.emergencies\n          });\n        }\n      } else {\n        setMapDetails({ ...mapDetails,\n          action: \"close\",\n          emergencies: [],\n          filtered_emergencies: []\n        });\n      }\n    };\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"laser-parent-div\",\n      style: mapStyle,\n      children: [/*#__PURE__*/_jsxDEV(Latest, {\n        latest: mapDetails.latest,\n        latestClicked: latestClicked\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2114,\n        columnNumber: 13\n      }, _this), mapDetails.show_location_side_bar, mapDetails.side_bar_open && /*#__PURE__*/_jsxDEV(Sidebar, {\n        closeSidebar: closeSideBar,\n        startMonitoring: startMonitoring,\n        emergency: mapDetails.clicked_user,\n        resolve: showConfirmResolveEmergency\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2116,\n        columnNumber: 44\n      }, _this), mapDetails.showConfirmManualLocation ? /*#__PURE__*/_jsxDEV(ConfirmAddressNotFound, {\n        closeConfirmAddressNotFoundClicked: continueConfirmAddressNotFoundClicked,\n        tryAgainClicked: continueConfirmAddressNotFoundClicked,\n        hideConfirmManualLocation: hideConfirmManualLocation\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2117,\n        columnNumber: 55\n      }, _this) : \"\", mapDetails.manual_location_side_bar ? /*#__PURE__*/_jsxDEV(AddCallManually, {\n        onFieldChanged: onFieldChanged,\n        closeSidebar: closeSideBar,\n        selected_manual_call: mapDetails.selected_manual_call,\n        selected_manual_gender: mapDetails.selected_manual_gender,\n        manual_address: mapDetails.manual_address,\n        manual_name: mapDetails.manual_name,\n        onManualCallChanged: onManualCallChanged,\n        onManualGenderChanged: onManualGenderChanged,\n        onSubmitManualCallDetails: onSubmitManualCallDetails\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2118,\n        columnNumber: 54\n      }, _this) : \"\", mapDetails.agent_side_bar_open ? /*#__PURE__*/_jsxDEV(AgentDetails, {\n        removeAgentFromRoute: removeAgentFromRoute,\n        closeAgentSideBar: closeAgentSideBar,\n        addAgentToMonitoring: addAgentToMonitoring,\n        agent: mapDetails.clicked_agent,\n        user: mapDetails.clicked_user\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2121,\n        columnNumber: 50\n      }, _this) : \"\", /*#__PURE__*/_jsxDEV(TopPanel, {\n        showMonitoredEmergency: showMonitoredEmergency,\n        openManualLocation: openManualLocation,\n        logout: logout,\n        onCalendarOpen: onCalendarOpen,\n        onDateChange: onDateChange,\n        date: mapDetails.date,\n        selected_call: mapDetails.selected_call,\n        onCallsChanged: onCallsChanged,\n        selected_emergency: mapDetails.selected_emergency,\n        onEmergenciesChanged: onEmergenciesChanged,\n        getAgentsAroundEmergency: getAgentsAroundEmergency\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2124,\n        columnNumber: 13\n      }, _this), /*#__PURE__*/_jsxDEV(Map, {\n        google: google,\n        style: mapStyle,\n        onReady: mapDetails.fetchPlaces,\n        initialCenter: mapDetails.center,\n        center: mapDetails.center,\n        zoom: mapDetails.zoom,\n        children: [getLocationsMarkers(), getEmergenciesMarkers(), getAgentMarkers()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 2127,\n        columnNumber: 13\n      }, _this), /*#__PURE__*/_jsxDEV(Loader, {\n        isLoading: mapDetails.isLoading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2140,\n        columnNumber: 13\n      }, _this), /*#__PURE__*/_jsxDEV(Action, {\n        action: mapDetails.action,\n        closeAction: closeAction,\n        message: mapDetails.action_message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2142,\n        columnNumber: 13\n      }, _this), mapDetails.sound, mapDetails.route_responses_from_agents.length > 0 ? /*#__PURE__*/_jsxDEV(RouteStatus, {\n        route_response: mapDetails.route_responses_from_agents[mapDetails.route_responses_from_agents.length - 1],\n        removeAgentFromRouteAndCloseRouteResponse: removeAgentFromRouteAndCloseRouteResponse,\n        closeRouteResponse: closeRouteResponse\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2147,\n        columnNumber: 70\n      }, _this) : \"\", mapDetails.showConfirm.status === true ? /*#__PURE__*/_jsxDEV(ConfirmAction, {\n        yesClicked: mapDetails.showConfirm.action === \"emergency\" ? mapDetails.resolveEmergency : mapDetails.resolveCall,\n        noClicked: hideConfirm,\n        message: mapDetails.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 2151,\n        columnNumber: 56\n      }, _this) : \"\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 2113,\n      columnNumber: 8\n    }, _this);\n  }(logout);\n};\n\n_s(Dashboard, \"r3nLiOwOt5IsHriRi9VB73rJtc8=\", false, function () {\n  return [usePubNub];\n});\n\n_c = Dashboard;\nexport default GoogleApiWrapper({\n  apiKey: 'AIzaSyADNxHcgsHDyx_OSbqxBg5xB5lV2YJDcKI'\n})(Dashboard);\n\nvar _c;\n\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useEffect","useState","red_circle","blue_circle","emergency_icon","call_icon","police_car","police_car_using","police_car_using_other","police_car_in_focus","fire_car","fire_car_using","fire_car_using_other","fire_car_in_focus","ambulance","ambulance_using","ambulance_using_other","ambulance_in_focus","alert","Map","Marker","GoogleApiWrapper","io","Sidebar","Action","AgentDetails","LocationSidebar","AddCallManually","ConfirmAddressNotFound","TopPanel","Latest","RouteStatus","ConfirmAction","Utils","Persistence","Sound","usePubNub","Geocode","Loader","API","AuthHelperMethods","Auth","utils","persistence","mapStyle","height","width","socket_io_url","todays_date","Date","toISOString","today","pubnub","browserAdmin","Dashboard","logout","google","mapDetails","setMapDetails","showConfirm","action","status","latest","locations","emergencies","filtered_locations","filtered_emergencies","side_bar_open","agent_side_bar_open","location_side_bar_open","manual_location_side_bar","clicked_user","clicked_agent","center","lat","lng","selected_call","selected_emergency","zoom","show_red_circle","show_blue_circle","clicked_marker_id","play_sound","channels_list","agents_in_focus","laser_agents","monitoring_grid","responses_available","route_responses_from_agents","action_message","tracked_area","date","message","selected_manual_call","selected_manual_gender","manual_name","manual_phone","manual_address","showConfirmManualLocation","isLoading","getAdmin","subscribe","channels","responses","getCompletedEmergenciesResponse","length","loadSocketIO","loadPubnub","loadShit","addListener","st","category","getMonitoringGridFromServerAndReconcileAssignedAgents","event","getAdminEmergencyMonitored","_id","then","emergency_full_row","emergency_monitored","emergency","channel","userMetadata","arr","map","user","latitude","longitude","catch","err","console","log","agent","updateAgentLocation","sorted_agents","emergency_agent","showLoading","assigned_agents","getAssignedAgents","getAgentFromAssignedAgentsInPersistence","agent_found","removeAgentFromEmergencyAfterDecliningRequest","firstname","push","saveCompletedEmergenciesResponse","socket","on","attempt","data","fe","id","getMonitoringGrid","response","reconcileAllAgentsWithMonitoringGrid","lasers","hideLoading","getLocations","getEmergencies","showMonitoredEmergency","e","item","laser_type","showConfirmResolveEmergency","preventDefault","showConfirmResolveLocation","removeAgentFromRoute","result","removeAgentFromBrowserAdminMonitoringGrid","save_result","saveMonitoringGrid","new_assigned_agents","removeAgentFromListOfAssignedAgentsForPersistsnce","saveAssignedAgents","deleteAssignedAgents","unsubscribe","publish","pn_gcm","notification_body","sendByPost","storeInHistory","removeAgentFromRouteAndCloseRouteResponse","route_response","route_response_array","splice","indexOf","addAgentToMonitoring","monitored_result","checkIfEmergencyMonitoredByBrowserAdmin","check_result","checkIfOtherAdminIsUsingAgent","grid_and_agents_array","setAgentOnMonitoringGridAndChangeAgentStatus","new_monitoring_grid","new_laser_agents","phone_number","full_name","list","addAgentToListOfAssignedAgentsForPersistence","startMonitoring","boolean_value","checkIfEmergencyMonitoredByOtherAdmin","setEmergencyOnMonitoringGrid","is_trackable","hideConfirm","closeAction","closeSideBar","selected_location","closeAgentSideBar","closeRouteResponse","array","getSelectedAgentsIds","setSelectedAgentsFromIds","ids","setUpAssignedAgentsIfAny","admin_emergency","concat","reconcileAssignedAgentsListWithMonitoringGrid","getAgentsAroundEmergency","setAgentsInFocus","latestClicked","openManualLocation","onCalendarOpen","onDateChange","setHours","getHours","getLocationsDate","getEmergenciesDate","onCallsChanged","target","value","name","emer","reason","includes","toLowerCase","onEmergenciesChanged","reasons","onCallClicked","location","onEmergencyClicked","onAgentClicked","getLocationsMarkers","locations_ui","loc","url","getEmergenciesMarkers","emergencies_ui","emergencies_to_show","getAgentMarkers","agents_ui","i","full_address","getAgentIcon","anchor","maps","Point","scaledSize","Size","department","sortDates","handleSongFinishedPlaying","onFieldChanged","type","checked","onManualCallChanged","onManualGenderChanged","onSubmitManualCallDetails","lenght","fromAddress","results","geometry","saveManualLocation","error","hideConfirmManualLocation","tryAgainClicked","continueConfirmAddressNotFoundClicked","closeConfirmAddressNotFoundClicked","createManualLocation","show_location_side_bar","fetchPlaces","sound","resolveEmergency","resolveCall","apiKey"],"sources":["/Users/user/laser/laser_dashboard_frontend/client/src/Dashboard.js"],"sourcesContent":["import React, {useEffect, useState} from 'react';\nimport red_circle from './icons/emergency_with_circle.gif';\nimport blue_circle from './icons/call_with_circle.gif';\nimport emergency_icon from './icons/emergency.gif';\nimport call_icon from './icons/call.gif';\nimport './App.css'; \n\n//import police_car from './icons/vector/police_car.svg'\n//import police_car_enroute from './icons/vector/police_car_yellow.svg'\n\nimport police_car from './icons/PNG/police_car.png'\nimport police_car_using from './icons/PNG/police_car_using.png'\nimport police_car_using_other from './icons/PNG/police_car_other_using.png'\nimport police_car_in_focus from './icons/PNG/police_car_in_focus.png'\n\nimport fire_car from './icons/PNG/fire_truck.png'\nimport fire_car_using from './icons/PNG/fire_truck_using.png'\nimport fire_car_using_other from './icons/PNG/fire_truck_other_using.png'\nimport fire_car_in_focus from './icons/PNG/fire_truck_in_focus.png'\n\nimport ambulance from './icons/PNG/ambulance.png'\nimport ambulance_using from './icons/PNG/ambulance_using.png'\nimport ambulance_using_other from './icons/PNG/ambulance_other_using.png'\nimport ambulance_in_focus from './icons/PNG/ambulance_in_focus.png'\n\nimport alert from \"./sounds/alert.mp3\";\nimport {Map, Marker, GoogleApiWrapper} from 'google-maps-react';\n\nimport io from \"socket.io-client\";\nimport Sidebar from './components/Sidebar';\nimport Action from './components/Action';\nimport AgentDetails from './components/AgentDetails';\nimport LocationSidebar from './components/LocationSideBar';\nimport AddCallManually from './components/AddCallManually';\nimport ConfirmAddressNotFound from './components/ConfirmAddressNotFound';\nimport TopPanel from './components/TopPanel';\nimport Latest from './components/Latest';\nimport RouteStatus from './components/RouteStatus';\nimport ConfirmAction from './components/ConfirmAction';\nimport Utils from './utils/Utils';\nimport Persistence from './utils/Persistence';\nimport Sound from 'react-sound';\n\n//Refactor \nimport { usePubNub } from 'pubnub-react'\n\nimport Geocode from \"react-geocode\";\n\nimport Loader from './components/Loader';\n\nimport * as API from './api/Api';\n\nimport AuthHelperMethods from './auth/AuthHelperMethods';\n\nconst Auth = new AuthHelperMethods();\n\nconst utils = new Utils();\nconst persistence = new Persistence();\n\nconst mapStyle = {\n    height: '100vh', \n    width: '100%'\n}\n\n//const socket_io_url = 'http://18.192.254.193';\nconst socket_io_url = 'http://192.168.233.39:3080';\n\nlet todays_date = new Date().toISOString();\n\nlet today = null;\n\nlet pubnub = null;\n\nlet browserAdmin = null;\n\nconst Dashboard = ({logout, google}) => {\n    pubnub = usePubNub();\n\n    const [mapDetails, setMapDetails] = useState({\n        showConfirm: {\n            action: \"\",\n            status: false\n        },\n        latest: [],\n        locations: [], \n        emergencies: [], \n        filtered_locations: [],\n        filtered_emergencies: [],\n        side_bar_open: false, \n        agent_side_bar_open: false, \n        location_side_bar_open: false, \n        manual_location_side_bar: false,\n        clicked_user: {}, \n        clicked_agent: {},\n        center: {lat: 6.5244,lng: 3.3792}, \n        selected_call:\"Calls (All)\", \n        selected_emergency:\"Emergencies (All)\",\n        zoom : 11,\n        show_red_circle: false,\n        show_blue_circle: false,\n        clicked_marker_id: \"\",\n        play_sound: false,\n        channels_list: [\"lllaser\"],\n\n        agents_in_focus: [],\n        laser_agents:[], //all agents\n        monitoring_grid: [],\n        responses_available: false,\n\n        route_responses_from_agents: [],\n        action: \"loading\",\n        action_message: \"\",\n        tracked_area: \"lllaser\", //the user in which the admin is currently viewing whether the user wants to be tracked or not\n        date: new Date(),\n        message: \"\",\n\n        selected_manual_call:\"Emergency Management(LASEMA)\",\n        selected_manual_gender:\"Male\",\n        manual_name: \"\",\n        manual_phone: \"\",\n        manual_address: \"\",\n        showConfirmManualLocation: false,\n\n        isLoading: false\n    })\n\n    \n\n    useEffect(() => {\n        browserAdmin = Auth.getAdmin();\n\n        //Refactor  ---------------------------------------------------------------------\n\n        //subscribe to the parent channel to receive location updates from agents\n        pubnub.subscribe({\n            channels:   mapDetails.channels_list\n        })\n\n        //Refactor End  ---------------------------------------------------------------------\n\n        setMapDetails({...mapDetails,\n            laser_agents: []\n        })\n    \n\n        var responses = persistence.getCompletedEmergenciesResponse();\n\n        if(responses && responses.length > 0){\n            setMapDetails({...mapDetails,\n                route_responses_from_agents: responses\n            })\n        }\n\n        loadSocketIO();\n\n        loadPubnub();\n\n        loadShit();\n\n    }, [])\n\n    const loadPubnub = () => {\n        pubnub.addListener({\n\n            status: (st) => {\n\n                if(st.category === \"PNNetworkUpCategory\"){\n                    setMapDetails({...mapDetails,\n                        action: \"message\",\n                        action_message: \"You are back online.\"\n                    })\n                    getMonitoringGridFromServerAndReconcileAssignedAgents();\n                }\n\n                if(st.category === \"PNConnectedCategory\"){\n                    //intentionally left blank\n                }\n\n                if (st.category === \"PNReconnectedCategory\") {\n                    setMapDetails({...mapDetails,\n                        action: \"message\",\n                        action_message: \"You are back online.\"\n                    })\n                    getMonitoringGridFromServerAndReconcileAssignedAgents();\n                }\n\n                if (st.category === \"PNNetworkIssuesCategory\") {\n                    setMapDetails({...mapDetails,\n                        action: \"message\",\n                        action_message: \"It appears there is a network issue.\"\n                    })\n                }\n\n                if (st.category === \"PNNetworkDownCategory\") {\n                    setMapDetails({...mapDetails,\n                        action: \"message\",\n                        action_message: \"It appears the network is down.\"\n                    })\n                }\n\n                if (st.category === \"PNTimeoutCategory\") {\n                    setMapDetails({...mapDetails,\n                        action: \"message\",\n                        action_message: \"Could not connect to the internet.\"\n                    })\n                }\n        },\n        message: (event) => {\n\n            const message = event.message;\n\n            /*var tracked_user_id =   mapDetails.tracked_users.find(id => id === message.channel);\n\n            if(tracked_user_id){\n                    //the message is from a user currently being monitored\n                    if(message.userMetadata && message.userMetadata.action === \"user_location_update\"){\n                        var arr =   mapDetails.emergencies.map(emergency => {\n                            if(emergency.user === tracked_user_id){\n                                emergency.latitude = message.message.latitude;\n                                emergency.longitude = message.message.longitude;\n                                return emergency;\n                            }\n                            else{\n                                return emergency;\n                            }\n                        })\n\n                        //var found_emergency =   mapDetails.emergencies.find(emergency => emergency.user ===   mapDetails.tracked_user_id);\n\n                        (state => {\n                            return{\n                                emergencies: arr\n                            }\n                        })\n                    }\n            }*/\n\n            utils.getAdminEmergencyMonitored(browserAdmin._id,   mapDetails.monitoring_grid)\n                            .then(emergency_full_row => {\n                                var emergency_monitored = emergency_full_row.emergency;\n\n                                if(message.channel === emergency_monitored._id ){\n                                    if(message.userMetadata && message.userMetadata.action === \"user_location_update\"){\n                                        \n                                        var arr =   mapDetails.emergencies.map(emergency => {\n                                            if(emergency.user === emergency_monitored.user){\n                                                emergency.latitude = message.message.latitude;\n                                                emergency.longitude = message.message.longitude;\n                                                return emergency;\n                                            }\n                                            else{\n                                                return emergency;\n                                            }\n                                        })\n                    \n                                        //var found_emergency =   mapDetails.emergencies.find(emergency => emergency.user ===   mapDetails.tracked_user_id);\n                    \n                                    setMapDetails({\n                                        ...mapDetails,\n                                        emergencies: arr\n                                    })\n                                    }\n                                }\n                            })\n                            .catch(err => {\n\n                            })\n            \n            //if(message.channel ===   mapDetails.tracked_area ){\n            \n            if(message.userMetadata && message.userMetadata.action === \"agent_location_update\"){\n                try{\n                    console.log(message.message.agent)\n                }\n                catch(err){\n                    \n                }\n\n                utils.updateAgentLocation(message.message,   mapDetails.laser_agents,   mapDetails.monitoring_grid, browserAdmin._id)\n                            .then(sorted_agents => {\n                                setMapDetails({\n                                    ...mapDetails,\n                                        laser_agents: sorted_agents\n                                    \n                                })\n                            }) \n                            .catch(err => {\n                                console.log(err)\n                            })\n            }\n            //}\n\n            //we check the response of an agent that has been assigned, whether the agent sent a message to decilne\n            if(message.userMetadata && message.userMetadata.action === \"route_request_response\"){\n                    //we check which agent is responding to the emergency request\n                    var emergency_agent = message.message;\n\n                    if(message.channel === emergency_agent._id ){\n                        showLoading();\n\n                        var assigned_agents = persistence.getAssignedAgents();\n\n                        //we get the agent full profile from the persisted listof assigned agents\n                        utils.getAgentFromAssignedAgentsInPersistence(assigned_agents, emergency_agent._id)\n                                    .then(agent_found =>{\n                                        //we proceed to remove the agent from the emergency and update the monitoring grid and all other parts of the system\n                                        removeAgentFromEmergencyAfterDecliningRequest(agent_found);\n                                    })\n                                    .catch(err => {\n                                    \n                                        setMapDetails({\n                                            ...mapDetails,\n                                            action: \"message\",\n                                            action_message: \"Agent \" +emergency_agent.firstname +\" declined to attend to emergency but an error occurred updating the system. Please manually remove the agent from emergency\"\n                                        })\n                                    })\n                    }\n            }\n\n            if(message.userMetadata && message.userMetadata.action === \"route_completed\"){\n                    //show message that agent has completed route\n\n                    var responses = persistence.getCompletedEmergenciesResponse();\n\n                    utils.getAdminEmergencyMonitored(browserAdmin._id,   mapDetails.monitoring_grid)\n                            .then(emergency_monitored => {\n\n                                var assigned_agents = persistence.getAssignedAgents();\n\n                                //we get the agent full profile from the persisted listof assigned agents\n                                utils.getAgentFromAssignedAgentsInPersistence(assigned_agents, message.message._id)\n                                            .then(agent_found =>{\n                                                if(responses && responses.length > 0){\n                                                    responses.push({agent:agent_found, user: emergency_monitored.emergency});\n                                                }\n                                                else{\n                                                    responses = [{agent:agent_found, user: emergency_monitored.emergency}];\n                                                }\n                                \n                                                persistence.saveCompletedEmergenciesResponse(responses);\n                                \n                                                setMapDetails({\n                                                    ...mapDetails,\n                                                    route_responses_from_agents: responses\n                                                })\n                                            })\n                                            .catch(err => {\n                                                \n                                            })\n\n                            })\n                            .catch(err => {\n                                \n                            })\n            } \n            \n        }\n        });\n    }\n\n    const loadSocketIO = () => {\n         /*const socket = socketIOClient(socket_io_url, {\n            //withCredentials: true\n        });*/\n\n        const socket = io(socket_io_url)\n\n        socket.on(\"connect\", \n            () => console.log(\"connected to socket io\")\n        );\n\n        socket.on(\"reconnect\", attempt => {\n            console.log(\"Socket IO Reconnected\")\n            //successfully reconnected\n            //get the lastest data\n        })\n\n        //Listen for data on the \"outgoing data\" namespace and supply a callback for what to do when we get one. In this case, we set a state variable\n        socket.on(\"emergency\", data => {\n            if(data){\n                \n                let arr =   mapDetails.emergencies;\n                let lat =   mapDetails.latest;\n\n                let fe = mapDetails.filtered_emergencies\n                fe.push(data)\n                \n                lat.push(data);\n                arr.push(data) \n\n                setMapDetails({\n                    ...mapDetails,\n                    play_sound: true,\n                    latest: lat,\n                    clicked_marker_id: data._id,\n                    zoom: 18,\n                    emergencies: arr,\n                    filtered_emergencies: fe,\n                    center: {\n                        lat: data.latitude,\n                        lng: data.longitude\n                    }\n                })\n            }\n        }\n        );\n\n        socket.on(\"call\", data => {\n            if(data){\n                let arr =   mapDetails.locations;\n                let lat =   mapDetails.latest;\n                \n                lat.push(data);\n                arr.push(data)\n                \n                setMapDetails({\n                    ...mapDetails,\n                    play_sound: true,\n                    latest: lat,\n                    clicked_marker_id: data._id,\n                    zoom: 18,\n                    locations: arr,\n                    center: {\n                    lat: data.latitude,\n                    lng: data.longitude\n                    }\n                })\n            }\n        }\n        );\n\n        socket.on(\"monitoring_update\", (id) => {\n            if(id !== browserAdmin._id){\n                //pull the monitoring grid and re-evaluate variables\n                //show loading UI\n                showLoading();\n\n                var monitoring_grid = [];\n\n                API.getMonitoringGrid()\n                    .then(response => {\n                        monitoring_grid = response.data;\n\n                        utils.reconcileAllAgentsWithMonitoringGrid(  mapDetails.laser_agents, response.data, browserAdmin._id)\n                                .then(lasers => {\n                                    \n                                    setMapDetails({\n                                        ...mapDetails,\n                                        monitoring_grid: monitoring_grid,\n                                        laser_agents: lasers      \n                                    })\n\n                                    hideLoading();\n                                })\n                                .catch(err => {\n                                    setMapDetails({\n                                        ...mapDetails,\n                                        monitoring_grid: monitoring_grid         \n                                    })\n\n                                    hideLoading();\n                                })\n                    })\n                    .catch(err => {\n                        setMapDetails({\n                            ...mapDetails,\n                            monitoring_grid: monitoring_grid         \n                        })\n\n                        hideLoading();\n                    })\n            }\n        });\n    }\n\n    const loadShit = async () => {\n        await getMonitoringGridFromServerAndReconcileAssignedAgents();\n        await getLocations();\n        await getEmergencies();\n    }\n\n    useEffect(() => {\n        console.log(mapDetails.latest)\n        \n    }, [mapDetails])\n\n    function showLoading(){\n        setMapDetails({...mapDetails, isLoading: true})\n    }\n  \n    function hideLoading(){\n        setMapDetails({...mapDetails, isLoading: false})\n    }\n  \n    function logout(){\n        logout();\n    }\n\n    const showMonitoredEmergency = async(e) => {\n        console.log(mapDetails.monitoring_grid)\n        const emergency_full_row = await utils.getAdminEmergencyMonitored(browserAdmin._id, mapDetails.monitoring_grid);\n\n        if(emergency_full_row && emergency_full_row.emergency){\n            var item = emergency_full_row.emergency;\n            \n            switch(item.laser_type){\n                case \"emergency\":\n                    setMapDetails({...mapDetails, clicked_user: item,\n                        side_bar_open: true,\n                        location_side_bar_open: false,\n                        agent_side_bar_open: false,\n                        center: {\n                          lat: item.latitude,\n                          lng: item.longitude\n                        },\n                        zoom: 19,\n                        show_red_circle: true,\n                        show_blue_circle: false,\n                        clicked_marker_id: item._id\n                    })\n\n                case \"call\":\n                    setMapDetails({...mapDetails, clicked_user: item,\n                        side_bar_open: false,\n                        location_side_bar_open: true,\n                        agent_side_bar_open: false,\n                        center: {\n                            lat: item.latitude,\n                            lng: item.longitude\n                        },\n                        zoom: 19,\n                        show_red_circle: false,\n                        show_blue_circle: true,\n                        clicked_marker_id: item._id})\n                    break;\n            }\n        }\n        else{\n            setMapDetails({...mapDetails, action: \"message\", action_message: \"You are not monitoring any emergency or call at the moment\",})\n        }\n    }\n    \n\n    function showConfirmResolveEmergency(e){\n        e.preventDefault();\n        setMapDetails({...mapDetails, showConfirm: {\n            action: \"emergency\",\n            status: true\n          },\n          message: \"Are you sure you want to mark this emergency issue as resolved ?\"\n        })\n    }\n\n    function showConfirmResolveLocation(){\n        \n        setMapDetails({...mapDetails, showConfirm: {\n           \n    \n                  action: \"location\",\n                  status: true\n                },\n                message: \"Are you sure you want to mark this call as resolved ?\"\n            })\n    }\n\n\nconst removeAgentFromRoute = async(e, agent) => {\n    showLoading();\n\n    const result = await utils.removeAgentFromBrowserAdminMonitoringGrid(agent, browserAdmin._id, mapDetails.monitoring_grid, mapDetails.laser_agents);\n    \n    if(result){\n        //result[0] //monitoring_grid\n        //result[1] //laser agents\n\n        const save_result = await API.saveMonitoringGrid(result[0]);\n\n        if(save_result){\n            if(save_result.data===\"successful\"){\n                //persist agents incase the user reloads the page or closes the browser\n                var assigned_agents = persistence.getAssignedAgents();\n\n                var new_assigned_agents = utils.removeAgentFromListOfAssignedAgentsForPersistsnce(agent, assigned_agents)\n                \n                if(new_assigned_agents.length > 0){\n                    persistence.saveAssignedAgents(new_assigned_agents);\n                }\n                else{\n                    persistence.deleteAssignedAgents();\n                }\n\n\n                //Refactor  ---------------------------------------------------------------------\n                //unsubscribe from agents channel\n                pubnub.unsubscribe({\n                    channels: [agent.agent._id]\n                })\n\n                try{\n                    //tell agent to leave the emergency\n                    const result = await pubnub.publish(\n                        {\n                            message: {\n                            pn_gcm: {\n                                data: {\n                                    notification_body: \"You need to abandon route. Tap to open app\",\n                                    data: {},\n                                    action: \"leave_route\"\n                                }\n                            }\n                            },\n                            channel: agent.agent._id,\n                            sendByPost: false, // true to send via POST\n                            storeInHistory: false //override default storage options\n                        }\n                    );\n                }\n                catch(status){\n\n                }\n\n                //Refactor End  ---------------------------------------------------------------------\n\n                //we set state and update the monitoring grid and the laser agents list\n               \n                setMapDetails({...mapDetails, \n                    action: \"message\",\n                    action_message: \"Agent \" +agent.agent.firstname +\" was successfully removed from monitoring the emergency\",\n                    monitoring_grid: result[0],\n                    laser_agents: result[1],\n                    agent_side_bar_open: false,\n                    clicked_agent: {},\n                })\n\n                hideLoading();\n            }\n\n            if(save_result.data === \"unsuccessful\"){\n                hideLoading();\n                setMapDetails({...mapDetails,\n                    action: \"message\",\n                    action_message: \"An error occurred removing the agent from the emergency\"\n                })\n            }\n        }\n        else{\n           hideLoading();\n           setMapDetails({...mapDetails,\n                action: \"message\",\n                action_message: \"An error occurred removing the agent from the emergency\"\n            })\n        }\n\n    }\n    else{\n        hideLoading();\n        setMapDetails({...mapDetails,\n            action: \"message\",\n            action_message: \"An error occurred removing the agent from the emergency\"\n        })\n    }\n  }\n\n  const removeAgentFromRouteAndCloseRouteResponse = async(e, route_response)=>{\n    var agent = route_response.agent;\n\n    showLoading();\n\n    const result = await utils.removeAgentFromBrowserAdminMonitoringGrid(agent, browserAdmin._id,mapDetails.monitoring_grid,mapDetails.laser_agents);\n    \n    if(result){\n        //result[0] //monitoring_grid\n        //result[1] //laser agents\n\n        const save_result = await API.saveMonitoringGrid(result[0]);\n\n        if(save_result){\n            if(save_result.data===\"successful\"){\n                //persist agents incase the user reloads the page or closes the browser\n                var assigned_agents = persistence.getAssignedAgents();\n\n                var new_assigned_agents = utils.removeAgentFromListOfAssignedAgentsForPersistsnce(agent, assigned_agents)\n                \n                if(new_assigned_agents.length > 0){\n                    persistence.saveAssignedAgents(new_assigned_agents);\n                }\n                else{\n                    persistence.deleteAssignedAgents();\n                }\n\n                //Refactor  ---------------------------------------------------------------------\n\n                //unsubscribe from agents channel\n                pubnub.unsubscribe({\n                    channels: [agent.agent._id]\n                })\n\n                //End Refactor  ---------------------------------------------------------------------\n\n\n                var route_response_array =mapDetails.route_responses_from_agents;\n  \n                route_response_array.splice(route_response_array.indexOf(route_response),1);\n\n                //persist route complete responses array\n                persistence.saveCompletedEmergenciesResponse(route_response_array);\n\n\n                //we set state and update the monitoring grid and the laser agents list\n                setMapDetails({...mapDetails,\n                    action: \"message\",\n                    action_message: \"Agent \" +agent.agent.firstname +\" was successfully removed from monitoring the emergency\",\n                    monitoring_grid: result[0],\n                    laser_agents: result[1],\n                    agent_side_bar_open: false,\n                    clicked_agent: {},\n                    route_responses_from_agents: route_response_array\n                })\n\n               hideLoading();\n            }\n\n            if(save_result.data === \"unsuccessful\"){\n                hideLoading();\n                setMapDetails({...mapDetails,\n                    action: \"message\",\n                    action_message: \"An error occurred removing the agent from the emergency\"\n                })\n            }\n        }\n        else{\n           hideLoading();\n            setMapDetails({...mapDetails,\n                action: \"message\",\n                action_message: \"An error occurred removing the agent from the emergency\"\n            })\n        }\n\n    }\n    else{\n        hideLoading();\n        setMapDetails({...mapDetails,\n            action: \"message\",\n            action_message: \"An error occurred removing the agent from the emergency\"\n        })\n    }\n  }\n  \n  const addAgentToMonitoring = async (e, agent)=>{\n      const monitored_result = utils.checkIfEmergencyMonitoredByBrowserAdmin(browserAdmin._id,mapDetails.monitoring_grid);\n\n      if(monitored_result){\n        var check_result = await utils.checkIfOtherAdminIsUsingAgent(browserAdmin._id, agent,mapDetails.monitoring_grid);\n      \n        if(check_result){\n            setMapDetails({...mapDetails,\n                action: \"message\",\n                action_message: \"Another admin has assigned agent \" +agent.agent.firstname +\" to an emergency\"\n            })\n        }\n        else{\n                //we continue\n                //add agent to monitoring grid and save on the server\n                const grid_and_agents_array = await utils.setAgentOnMonitoringGridAndChangeAgentStatus(agent,mapDetails.monitoring_grid, browserAdmin._id,mapDetails.laser_agents);\n\n                var new_monitoring_grid = grid_and_agents_array[0];\n                var new_laser_agents = grid_and_agents_array[1];\n\n                const result = await API.saveMonitoringGrid(new_monitoring_grid);\n                \n                if(result.data===\"successful\"){\n                    //we get the emregency monitored from the monitoring grid which is the central source of truth\n                    const emergency_full_row = await utils.getAdminEmergencyMonitored(browserAdmin._id,mapDetails.monitoring_grid);\n\n                    var emergency_monitored = emergency_full_row.emergency;\n\n                    if(emergency_monitored){\n\n                        //Refactor  ---------------------------------------------------------------------\n\n                        //we tell the agent to open the new route and go to the emergency or call\n                        try{\n                            const result = await pubnub.publish({\n                                message: {\n                                    pn_gcm: {\n                                        data: {\n                                            notification_body: \"You have a new route. Tap to open app.\",\n                                            data: emergency_monitored.phone_number ? {full_name: emergency_monitored.full_name, _id: emergency_monitored.user, phone_number: emergency_monitored.phone_number, latitude: emergency_monitored.latitude, longitude: emergency_monitored.longitude} : {full_name: emergency_monitored.full_name, _id: emergency_monitored.user, latitude: emergency_monitored.latitude, longitude: emergency_monitored.longitude},\n                                            action: \"route_request\"\n                                        }\n                                    }\n                                },\n                                channel: agent.agent._id,\n                                sendByPost: false, // true to send via POST\n                                storeInHistory: false //override default storage options\n                            })\n                        }\n                        catch(status){\n\n                        }\n\n\n                        //Refactor End  ---------------------------------------------------------------------\n\n                        //we subscribe the admin to the agents id channel\n                        var list =mapDetails.channels_list;\n\n                        if(list.indexOf(agent.agent._id)===-1){\n                            list.push(agent.agent._id)\n                        }\n\n                        //Refactor  ---------------------------------------------------------------------\n\n                        pubnub.subscribe({\n                            channels: list\n                        })\n\n                        //End Refactor  ---------------------------------------------------------------------\n\n\n                        //persist agents incase the user reloads the page or closes the browser\n                        var assigned_agents = persistence.getAssignedAgents();\n\n                        var new_assigned_agents = utils.addAgentToListOfAssignedAgentsForPersistence(agent, assigned_agents)\n                        \n                        persistence.saveAssignedAgents(new_assigned_agents);\n\n                        //we then update state\n                        setMapDetails({...mapDetails,\n                            monitoring_grid: new_monitoring_grid,\n                            laser_agents: new_laser_agents,\n                            //channels_list: list,\n                            action: \"message\",\n                            action_message: \"Agent \"+agent.agent.firstname +\" has been successfully assigned to the emergency\"\n                        })\n                    }\n                }\n\n                if(result.data===\"unsuccessful\"){\n                    //the grid was NOT successfully saved \n                        //show message\n                        setMapDetails({...mapDetails,\n                            action: \"message\",\n                            action_message: \"The system could NOT successfully assign the agent to the emergency\"\n                        })\n                }\n        }\n      }\n      else{\n\n      }\n  }\n    \n\n\n  const startMonitoring = async (e, item)=>{\n        \n    try{\n        //check if another admin is monitoring the emergency\n        const boolean_value = await utils.checkIfEmergencyMonitoredByOtherAdmin(  mapDetails.monitoring_grid, item, browserAdmin._id);\n\n        if(boolean_value){\n            //the emergency is being monitored by another admin\n            //tell the browser admin about this\n            setMapDetails({...mapDetails,\n                action: \"message\",\n                action_message: \"Another admin is already monitoring the selected emergency\"\n            })\n        }\n        else{\n            //we continue by editing the monitoring_grid and persisting it\n            const new_monitoring_grid = await utils.setEmergencyOnMonitoringGrid(item,mapDetails.monitoring_grid, browserAdmin._id);\n            \n            const result = await API.saveMonitoringGrid(new_monitoring_grid);\n            \n            if(result.data===\"successful\"){\n                //the grid was successfully saved \n                //change monitoring grid in local state\n                //subscribe to channel if user chose to be tracked\n                //show message\n\n                var list = mapDetails.channels_list ? mapDetails.channels_list : [];\n\n                //we subscribe to the items channel ONLY if the item is trackable\n                if(item.is_trackable){ \n                    if(list.indexOf(item.user)===-1){\n                        //remove old user from list\n                        //unsubscribe from old user\n            \n                        list.push(item.user)\n                    }\n\n                    //Refactor  ---------------------------------------------------------------------\n\n                    pubnub.subscribe({\n                        channels: list\n                    })\n\n                    //Refactor End  ---------------------------------------------------------------------\n                }\n                \n                setMapDetails({...mapDetails,\n                    action: \"message\",\n                    action_message: \"You are now monitoring \"+item.full_name,\n                    channels_list: list,\n                    monitoring_grid: new_monitoring_grid\n                })  \n            }\n\n            if(result.data===\"unsuccessful\"){\n                //the grid was NOT successfully saved \n                //show message\n                setMapDetails({...mapDetails,\n                    action: \"message\",\n                    action_message: \"The system could not initiate the monitoring of that emergency\"\n                })\n            }\n                        \n        }\n    }\n    catch(err){\n        console.log({err})\n        //show message\n        setMapDetails({...mapDetails,\n            action: \"message\",\n            action_message: \"Error occurred initiating monitoring of emergency\"\n        })\n    }\n}\n\n\nconst hideConfirm = () => {\n      setMapDetails({...mapDetails,\n        showConfirm: {\n          action: \"\",\n          status: false\n        },\n        message: \"\"\n    })\n}\n\nconst closeAction = (e) => {\n    setMapDetails({...mapDetails,\n        action: \"close\",\n        action_message: \"\"\n    })\n}\n\nconst closeSideBar = (e) => {\n    setMapDetails({...mapDetails,\n        play_sound: false,\n        side_bar_open: false,\n        location_side_bar_open: false,\n        manual_location_side_bar: false,\n        agent_side_bar_open: false,\n        selected_location: {},\n        selected_emergency: {},\n        clicked_marker_id: \"\"\n    })\n}\n\nconst closeAgentSideBar = (e) => {\n    setMapDetails({...mapDetails,\n        clicked_agent: {},\n        agent_side_bar_open: false\n    })\n}\n\nconst closeRouteResponse = (route_response) => {\n    let array = mapDetails.route_responses_from_agents;\n\n    array.splice(array.indexOf(route_response),1);\n\n    setMapDetails({\n        ...mapDetails,\n        route_responses_from_agents: array\n    })\n}\n\nconst getSelectedAgentsIds = () =>{\n    \n}\n\nconst setSelectedAgentsFromIds = (ids) => {\n    \n}\n\n//we get the monitoring grid from the server and update our variables\nconst getMonitoringGridFromServerAndReconcileAssignedAgents = async () => {\n\n        const response = await API.getMonitoringGrid();\n\n        if(response){\n            setUpAssignedAgentsIfAny(response.data);\n           \n            const emergency_full_row = await utils.getAdminEmergencyMonitored(browserAdmin._id, response.data)\n\n            var admin_emergency = emergency_full_row.emergency;\n\n            if(admin_emergency){\n\n                //we need to subscribe to the emergencies user id to receive location updates\n                if( mapDetails.channels_list.indexOf(admin_emergency.user) === -1){\n                    \n                    var list = mapDetails.channels_list.concat([admin_emergency.user]);\n                    \n                    //Refactor  ---------------------------------------------------------------------\n\n                    pubnub.subscribe({\n                        channels: list\n                    })\n\n                    //Refactor End ---------------------------------------------------------------------\n                    console.log(response.data)\n                    setMapDetails({...mapDetails, \n                        action: \"message\",\n                        action_message: \"You are monitoring \"+admin_emergency.full_name,\n                        monitoring_grid: response.data,\n                        channels_list: list\n                    });\n\n                    hideLoading();\n                }\n                else{\n                    //Refactor  ---------------------------------------------------------------------\n\n                    pubnub.subscribe({\n                        channels:   mapDetails.channels_list\n                    })\n                    \n                    //Refactor End  ---------------------------------------------------------------------\n\n                    setMapDetails({...mapDetails,\n                        action: \"message\",\n                        action_message: \"You are monitoring \"+admin_emergency.full_name,\n                        monitoring_grid: response.data\n                    });\n                    \n                    hideLoading();\n                }\n            }\n            else{\n                setMapDetails({...mapDetails,\n                    monitoring_grid: response.data\n                })\n                hideLoading();\n            }\n        }\n        else{\n            //show appropriate message\n            setMapDetails({...mapDetails,\n                action: \"message\",\n                action_message: \"An error occurred. Please check the network.\"\n            })\n            hideLoading();\n        }\n  }\n\n  const setUpAssignedAgentsIfAny = async(monitoring_grid) => {\n      var assigned_agents = persistence.getAssignedAgents();\n\n      if(assigned_agents && assigned_agents.length > 0){\n            var result = await utils.reconcileAssignedAgentsListWithMonitoringGrid(browserAdmin._id, assigned_agents, monitoring_grid);\n    \n            //result[0] //assigned agents list\n            //result[1] //laser agents\n    \n            if(result[0].length > 0){\n                persistence.saveAssignedAgents(result[0]);\n\n                //we subscribe to the id of each agent\n                let list = mapDetails.channels_list.concat(result[0]);\n                \n                //Refactor  ---------------------------------------------------------------------\n\n                pubnub.subscribe({\n                    channels: list\n                })\n\n                //Refactor End  ---------------------------------------------------------------------\n\n                setMapDetails({...mapDetails,\n                    laser_agents: result[1],\n                    channels_list: list\n                })\n            }\n            else{\n                persistence.deleteAssignedAgents();\n\n                setMapDetails({...mapDetails,\n                    laser_agents: result[1]\n                })\n            }\n      }\n  }\n\n  const removeAgentFromEmergencyAfterDecliningRequest = async (agent) =>{\n    showLoading();\n\n    const result = await utils.removeAgentFromBrowserAdminMonitoringGrid(agent, browserAdmin._id,   mapDetails.monitoring_grid,   mapDetails.laser_agents);\n    \n    if(result){\n        //result[0] //monitoring_grid\n        //result[1] //laser agents\n\n        const save_result = await API.saveMonitoringGrid(result[0]);\n\n        if(save_result){\n            if(save_result.data===\"successful\"){\n                //persist agents incase the user reloads the page or closes the browser\n                var assigned_agents = persistence.getAssignedAgents();\n\n                var new_assigned_agents = utils.removeAgentFromListOfAssignedAgentsForPersistsnce(agent, assigned_agents)\n                \n                if(new_assigned_agents.length > 0){\n                    persistence.saveAssignedAgents(new_assigned_agents);\n                }\n                else{\n                    persistence.deleteAssignedAgents();\n                }\n\n                //Refactor  ---------------------------------------------------------------------\n\n                //unsubscribe from agents channel\n                pubnub.unsubscribe({\n                    channels: [agent.agent._id]\n                })\n\n                //Refactor End  ---------------------------------------------------------------------\n\n                //we set state and update the monitoring grid and the laser agents list\n                setMapDetails({...mapDetails,\n                    action: \"message\",\n                    action_message: \"Agent \" +agent.agent.firstname +\" declined the request to attend to the emergency\",\n                    monitoring_grid: result[0],\n                    laser_agents: result[1],\n                    agent_side_bar_open: false,\n                    clicked_agent: {},\n                })\n\n                hideLoading();\n            }\n\n            if(save_result.data === \"unsuccessful\"){\n                hideLoading();\n                setMapDetails({...mapDetails,\n                    action: \"message\",\n                    action_message: \"An error occurred removing the agent from the emergency\"\n                })\n            }\n        }\n        else{\n            hideLoading();\n            setMapDetails({...mapDetails,\n                action: \"message\",\n                action_message: \"An error occurred removing the agent from the emergency\"\n            })\n        }\n\n    }\n    else{\n        hideLoading();\n        setMapDetails({...mapDetails,\n            action: \"message\",\n            action_message: \"An error occurred removing the agent from the emergency\"\n        })\n    }\n}\n\n\n\n  //this is not showing the agents in the same lga\n  const getAgentsAroundEmergency = async () => {\n    //show the agents around an emergency\n    //search to see if an emergency is being monitored by the admin browser\n    utils.checkIfEmergencyMonitoredByBrowserAdmin(browserAdmin._id, mapDetails.monitoring_grid)\n                .then( async (boolean_value) => {\n                    if(boolean_value){\n\n                        //Refactor  ---------------------------------------------------------------------\n\n                        //ideally this should be sent to those agents in the emergency's LGA\n                        //for now we are publishing to all agents \n                     try{\n                        await pubnub.publish(\n                        {\n                            message: {\n                                pn_gcm: {\n                                    data: {\n                                        notification_body: \"Tap to open the Laser App\",\n                                        data: {},\n                                        action: \"send_location\"\n                                    }\n                                }\n                            },\n                            channel: mapDetails.tracked_area,\n                            sendByPost: false, // true to send via POST\n                            storeInHistory: false //override default storage     \n                        })\n                     }\n\n                    catch(status){}\n\n                        //Refactor End  ---------------------------------------------------------------------\n\n                        utils.getAdminEmergencyMonitored(browserAdmin._id, mapDetails.monitoring_grid)\n                                .then(emergency_monitored => {\n                                    //admin is monitoring an emergency or call\n                                    //check for the agents in emergency LGA\n                                    utils.setAgentsInFocus(mapDetails.agents_in_focus, emergency_monitored.emergency, mapDetails.laser_agents)\n                                        .then(result => {\n                                            //we set the state for the laser agents and the agents in focus\n                                            setMapDetails({...mapDetails, \n                                                laser_agents: result[0],\n                                                agents_in_focus: result[1]\n                                            })\n                                        })\n                                        .catch(err => {\n                                            setMapDetails({\n                                                ...mapDetails,\n                                                action: \"message\",\n                                                action_message: \"An error occurred seeking agents around emergency\"\n                                            })\n                                        })\n                                })\n                                .catch(err => {\n\n                                })\n                    }\n                    else{\n                        setMapDetails({\n                            ...mapDetails,\n                            action: \"message\",\n                            action_message: \"You are NOT monitoring any emergency or call\"\n                        })\n                    }\n                })\n                .catch(err => {\n                    setMapDetails({\n                        ...mapDetails,\n                        action: \"message\",\n                        action_message: \"An error occurred seeking agents around emergency\"\n                    })\n                })\n    }\n\n\n    const latestClicked = (item) => {\n        switch(item.laser_type){\n            case \"emergency\":\n                setMapDetails({\n                    ...mapDetails, \n                    clicked_user: item,\n                    side_bar_open: true,\n                    location_side_bar_open: false,\n                    agent_side_bar_open: false,\n                    center: {\n                      lat: item.latitude,\n                      lng: item.longitude\n                    },\n                    zoom: 19,\n                    show_red_circle: true,\n                    show_blue_circle: false,\n                    clicked_marker_id: item._id\n                })\n                break;\n            case \"call\":\n                setMapDetails({\n                    ...mapDetails,\n                    clicked_user: item,\n                    side_bar_open: false,\n                    location_side_bar_open: true,\n                    agent_side_bar_open: false,\n                    center: {\n                        lat: item.latitude,\n                        lng: item.longitude\n                    },\n                    zoom: 19,\n                    show_red_circle: false,\n                    show_blue_circle: true,\n                    clicked_marker_id: item._id\n                })\n                break;\n        }\n    }\n\n\n    const openManualLocation = () => {\n        setMapDetails({\n            ...mapDetails,\n            manual_location_side_bar: true,\n            side_bar_open: false,\n            location_side_bar_open: false,\n            agent_side_bar_open: false\n        })\n    }\n\n\n    const onCalendarOpen = () => {\n        setMapDetails({\n            ...mapDetails,\n            play_sound: false,\n            side_bar_open: false, \n            location_side_bar_open: false,\n            agent_side_bar_open: false\n        })\n    }\n\n    const onDateChange = (date) => {\n\n        //We add 1 hour to the date because the date axios is sending to the server is 1 hour behind what it should be\n        date = new Date(date);\n        date.setHours(date.getHours() + 1);\n    \n         setMapDetails({\n            ...mapDetails,\n            play_sound: false,\n            date: date,\n            show_red_circle: false,\n            show_blue_circle: false,\n            clicked_marker_id: \" \",\n            action: \"loading\",\n            action_message: \"\",\n            selected_call:\"Calls (All)\", \n            selected_emergency:\"Emergencies (All)\"\n         })\n    \n         getLocationsDate(date);\n         getEmergenciesDate(date);\n    }\n\n    const onCallsChanged = (e) => {\n        e.preventDefault();\n        \n        const target = e.target;\n        const value = target.value;\n        const name = target.name;\n  \n        let arr = [];\n  \n        if(mapDetails.locations.length>0){\n            if(value===\"Calls (All)\"){\n              setMapDetails({\n                  ...mapDetails,\n                  play_sound: false,\n                  filtered_locations: mapDetails.locations,\n                  side_bar_open: false, \n                  selected_call: value,\n                  agent_side_bar_open: false,\n                  location_side_bar_open: false,\n                  show_blue_circle: false\n              })\n            }\n            else if(value===\"None\"){\n              setMapDetails({\n                    ...mapDetails,\n                    play_sound: false,\n                    filtered_locations: [],\n                    side_bar_open: false, \n                    selected_call: value,\n                    agent_side_bar_open: false,\n                    location_side_bar_open: false,\n                    show_blue_circle: false\n              })\n            }\n            else{\n              mapDetails.locations.map(emer => {\n                if(emer.reason.includes(value.toLowerCase())){\n                  arr.push(emer)\n                }\n              })\n              \n              if(arr.length>0){\n                setMapDetails({\n                    ...mapDetails,\n                    play_sound: false,\n                    filtered_locations: arr,\n                    selected_call: value,\n                    side_bar_open: false, \n                    agent_side_bar_open: false,\n                    location_side_bar_open: false,\n                    show_blue_circle: false\n                })\n              }\n              else{\n                //show message that there are no locations found for that parameter\n        \n                setMapDetails({\n                    ...mapDetails,\n                    play_sound: false,\n                    filtered_locations:[],\n                    selected_call: value,\n                    side_bar_open: false, \n                    location_side_bar_open: false,\n                    show_blue_circle: false\n                })\n              }\n            }\n        }\n        else{\n            setMapDetails({\n                ...mapDetails,\n                selected_call: value\n            })\n        }\n    }\n\n    const onEmergenciesChanged = (e) => {\n        const target = e.target;\n        const value = target.value;\n        const name = target.name;\n        \n        let arr = [];\n        if(mapDetails.emergencies.length>0){\n            if(value===\"Emergencies (All)\"){\n              setMapDetails({\n                    ...mapDetails,\n                    play_sound: false,\n                    filtered_emergencies: mapDetails.emergencies,\n                    side_bar_open: false, \n                    selected_emergency: value,\n                    location_side_bar_open: false,\n                    agent_side_bar_open: false,\n                    show_red_circle: false\n              })\n            }\n            else if(value===\"None\"){\n              setMapDetails({\n                  ...mapDetails,\n                  play_sound: false,\n                  filtered_emergencies:[],\n                  selected_emergency: value,\n                  side_bar_open: false, \n                  agent_side_bar_open: false,\n                  location_side_bar_open: false,\n                  show_red_circle: false\n              })\n            }\n            else{\n              mapDetails.emergencies.map(emer => {\n                if(emer.reasons&&emer.reasons.length>0){\n                  emer.reasons.map(reason => {\n                      if(value.toLowerCase().includes(reason)){\n                          arr.push(emer)\n                      }\n                  })\n                }\n              })\n        \n              if(arr.length>0){\n                    setMapDetails({\n                        ...mapDetails,\n                        play_sound: false,\n                        filtered_emergencies:arr,\n                        selected_emergency: value,\n                        side_bar_open: false, \n                        agent_side_bar_open: false,\n                        location_side_bar_open: false,\n                        show_red_circle: false\n                    })\n              }\n              else{\n                //show message that there are no emregencies found for that parameter\n        \n                setMapDetails({\n                    ...mapDetails,\n                    play_sound: false,\n                    filtered_emergencies: [],\n                    side_bar_open: false, \n                    selected_emergency: value,\n                    agent_side_bar_open: false,\n                    location_side_bar_open: false,\n                    show_red_circle: false\n                })\n              }\n            }\n        }    \n        else{\n            setMapDetails({\n                ...mapDetails, \n                selected_emergency: value\n            })\n        }\n    }\n\n    const onCallClicked = (location,e) => {\n            setMapDetails({\n                ...mapDetails,\n                play_sound: false,\n                clicked_user: location,\n                clicked_agent: {},\n                side_bar_open: false,\n                agent_side_bar_open: false,\n                manual_location_side_bar: false,\n                location_side_bar_open: true,\n                center: {\n                  lat: location.latitude,\n                  lng: location.longitude\n                },\n                zoom: 19,\n                show_red_circle: false,\n                show_blue_circle: true,\n                clicked_marker_id: location._id\n            })\n    }\n\n    const onEmergencyClicked = (emergency,e) => {\n       \n        setMapDetails({\n            ...mapDetails,\n            play_sound: false,\n            clicked_user: emergency,\n            clicked_agent: {},\n            side_bar_open: true,\n            manual_location_side_bar: false,\n            agent_side_bar_open: false,\n            location_side_bar_open: false,\n            center: {\n                lat: emergency.latitude,\n                lng: emergency.longitude\n            },\n            zoom: 19,\n            show_red_circle: true,\n            show_blue_circle: false,\n            clicked_marker_id: emergency._id\n        })\n    }\n    \n    const onAgentClicked = (agent,e) => {\n        setMapDetails({\n            ...mapDetails,\n            play_sound: false,\n            clicked_agent: agent,\n            manual_location_side_bar: false,\n            agent_side_bar_open: true\n        })\n    }\n\n    const getLocationsMarkers = () => {\n        let locations_ui;\n\n        if(mapDetails.filtered_locations && mapDetails.filtered_locations.length>0){\n            locations_ui = mapDetails.filtered_locations.map(loc => {\n                return  <Marker key={loc._id} onClick={e => onCallClicked(loc,e)}\n                            name={loc.reason} \n                            title={loc.full_name}\n                            position={{lat: loc.latitude, lng: loc.longitude}}\n                            icon={{\n                                url: (mapDetails.clicked_marker_id===loc._id) ? blue_circle : call_icon\n                            }}/> \n            })\n        }\n        else{\n            locations_ui = \"\";\n        }\n        \n        return locations_ui;\n    }\n\n    const getEmergenciesMarkers = () => {\n        let emergencies_ui;\n\n        let emergencies_to_show = mapDetails.filtered_emergencies.concat(mapDetails.filtered_emergencies);\n        \n        if(emergencies_to_show.length>0){\n            emergencies_ui = emergencies_to_show.map(emer => {\n              \n              return <Marker key={emer._id} onClick={e => onEmergencyClicked(emer,e)}\n                        name={emer.reasons[0]} \n                        title={emer.full_name}\n                        position={{lat: emer.latitude, lng: emer.longitude}}\n                        icon={{\n                          url: (mapDetails.clicked_marker_id===emer._id) ? red_circle : emergency_icon\n                        }}/>\n            })\n        }\n        else{\n            emergencies_ui = \"\";\n        }\n        \n        return emergencies_ui;\n    }\n\n\n    const getAgentMarkers = () => {\n        let agents_ui;\n  \n        if(mapDetails.laser_agents.length>0){\n              agents_ui = mapDetails.laser_agents.map((agent,i) => {\n                  \n                  return <Marker key={i}  onClick={e => onAgentClicked(agent,e)}\n                              name={agent.full_address} \n                              title={agent.full_address}\n                              position={{lat: agent.latitude, lng: agent.longitude}}\n                              //\n                              icon={{\n                                  url: getAgentIcon(agent),\n                                  anchor: new google.maps.Point(40,40),\n                                  scaledSize: new google.maps.Size(40,40)\n                              }}/>\n              })\n        }\n        else{\n              agents_ui = \"\";\n        }\n  \n        return agents_ui;\n    }\n\nconst getAgentIcon = (agent) => {\n    if(agent){\n        //we got the icon\n        switch(agent.agent.department){\n            case \"police\":\n                switch(agent.status){\n                    case \"idle\":\n                        return police_car;\n                    break;\n                    case \"infocus\":\n                        return police_car_in_focus;\n                    break;\n                    case \"using\":\n                        return police_car_using;\n                    break;\n                    case \"using_by_other\":\n                        return police_car_using_other;\n                    break;\n                }\n            break;\n            case \"fire\":\n                switch(agent.status){\n                    case \"idle\":\n                        return fire_car;\n                    break;\n                    case \"infocus\":\n                        return fire_car_in_focus;\n                    break;\n                    case \"using\":\n                        return fire_car_using;\n                    break;\n                    case \"using_by_other\":\n                        return fire_car_using_other;\n                    break;\n                }\n            break;\n            case \"hospital\":\n                switch(agent.status){\n                    case \"idle\":\n                        return ambulance;\n                    break;\n                    case \"infocus\":\n                        return ambulance_in_focus;\n                    break;\n                    case \"using\":\n                        return ambulance_using;\n                    break;\n                    case \"using_by_other\":\n                        return ambulance_using_other;\n                    break;\n                }\n            break;\n        }\n    }\n}\n\n\nconst getEmergencies = async() => {\n    const response = await API.getEmergencies({date: today})\n\n    if(response==\"error\"){\n        //show error message\n        setMapDetails({\n            ...mapDetails,\n            action: \"err_emergency_load\",\n            emergencies: [],\n            filtered_emergencies: []\n        })\n        return;\n    }\n\n    if(response&&response.data&&response.data.emergencies&&response.data.emergencies.length>0){\n        var loc = mapDetails.latest;\n\n        for(var i = 0; i<response.data.emergencies.length; i++){\n            if(!loc.includes(response.data.emergencies[i])){\n                loc.push(response.data.emergencies[i]);\n            }\n        }\n\n        loc = utils.sortDates(loc);\n\n        if(mapDetails.action === \"loading\"){\n            setMapDetails({\n                ...mapDetails,\n                action: \"close\",\n                latest : loc,\n                emergencies: response.data.emergencies,\n                filtered_emergencies: response.data.emergencies\n            })\n        }\n        else{\n            setMapDetails({\n                ...mapDetails,\n                latest : loc,\n                emergencies: response.data.emergencies,\n                filtered_emergencies: response.data.emergencies\n            })\n        }\n    }\n    else{\n        setMapDetails({\n            ...mapDetails,\n            action: \"close\",\n            emergencies: [],\n            filtered_emergencies: []\n        })\n    }\n}\n\nconst getLocations = async() => {\n\n    const response = await API.getLocations({date: today})\n\n    if(response==\"error\"){\n        //show error message\n        setMapDetails({\n            ...mapDetails,\n            action: \"err_calls_load\",\n            locations: [],\n            filtered_locations: []\n        })\n        return;\n    }\n\n    if(response&&response.data&&response.data.locations&&response.data.locations.length>0){\n        var loc = mapDetails.latest;\n\n        for(var i = 0; i<response.data.locations.length; i++){\n            if(!loc.includes(response.data.locations[i])){\n                loc.push(response.data.locations[i]);\n            }\n        }\n        \n        loc = utils.sortDates(loc);\n        \n        if(mapDetails.action === \"loading\"){\n            setMapDetails({\n                ...mapDetails,\n                action: \"close\",\n                latest : loc,\n                locations: response.data.locations,\n                filtered_locations: response.data.locations\n            })\n        }\n        else{\n            setMapDetails({\n                ...mapDetails,\n                latest : loc,\n                locations: response.data.locations,\n                filtered_locations: response.data.locations\n            })\n        } \n    }\n    else{\n        setMapDetails({\n            ...mapDetails,\n            action: \"close\",\n            locations: [],\n            filtered_locations: []\n        })\n    }\n}\n\n\nconst handleSongFinishedPlaying = () => {\n    setMapDetails({\n        ...mapDetails,\n        play_sound: false\n    })\n}\n\nconst onFieldChanged = (e) => {\n    const target = e.target;\n    const value = target.type === 'checkbox' ? target.checked : target.value;\n    const name = target.name;\n\n    setMapDetails({...mapDetails, [name]: value})\n}\n\nconst onManualCallChanged = (e) => {\n    const target = e.target;\n    const value = target.value;\n\n    setMapDetails({\n        ...mapDetails,\n        selected_manual_call: value\n  })\n}\n\nconst onManualGenderChanged = (e) => {\n    const target = e.target;\n    const value = target.value;\n\n    setMapDetails({\n        ...mapDetails,\n        selected_manual_gender: value\n    })\n}\n\nconst onSubmitManualCallDetails = (e) => {\n    e.preventDefault();\n\n    if(mapDetails.selected_manual_call.length <= 0){\n        setMapDetails({\n            ...mapDetails,\n            action: \"message\",\n            action_message: \"Please enter a valid reason for call from the drop down\"\n        })\n        return;\n    }\n\n    if(mapDetails.manual_phone.lenght <= 0){\n        setMapDetails({\n            ...mapDetails,\n            action: \"message\",\n            action_message: \"Please enter a valid phone number\"\n        })\n        return;\n    }\n\n    if(mapDetails.selected_manual_gender.length <= 0){\n        setMapDetails({\n            ...mapDetails,\n            action: \"message\",\n            action_message: \"Please enter a valid gender\"\n        })\n        return;\n    }\n\n    if(mapDetails.manual_name.length <= 0){\n        setMapDetails({\n            ...mapDetails,\n            action: \"message\",\n            action_message: \"Please enter a valid name\"\n        })\n        return;\n    }\n\n    if(mapDetails.manual_address.length <= 0){\n        setMapDetails({\n            ...mapDetails,\n            action: \"message\",\n            action_message: \"Please enter an address\"\n        })\n        return;\n    }\n\n    //show loading\n    //translate address to longitude and latitude\n    setMapDetails({\n        ...mapDetails,\n        action: \"loading\",\n        action_message: \"\"\n    })\n\n    Geocode.fromAddress(mapDetails.manual_address).then(\n          response => {\n                const { lat, lng } = response.results[0].geometry.location;\n\n                var location = {\n                    action: mapDetails.selected_manual_call,\n                    longitude: lng,\n                    latitude: lat,\n                    full_address: mapDetails.manual_address,\n                    full_name: mapDetails.manual_name,\n                    phone_number: mapDetails.manual_phone\n                }\n\n                saveManualLocation(location);\n\n          },\n          error => {\n            console.error(error);\n\n            setMapDetails({\n                ...mapDetails,\n                action: \"message\",\n                action_message: \"We could not find that address\",\n                showConfirmManualLocation: true\n            })\n          }\n    );\n}\n\nconst showConfirmManualLocation = () => {\n    setMapDetails({...mapDetails,showConfirmManualLocation: true})\n}\n\nconst hideConfirmManualLocation = () => {\n    setMapDetails({\n        ...mapDetails,\n        showConfirmManualLocation: false\n    })\n}\n\nconst tryAgainClicked = () => {\n    this.hideConfirmManualLocation();\n\n    setMapDetails({\n        ...mapDetails,\n        action: \"loading\",\n        action_message: \"\"\n    })\n\n    Geocode.fromAddress(mapDetails.manual_address).then(\n      response => {\n        const { lat, lng } = response.results[0].geometry.location;\n\n        var location = {\n              action: mapDetails.selected_manual_call,\n              longitude: lng,\n              latitude: lat,\n              full_address: mapDetails.manual_address,\n              full_name: mapDetails.manual_name,\n              phone_number: mapDetails.manual_phone\n        }\n\n        this.saveManualLocation(location);\n      },\n      error => {\n\n        setMapDetails({\n            ...mapDetails,\n            action: \"message\",\n            action_message: \"We could not find that address\"\n        })\n      }\n    );\n}\n\n\nconst continueConfirmAddressNotFoundClicked = () => {\n      this.hideConfirmManualLocation();\n      /*\n\n      this.setState({\n          action: \"loading\",\n          action_message: \"\"\n      });\n\n      var location = {\n          action: mapDetails.selected_manual_call,\n          longitude: lng,\n          latitude: lat,\n          full_address: mapDetails.manual_address,\n          full_name: mapDetails.manual_name,\n          phone_number: mapDetails.manual_phone\n      }\n\n      this.saveManualLocation(location);*/\n}\n\nconst closeConfirmAddressNotFoundClicked = () => {\n    setMapDetails({\n        ...mapDetails,\n        action: \"message\",\n        action_message: \"\"\n    })\n    this.hideConfirmManualLocation();\n}\n\nconst saveManualLocation = async(location) => {\n      const response = await API.createManualLocation(location)\n      \n      if(response==\"error\"){\n          //show error message\n          setMapDetails({\n              ...mapDetails,\n              action: \"message\",\n              action_message: \"An error occurred saving the location. Please try again\"\n          })\n\n          return;\n      }\n      \n      if(response&&response.data){\n          if(response.data.response===\"out_of_lagos\"){\n              setMapDetails({\n                  ...mapDetails,\n                  action: \"message\",\n                  action_message: \"That location is outside Lagos State\"\n              })\n              return;\n          }\n\n          setMapDetails({\n              ...mapDetails,\n              action: \"message\",\n              action_message: \"The location has been saved and is displayed on the map\",\n              selected_manual_call:\"Emergency Management(LASEMA)\",\n              selected_manual_gender:\"Male\",\n              manual_name: \"\",\n              manual_phone: \"\",\n              manual_address: \"\",\n              manual_location_side_bar: false\n          })\n\n          /*this.setState(state => {\n              let arr = state.locations;\n              let lat = state.latest;\n              \n              lat.push(response.data.response);\n              arr.push(response.data.response)\n\n              return {\n                  play_sound: true,\n                  latest: lat,\n                  clicked_marker_id: response.data.response._id,\n                  zoom: 18,\n                  locations: arr,\n                  center: {\n                      lat: response.data.response.latitude,\n                      lng: response.data.response.longitude\n                  }\n              }\n          })*/\n      }\n}\n\n\nconst getLocationsDate = async(date) => {\n    const response = await API.getLocations({date})\n    \n    if(response==\"error\"){\n        setMapDetails({\n            ...mapDetails,\n            action: \"err_calls_load\",\n            locations: [],\n            filtered_locations: []\n        })\n\n        return;\n    }\n\n    if(response&&response.data&&response.data.locations){\n        if(mapDetails.action === \"loading\"){\n            setMapDetails({\n                ...mapDetails,\n                action: \"close\",\n                locations: response.data.locations,\n                filtered_locations: response.data.locations\n            })\n        }\n        else{\n            setMapDetails({\n                ...mapDetails,\n                locations: response.data.locations,\n                filtered_locations: response.data.locations\n            })\n        }\n    }\n    else{\n        setMapDetails({\n            ...mapDetails,\n            action: \"close\",\n            locations: [],\n            filtered_locations: []\n        })\n    }\n}\n\nconst getEmergenciesDate = async(date) => {\n    const response = await API.getEmergencies({date})\n    \n    if(response==\"error\"){\n        setMapDetails({\n            ...mapDetails,\n            action: \"err_emergency_load\",\n            emergencies: [],\n            filtered_emergencies: []\n        })\n        return;\n    }\n\n    if(response&&response.data&&response.data.emergencies){\n        if(mapDetails.action === \"loading\"){\n            setMapDetails({\n                ...mapDetails,\n                action: \"close\",\n                emergencies: response.data.emergencies,\n                filtered_emergencies: response.data.emergencies\n            })\n        }\n        else{\n            setMapDetails({\n                ...mapDetails,\n                emergencies: response.data.emergencies,\n                filtered_emergencies: response.data.emergencies\n            })\n        }\n    }\n    else{\n        setMapDetails({\n            ...mapDetails,\n            action: \"close\",\n            emergencies: [],\n            filtered_emergencies: []\n        })\n    }\n}\n\n\nreturn <div className=\"laser-parent-div\" style={mapStyle}>\n            <Latest latest={  mapDetails.latest} latestClicked={latestClicked}/>\n            {  mapDetails.show_location_side_bar}\n            {  mapDetails.side_bar_open && <Sidebar closeSidebar={closeSideBar} startMonitoring={startMonitoring} emergency={mapDetails.clicked_user} resolve={showConfirmResolveEmergency} /> }\n            {  mapDetails.showConfirmManualLocation ? <ConfirmAddressNotFound closeConfirmAddressNotFoundClicked={continueConfirmAddressNotFoundClicked} tryAgainClicked={continueConfirmAddressNotFoundClicked} hideConfirmManualLocation={hideConfirmManualLocation} /> : \"\"}\n            {  mapDetails.manual_location_side_bar ? <AddCallManually onFieldChanged={onFieldChanged} closeSidebar={closeSideBar} selected_manual_call={  mapDetails.selected_manual_call} selected_manual_gender={  mapDetails.selected_manual_gender} manual_address={  mapDetails.manual_address} manual_name={  mapDetails.manual_name} onManualCallChanged={onManualCallChanged} onManualGenderChanged={onManualGenderChanged}  onSubmitManualCallDetails={onSubmitManualCallDetails}/> : \"\" }\n            \n            { \n                mapDetails.agent_side_bar_open ? <AgentDetails removeAgentFromRoute={removeAgentFromRoute} closeAgentSideBar={closeAgentSideBar} addAgentToMonitoring={addAgentToMonitoring} agent={  mapDetails.clicked_agent} user={  mapDetails.clicked_user}/> : \"\" \n            }\n\n            <TopPanel showMonitoredEmergency={showMonitoredEmergency} openManualLocation={openManualLocation} logout={logout} onCalendarOpen={onCalendarOpen} onDateChange={onDateChange} date={  mapDetails.date} selected_call={  mapDetails.selected_call} \n            onCallsChanged={onCallsChanged} selected_emergency={  mapDetails.selected_emergency} onEmergenciesChanged={onEmergenciesChanged} getAgentsAroundEmergency={getAgentsAroundEmergency}/>\n\n            <Map google={google} \n                style={mapStyle}\n                onReady={mapDetails.fetchPlaces}\n                initialCenter={  mapDetails.center}\n                center={  mapDetails.center}\n                zoom={  mapDetails.zoom}>\n        \n                {getLocationsMarkers()}\n                {getEmergenciesMarkers()}\n                {getAgentMarkers()}\n\n            </Map>\n            \n            <Loader isLoading={  mapDetails.isLoading}/>\n\n            <Action action={  mapDetails.action} closeAction={closeAction} message={  mapDetails.action_message}/>\n\n            {mapDetails.sound}\n\n            {\n                mapDetails.route_responses_from_agents.length > 0 ?  <RouteStatus route_response={  mapDetails.route_responses_from_agents[  mapDetails.route_responses_from_agents.length - 1]} removeAgentFromRouteAndCloseRouteResponse={removeAgentFromRouteAndCloseRouteResponse} closeRouteResponse={closeRouteResponse} /> : \"\"\n            }\n\n            {\n                mapDetails.showConfirm.status===true ? <ConfirmAction  yesClicked={  mapDetails.showConfirm.action===\"emergency\" ? mapDetails.resolveEmergency : mapDetails.resolveCall} noClicked={hideConfirm} message={  mapDetails.message} /> : \"\"\n            }\n    </div>\n}\n\nexport default GoogleApiWrapper({\n    apiKey: ('AIzaSyADNxHcgsHDyx_OSbqxBg5xB5lV2YJDcKI')\n})(Dashboard)"],"mappings":"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"},"metadata":{},"sourceType":"module"}
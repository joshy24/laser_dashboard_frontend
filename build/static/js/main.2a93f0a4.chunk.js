(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,n){e.exports=n(234)},108:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},149:function(e,t){},215:function(e,t,n){},234:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),r=n(15),c=n.n(r),i=n(100),s=n(10),o=n(11),d=n(16),m=n(17),u=n(35),_=n(34),g=n(8),h=n(36),p=(n(108),n(91)),b=n.n(p),E=n(92),f=n.n(E),y=n(93),k=n.n(y),C=n(94),v=n.n(C),w=n(95),S=n.n(w),O=n(24),x=n(96),A=n.n(x),j=n(51),D=n.n(j),N=function(){function e(){Object(d.a)(this,e)}return Object(m.a)(e,[{key:"getDate",value:function(e){return D()(e).utc().format("YYYY-MM-DD")}},{key:"getTime",value:function(e){return D()(e).utc().format("HH:mm:ss")}},{key:"sortDates",value:function(e){return e.sort(function(e,t){return new Date(e.created)-new Date(t.created)}),e}}]),e}(),L=new N,P={background:"rgba(0,0,0,0)",border:"0px solid #000000"};function F(e){return l.a.createElement("div",{className:"laser-side-bar"},l.a.createElement("h1",{className:"close_btn",onClick:function(t){return e.closeSidebar(t)}},"\u2715"),l.a.createElement("br",null),l.a.createElement("h4",{className:"text-center laser-red-text"},l.a.createElement("b",null,"Emergency Location Details")),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Trackable")," - ",e.emergency.isTrackable?l.a.createElement("button",{style:P},"Track this person now"):"User does not want to be tracked"),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Time")," - ",L.getTime(e.emergency.created)),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Persons Name")," - ",e.emergency.full_name),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Person's Emergency Contacts")," - ",e.emergency.emergency_numbers&&e.emergency.emergency_numbers.length>0?e.emergency.emergency_numbers.map(function(e,t){return l.a.createElement("p",{key:t},e)}):""),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Email Address")," - ",e.emergency.email?e.emergency.email:""),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Phone Number")," - ",e.emergency.phone_number?e.emergency.phone_number:""),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Device")," - ",e.emergency.device?e.emergency.device:""),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Emergency Full Address")," - ",e.emergency.full_address?e.emergency.full_address:""),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Emergency Admin Address")," - ",e.emergency.sub_admin_address?e.emergency.sub_admin_address:""),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Reason For Emergency")," - ",e.emergency.reasons?function(e){switch(e.length){case 0:return"";case 1:return e[0]+" issue";case 2:return e[0]+" issue, "+e[1]+" issue";case 3:return e[0]+" issue, "+e[1]+" issue, "+e[2]+" issue"}}(e.emergency.reasons):""))}var M=new N;function T(e){return l.a.createElement("div",{className:"laser-side-bar"},l.a.createElement("h1",{className:"close_btn",onClick:function(t){return e.closeSidebar(t)}},"\u2715"),l.a.createElement("br",null),l.a.createElement("h4",{className:"text-center laser-blue-text"},l.a.createElement("b",null,"Call Location Details")),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Time")," - ",M.getTime(e.location.created)),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Persons Name")," - ",e.location.full_name),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Email Address")," - ",e.location.email?e.location.email:""),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Phone Number")," - ",e.location.phone_number?e.location.phone_number:""),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Call Full Address")," - ",e.location.full_address?e.location.full_address:""),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Call Admin Address")," - ",e.location.sub_admin_address?e.location.sub_admin_address:""),l.a.createElement("br",null),l.a.createElement("h5",null,l.a.createElement("b",null,"Reason For Call")," - ",e.location.reason?e.location.reason:""))}var z=new N,B={background:"rgba(0,0,0,0)",border:"0px solid #000000"};function R(e){return l.a.createElement("button",{className:"laserItem",style:B,onClick:function(t){return e.itemClicked(t,e.item)}},l.a.createElement("h5",{style:I(e.item.laser_type)},e.item.full_name," - ",z.getTime(e.item.created)," - ",e.item.sub_admin_address))}function I(e){switch(e){case"emergency":return{color:"#E74C3C",textAlign:"left"};case"call":return{color:"#3498DB",textAlign:"left"};default:return{color:"#000000",textAlign:"left"}}}var Y=n(97),H=n.n(Y),W={width:"380px",height:"400px"},q=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(u.a)(this,Object(_.a)(t).call(this,e))).state={},n.itemClicked=n.itemClicked.bind(Object(g.a)(n)),n}return Object(h.a)(t,e),Object(m.a)(t,[{key:"itemClicked",value:function(e,t){e.preventDefault(),this.props.latestClicked(t)}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"laser-latest-div laser-shadow"},l.a.createElement("h4",{className:"text-center laser-black-text"},"Latest Reports"),l.a.createElement(H.a,{style:W},this.props.latest.map(function(t){return l.a.createElement(R,{key:t._id,itemClicked:e.itemClicked,item:t})})))}}]),t}(a.Component),J=n(52),G=n.n(J),K=n(98),U=n.n(K),V=(n(215),n(99)),Z=n.n(V),$=new N,Q={height:"100vh",width:"100%"},X={color:"#111111",border:"1px solid #FFFFFF",zIndex:"6000",marginLeft:"8px",marginRight:"8px",padding:"8px"},ee={marginLeft:"8px",marginRight:"8px"},te=(new Date).toISOString(),ne=Z.a.create({baseURL:"http://18.195.71.164",timeout:15e3,headers:{Accept:"application/json;q=0.9,*/*;q=0.8"}}),ae=function(e){function t(e){var n,a;Object(d.a)(this,t),(a=Object(u.a)(this,Object(_.a)(t).call(this,e))).state=(n={latest:[],locations:[],emergencies:[],filtered_locations:[],filtered_emergencies:[],side_bar_open:!1,location_side_bar_open:!1,selected_emergency:{},center:{lat:6.5244,lng:3.3792},selected_call:"Calls (All)"},Object(o.a)(n,"selected_emergency","Emergencies (All)"),Object(o.a)(n,"zoom",11),Object(o.a)(n,"show_red_circle",!1),Object(o.a)(n,"show_blue_circle",!1),Object(o.a)(n,"clicked_marker_id",""),Object(o.a)(n,"play_sound",!1),Object(o.a)(n,"date",new Date),n),a.closeSideBar=a.closeSideBar.bind(Object(g.a)(a)),a.onCallsChanged=a.onCallsChanged.bind(Object(g.a)(a)),a.onEmergenciesChanged=a.onEmergenciesChanged.bind(Object(g.a)(a)),a.onDateChange=a.onDateChange.bind(Object(g.a)(a)),a.onCalendarOpen=a.onCalendarOpen.bind(Object(g.a)(a)),a.latestClicked=a.latestClicked.bind(Object(g.a)(a));var l=te.split(/T(.+)/)[0];return l+="T00:00:00.000Z",te=new Date(l),a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"latestClicked",value:function(e){switch(e.laser_type){case"emergency":this.setState({play_sound:!0,selected_emergency:e,side_bar_open:!0,location_side_bar_open:!1,center:{lat:e.latitude,lng:e.longitude},zoom:19,show_red_circle:!0,show_blue_circle:!1,clicked_marker_id:e._id});break;case"call":this.setState({play_sound:!0,selected_location:e,side_bar_open:!1,location_side_bar_open:!0,center:{lat:e.latitude,lng:e.longitude},zoom:19,show_red_circle:!1,show_blue_circle:!0,clicked_marker_id:e._id})}}},{key:"onCalendarOpen",value:function(){this.setState({play_sound:!1,side_bar_open:!1,location_side_bar_open:!1})}},{key:"onDateChange",value:function(e){var t=this;this.setState({play_sound:!1,date:e,show_red_circle:!1,show_blue_circle:!1,clicked_marker_id:"",selected_call:"Calls (All)",selected_emergency:"Emergencies (All)"}),ne.post("/api/getLocations",{date:e}).then(function(e){e&&e.data&&e.data.locations?t.setState({locations:e.data.locations,filtered_locations:e.data.locations}):t.setState({locations:[],filtered_locations:[]})}).catch(function(e){console.log({error:e})}),ne.post("/api/getEmergencies",{date:e}).then(function(e){e&&e.data&&e.data.emergencies?t.setState({emergencies:e.data.emergencies,filtered_emergencies:e.data.emergencies}):t.setState({emergencies:[],filtered_emergencies:[]})}).catch(function(e){console.log({error:e})})}},{key:"onCallsChanged",value:function(e){var t=e.target,n=t.value,a=(t.name,[]);this.state.locations.length>0&&("Calls (All)"===n?this.setState(function(e){return{play_sound:!1,filtered_locations:e.locations,side_bar_open:!1,location_side_bar_open:!1,show_blue_circle:!1}}):"None"===n?this.setState({play_sound:!1,filtered_locations:[],side_bar_open:!1,location_side_bar_open:!1,show_blue_circle:!1}):(this.state.locations.map(function(e){e.reason.includes(n.toLowerCase())&&a.push(e)}),a.length>0?this.setState({play_sound:!1,filtered_locations:a,side_bar_open:!1,location_side_bar_open:!1,show_blue_circle:!1}):this.setState({play_sound:!1,filtered_locations:[],selected_call:"Calls (All)",side_bar_open:!1,location_side_bar_open:!1,show_blue_circle:!1})))}},{key:"onEmergenciesChanged",value:function(e){var t=e.target,n=t.value,a=(t.name,[]);this.state.emergencies.length>0&&("Emergencies (All)"===n?this.setState(function(e){return{play_sound:!1,filtered_emergencies:e.emergencies,side_bar_open:!1,location_side_bar_open:!1,show_red_circle:!1}}):"None"===n?this.setState({play_sound:!1,filtered_emergencies:[],side_bar_open:!1,location_side_bar_open:!1,show_red_circle:!1}):(this.state.emergencies.map(function(e){e.reasons&&e.reasons.length>0&&e.reasons.map(function(t){n.toLowerCase().includes(t)&&a.push(e)})}),a.length>0?this.setState({play_sound:!1,filtered_emergencies:a,side_bar_open:!1,location_side_bar_open:!1,show_red_circle:!1}):this.setState({play_sound:!1,filtered_emergencies:[],selected_emergency:"Emergencies (All)",side_bar_open:!1,location_side_bar_open:!1,show_red_circle:!1})))}},{key:"onLocationClicked",value:function(e,t){this.setState({play_sound:!1,selected_location:e,side_bar_open:!1,location_side_bar_open:!0,center:{lat:e.latitude,lng:e.longitude},zoom:19,show_red_circle:!1,show_blue_circle:!0,clicked_marker_id:e._id})}},{key:"onEmergencyClicked",value:function(e,t){this.setState({play_sound:!1,selected_emergency:e,side_bar_open:!0,location_side_bar_open:!1,center:{lat:e.latitude,lng:e.longitude},zoom:19,show_red_circle:!0,show_blue_circle:!1,clicked_marker_id:e._id})}},{key:"getLocationsMarkers",value:function(){var e=this;return this.state.filtered_locations.length>0?this.state.filtered_locations.map(function(t){return l.a.createElement(O.Marker,{key:t._id,onClick:function(n){return e.onLocationClicked(t,n)},name:t.reason,title:t.full_name,position:{lat:t.latitude,lng:t.longitude},icon:{url:e.state.clicked_marker_id===t._id?f.a:v.a}})}):""}},{key:"getEmergenciesMarkers",value:function(){var e=this;return this.state.filtered_emergencies.length>0?this.state.filtered_emergencies.map(function(t){return l.a.createElement(O.Marker,{key:t._id,onClick:function(n){return e.onEmergencyClicked(t,n)},name:t.reasons[0],title:t.full_name,position:{lat:t.latitude,lng:t.longitude},icon:{url:e.state.clicked_marker_id===t._id?b.a:k.a}})}):""}},{key:"closeSideBar",value:function(e){this.setState({play_sound:!0,side_bar_open:!1,location_side_bar_open:!1,selected_location:{},selected_emergency:{},clicked_marker_id:""})}},{key:"fetchPlaces",value:function(e,t){}},{key:"componentDidMount",value:function(){var e=this,t=A()("http://18.195.71.164");t.on("connect",function(){return console.log("connected to socket io")}),t.on("emergency",function(t){t&&e.setState(function(e){var n=e.emergencies,a=e.latest;return a.push(t),n.push(t),{play_sound:!0,latest:a,clicked_marker_id:t._id,zoom:18,emergencies:n,center:{lat:t.latitude,lng:t.longitude}}})}),t.on("call",function(t){t&&e.setState(function(e){var n=e.locations,a=e.latest;return a.push(t),n.push(t),{play_sound:!0,latest:a,clicked_marker_id:t._id,zoom:18,locations:n,center:{lat:t.latitude,lng:t.longitude}}})}),ne.post("/api/getLocations",{date:te}).then(function(t){t&&t.data&&t.data.locations&&t.data.locations.length>0?e.setState(function(e){for(var n=e.latest,a=0;a<t.data.locations.length;a++)n.push(t.data.locations[a]);return{latest:n=$.sortDates(n),locations:t.data.locations,filtered_locations:t.data.locations}}):e.setState({locations:[],filtered_locations:[]})}).catch(function(e){console.log({error:e})}),ne.post("/api/getEmergencies",{date:te}).then(function(t){t&&t.data&&t.data.emergencies&&t.data.emergencies.length>0?e.setState(function(e){for(var n=e.latest,a=0;a<t.data.emergencies.length;a++)n.push(t.data.emergencies[a]);return{latest:n=$.sortDates(n),emergencies:t.data.emergencies,filtered_emergencies:t.data.emergencies}}):e.setState({emergencies:[],filtered_emergencies:[]})}).catch(function(e){console.log({error:e})})}},{key:"render",value:function(){var e,t,n;return e=this.state.play_sound?l.a.createElement(G.a,{url:S.a,playStatus:G.a.status.PLAYING,playFromPosition:100,onLoading:this.handleSongLoading,onPlaying:this.handleSongPlaying,onFinishedPlaying:this.handleSongFinishedPlaying}):"",t=this.state.location_side_bar_open?l.a.createElement(T,{closeSidebar:this.closeSideBar,location:this.state.selected_location}):"",n=this.state.side_bar_open?l.a.createElement(F,{closeSidebar:this.closeSideBar,emergency:this.state.selected_emergency}):"",l.a.createElement("div",{className:"laser-parent-div",style:Q},l.a.createElement(q,{latest:this.state.latest,latestClicked:this.latestClicked}),t,n,l.a.createElement("div",{className:"laser-top-panel"},l.a.createElement("h4",{className:"laser-inline"},"Laser Emergency Admin Platform"),l.a.createElement("div",{className:"laser-controls laser-inline"},l.a.createElement("div",{className:"laser-inline",style:X},l.a.createElement(U.a,{onCalendarOpen:this.onCalendarOpen,maxDate:new Date,style:X,onChange:this.onDateChange,value:this.state.date})),l.a.createElement("select",{style:ee,className:"form-control laser-inline laser-150-width",id:"calls",name:"calls",value:this.selected_call,onChange:this.onCallsChanged},l.a.createElement("option",null,"Calls (All)"),l.a.createElement("option",null,"Emergency Management(LASEMA)"),l.a.createElement("option",null,"Police"),l.a.createElement("option",null,"Distress"),l.a.createElement("option",null,"Environmental and Special Offences Task Force"),l.a.createElement("option",null,"Fire / Safety Services"),l.a.createElement("option",null,"Environmental / Noise Pollution"),l.a.createElement("option",null,"Broken Pipe / Water Leakage"),l.a.createElement("option",null,"Pothole / Collapsed Road"),l.a.createElement("option",null,"None")),l.a.createElement("select",{style:ee,className:"form-control laser-inline laser-150-width",id:"emergencies",name:"emergencies",value:this.selected_call,onChange:this.onEmergenciesChanged},l.a.createElement("option",null,"Emergencies (All)"),l.a.createElement("option",null,"Police Cases"),l.a.createElement("option",null,"Hospital Cases"),l.a.createElement("option",null,"Fire Cases"),l.a.createElement("option",null,"None")))),e,l.a.createElement(O.Map,{google:this.props.google,style:Q,onReady:this.fetchPlaces,initialCenter:this.state.center,center:this.state.center,zoom:this.state.zoom},this.getLocationsMarkers(),this.getEmergenciesMarkers()))}}]),t}(a.Component),le=Object(O.GoogleApiWrapper)({apiKey:"AIzaSyADNxHcgsHDyx_OSbqxBg5xB5lV2YJDcKI"})(ae);var re=function(){return l.a.createElement(i.a,null,l.a.createElement(s.a,{path:"/",exact:!0,component:le}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(re,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},91:function(e,t,n){e.exports=n.p+"static/media/emergency_with_circle.d3c347cf.png"},92:function(e,t,n){e.exports=n.p+"static/media/call_with_circle.be8584e2.png"},93:function(e,t,n){e.exports=n.p+"static/media/emergency.5372e70f.png"},94:function(e,t,n){e.exports=n.p+"static/media/call.8f7505e8.png"},95:function(e,t,n){e.exports=n.p+"static/media/alert.77e4ae16.mp3"}},[[103,1,2]]]);
//# sourceMappingURL=main.2a93f0a4.chunk.js.map
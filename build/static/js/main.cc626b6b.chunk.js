(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{113:function(e,t,a){e.exports=a.p+"static/media/emergency_with_circle.0153b7ea.gif"},114:function(e,t,a){e.exports=a.p+"static/media/call_with_circle.34c87478.gif"},115:function(e,t,a){e.exports=a.p+"static/media/emergency.445ccffb.gif"},116:function(e,t,a){e.exports=a.p+"static/media/call.37865c67.gif"},117:function(e,t,a){e.exports=a.p+"static/media/alert.77e4ae16.mp3"},121:function(e,t,a){e.exports=a.p+"static/media/phone_white.23d1feaf.png"},127:function(e,t,a){e.exports=a(292)},133:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},134:function(e,t,a){e.exports=a.p+"static/media/car_test.4b63a07a.png"},175:function(e,t){},232:function(e,t,a){e.exports=a.p+"static/media/burger_menu.f128647b.png"},279:function(e,t,a){},289:function(e,t){},292:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(21),l=a.n(r),i=a(5),o=a(6),c=a(8),u=a(7),d=a(1),m=a(9),g=a(13),h=a(20),p=a(17),b=a(2),_=a.n(b),f=a(4),E=(a(133),a(113)),v=a.n(E),k=a(114),y=a.n(k),w=a(115),C=a.n(w),A=a(116),x=a.n(A),N=(a(134),a(62)),S=a.n(N),L=a(63),O=a.n(L),j=a(64),M=a.n(j),D=a(65),F=a.n(D),P=a(66),R=a.n(P),I=a(67),T=a.n(I),B=a(117),q=a.n(B),G=a(30),H=a(118),z=a.n(H),U=a(68),Y=a.n(U),J=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,[{key:"getDate",value:function(e){return Y()(e).utc().format("YYYY - MM - DD")}},{key:"getTime",value:function(e){return Y()(e).utc().format("HH:mm:ss")}},{key:"sortDates",value:function(e){return e.sort(function(e,t){return new Date(e.created)-new Date(t.created)}),e}}]),e}(),W=a(119),V=a.n(W),K=a(69),Z=a.n(K),$=function e(){var t=this;Object(i.a)(this,e),this.login=function(e,a){return t.axios("/login",{username:e,password:a}).then(function(e){return t.setToken(e.data.token),t.setPriviledge(e.data.priviledge),e}).catch(function(e){return"error"})},this.loggedIn=function(){var e=t.getToken();return!!e&&!t.isTokenExpired(e)},this.isTokenExpired=function(e){try{return Z()(e).exp<Date.now()/1e3}catch(t){return console.log("expired check failed! Line 42: AuthService.js"),!1}},this.setToken=function(e){localStorage.setItem("id_token",e)},this.getToken=function(){return localStorage.getItem("id_token")},this.logout=function(){localStorage.removeItem("id_token")},this.getConfirm=function(){var e=Z()(t.getToken());return console.log("Recieved answer!"),e},this.setPriviledge=function(e){localStorage.setItem("priviledge",e)},this.getPriviledge=function(){return localStorage.getItem("priviledge")},this.axios=function(e,a){var n={Accept:"application/json","Content-Type":"application/json"};return t.loggedIn()&&(n.Authorization="Bearer:"+t.getToken()),V()({url:e,method:"post",data:a,baseURL:"http://52.59.255.174/admin",timeout:3e4,headers:n}).then(t._checkStatus).then(function(e){return e}).catch(function(e){return e})},this._checkStatus=function(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}},Q=new J,X=new $;function ee(e){return s.a.createElement("div",{className:"laser-side-bar"},s.a.createElement("h1",{className:"close_btn",onClick:function(t){return e.closeSidebar(t)}},"\u2715"),s.a.createElement("br",null),s.a.createElement("h4",{className:"text-center laser-red-text"},s.a.createElement("b",null,"Emergency Location Details")),s.a.createElement("br",null),"full_control"===X.getPriviledge()?s.a.createElement("div",null,s.a.createElement("button",{className:"laser-red-bg laserbtn",onClick:function(t){return e.startMonitoring(t,e.emergency)}},"Start Monitoring"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("button",{className:"laser-blue-bg laserbtn",onClick:function(t){return e.resolve(t)}},"Resolve")):"",s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Trackable")," - ",e.emergency.is_trackable?"Yes":"No"),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Time")," - ",Q.getTime(e.emergency.created)),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Persons Name")," - ",e.emergency.full_name),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Person's Emergency Contacts")," - ",e.emergency.emergency_numbers&&e.emergency.emergency_numbers.length>0?e.emergency.emergency_numbers.map(function(e,t){return s.a.createElement("p",{key:t},e)}):""),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Email Address")," - ",e.emergency.email?e.emergency.email:""),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Phone Number")," - ",e.emergency.phone_number?e.emergency.phone_number:""),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Device")," - ",e.emergency.device?e.emergency.device:""),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Emergency Full Address")," - ",e.emergency.full_address?e.emergency.full_address:""),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Emergency Admin Address")," - ",e.emergency.sub_admin_address?e.emergency.sub_admin_address:""),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Reason For Emergency")," - ",e.emergency.reasons?function(e){switch(e.length){case 0:return"";case 1:return e[0]+" emergency";case 2:return e[0]+" emergency, "+e[1]+" emergency";case 3:return e[0]+" emergency, "+e[1]+" emergency, "+e[2]+" emergency"}}(e.emergency.reasons):""))}var te={width:"100%"};function ae(e){return s.a.createElement("div",{className:"laser-action_div laser-shadow"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h1",{style:te},s.a.createElement("span",{onClick:function(t){return e.closeAction(t)},className:"action_close_btn"},"\u2715"))),s.a.createElement("div",{className:"col-md-12"},s.a.createElement("h5",null,e.text))))}function ne(e){return s.a.createElement("div",null,function(e,t,a){switch(e){case"loading":return s.a.createElement(ae,{text:"Loading...",closeAction:a});case"close":return"";case"err_calls_load":return s.a.createElement(ae,{text:"An Error occurred loading latest calls",closeAction:a});case"err_emergency_load":return s.a.createElement(ae,{text:"An Error occurred loading latest emergencies",closeAction:a});case"message":return s.a.createElement(ae,{text:t,closeAction:a})}}(e.action,e.message,e.closeAction))}var se=new $,re={background:"#2E86C1",border:"0px solid #000000",color:"#FFFFFF",padding:"8px",borderRadius:"4px"},le={background:"#000000",border:"0px solid #000000",color:"#FFFFFF",padding:"8px",borderRadius:"4px"};function ie(e){return s.a.createElement("div",{className:"laser-agent_side-bar"},s.a.createElement("h1",{className:"close_btn",onClick:function(t){return e.closeAgentSideBar(t)}},"\u2715"),s.a.createElement("br",null),s.a.createElement("h4",{className:"text-center laser-black-text"},s.a.createElement("b",null,"Agents Details")),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Agents Name")," - ",e.agent.agent.firstname," ",e.agent.agent.lastname),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Phone Number")," - ",e.agent.agent.phone_number),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Agency")," - ",e.agent.agent.department),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Current Location")," - ",e.agent.full_address),s.a.createElement("br",null),"full_control"===se.getPriviledge()?s.a.createElement("div",null,s.a.createElement("h5",null,s.a.createElement("b",null,"Availability")," - ",e.agent.is_on_route?e.agent.agent.firstname+" is currently on route to a person's locations":e.agent.agent.firstname+" is available"),s.a.createElement("p",null,e.agent.is_on_route?s.a.createElement("button",{style:le,onClick:function(t){return e.removeAgentFromRoute(t,e.agent)},className:""},"Remove agent from route"):""),s.a.createElement("br",null),e.user.full_name?s.a.createElement("button",{style:re,onClick:function(t){return e.addAgentToMonitoring(t,e.agent)},className:""},"Send Agent ",e.agent.agent.firstname," ",e.agent.agent.lastname," to ",e.user.full_name,"'s location "):""):"")}var oe=new J,ce=new $;function ue(e){return s.a.createElement("div",{className:"laser-side-bar"},s.a.createElement("h1",{className:"close_btn",onClick:function(t){return e.closeSidebar(t)}},"\u2715"),s.a.createElement("br",null),s.a.createElement("h4",{className:"text-center laser-blue-text"},s.a.createElement("b",null,"Call Location Details")),s.a.createElement("br",null),s.a.createElement("br",null),"full_control"===ce.getPriviledge()?s.a.createElement("div",null,s.a.createElement("button",{className:"laser-blue-bg laserbtn",onClick:function(t){return e.resolve(t)}},"Resolve"),s.a.createElement("br",null)):"",s.a.createElement("h5",null,s.a.createElement("b",null,"Time")," - ",oe.getTime(e.location.created)),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Persons Name")," - ",e.location.full_name),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Email Address")," - ",e.location.email?e.location.email:""),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Phone Number")," - ",e.location.phone_number?e.location.phone_number:""),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Call Full Address")," - ",e.location.full_address?e.location.full_address:""),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Call Admin Address")," - ",e.location.sub_admin_address?e.location.sub_admin_address:""),s.a.createElement("br",null),s.a.createElement("h5",null,s.a.createElement("b",null,"Reason For Call")," - ",e.location.reason?e.location.reason:""))}new J,new $;var de={marginLeft:"8px",marginRight:"8px"};function me(e){return s.a.createElement("div",{className:"laser-side-bar"},s.a.createElement("h1",{className:"close_btn",onClick:function(t){return e.closeSidebar(t)}},"\u2715"),s.a.createElement("br",null),s.a.createElement("h4",{className:"text-center laser-blue-text"},s.a.createElement("b",null,"Add Call Manually")),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("label",{className:"laser-black-text",htmlFor:"category"},s.a.createElement("h5",null,"Full Name")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"manual_name",type:"text",name:"manual_name",onChange:e.onFieldChanged,value:e.manual_name,className:"form-control bt-login-input",placeholder:"Full Name"}),s.a.createElement("label",{className:"laser-black-text",htmlFor:"category"},s.a.createElement("h5",null,"Phone Number")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"manual_phone",type:"text",name:"manual_phone",onChange:e.onFieldChanged,value:e.manual_phone,className:"form-control bt-login-input",placeholder:"Phone Number"}),s.a.createElement("label",{className:"laser-black-text",htmlFor:"category"},s.a.createElement("h5",null,"Address")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"manual_address",type:"text",name:"manual_address",onChange:e.onFieldChanged,value:e.manual_address,className:"form-control bt-login-input",placeholder:"Address"}),s.a.createElement("br",null),s.a.createElement("label",{className:"laser-black-text",htmlFor:"category"},s.a.createElement("h5",null,"Reason For Call")),s.a.createElement("select",{style:de,className:"form-control laser-inline laser-150-width",id:"selected_manual_call",name:"selected_manual_call",value:e.selected_manual_call,onChange:e.onManualCallChanged},s.a.createElement("option",null,"Emergency Management(LASEMA)"),s.a.createElement("option",null,"Police"),s.a.createElement("option",null,"Distress"),s.a.createElement("option",null,"Environmental and Special Offences Task Force"),s.a.createElement("option",null,"Fire / Safety Services"),s.a.createElement("option",null,"Environmental / Noise Pollution"),s.a.createElement("option",null,"Broken Pipe / Water Leakage"),s.a.createElement("option",null,"Pothole / Collapsed Road"),s.a.createElement("option",null,"Domestic / Sexual Violence"),s.a.createElement("option",null,"None")),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("label",{className:"laser-black-text",htmlFor:"category"},s.a.createElement("h5",null,"Caller Gender")),s.a.createElement("select",{style:de,className:"form-control laser-inline laser-150-width",id:"selected_manual_gender",name:"selected_manual_gender",value:e.selected_manual_gender,onChange:e.onManualGenderChanged},s.a.createElement("option",null,"Male"),s.a.createElement("option",null,"Female")),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("button",{className:"laser-blue-bg laserbtn",onClick:function(t){return e.onSubmitManualCallDetails(t)}},"Submit"))}var ge=a(10),he=a.n(ge);he.a.setAppElement("#main");var pe={marginLeft:"16px",marginRight:"8px"},be={marginLeft:"8px",marginRight:"16px"};function _e(e){return s.a.createElement("div",null,s.a.createElement(he.a,{isOpen:!0,className:"ConfirmModal",overlayClassName:"Overlay",contentLabel:"Minimal Modal Example"},s.a.createElement("h4",{className:"text-center blue-text"},"Address Not Found"),s.a.createElement("br",null),s.a.createElement("h5",{className:"text-center"},"An Error occurred while attempting to locate that address. It could be that the address is wrong."),s.a.createElement("br",null),s.a.createElement("button",{className:"laser-inline laser-red-bg laserbtn",style:be,onClick:e.tryAgainClicked},"retry"),s.a.createElement("button",{className:"laser-inline laser-grey-bg laserbtn",style:pe,onClick:e.closeConfirmAddressNotFoundClicked},"cancel")))}var fe=a(120),Ee=a.n(fe),ve=(a(232),a(121)),ke=a.n(ve),ye=new $,we={color:"#111111",border:"1px solid #FFFFFF",zIndex:"6000",marginLeft:"8px",marginRight:"8px",padding:"8px"},Ce={marginLeft:"8px",marginRight:"8px"},Ae=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"laser-top-panel"},s.a.createElement("div",{className:"top-panel-left-div laser-inline"},s.a.createElement("button",{onClick:function(t){return e.props.openManualLocation(t)},className:"laser-inline laserbtn"},s.a.createElement("img",{src:ke.a,width:"20",height:"20"})),s.a.createElement("h4",{className:"laser-inline laser-header-text"}," Laser Emergency Admin - Monitoring and Dispatch")),s.a.createElement("div",{className:"laser-controls"},"full_control"===ye.getPriviledge()?s.a.createElement("button",{onClick:function(t){return e.props.getAllAgentsLocation(t)},className:"form-control laser-inline laser-150-width laser-red-bg laserbtn"},"Locate All Agents"):"",s.a.createElement("div",{className:"laser-inline",style:we},s.a.createElement(Ee.a,{onCalendarOpen:this.props.onCalendarOpen,maxDate:new Date,style:we,onChange:this.props.onDateChange,value:this.props.date})),s.a.createElement("select",{style:Ce,className:"form-control laser-inline laser-150-width",id:"calls",name:"calls",value:this.props.selected_call,onChange:this.props.onCallsChanged},s.a.createElement("option",null,"Calls (All)"),s.a.createElement("option",null,"Emergency Management(LASEMA)"),s.a.createElement("option",null,"Police"),s.a.createElement("option",null,"Distress"),s.a.createElement("option",null,"Environmental and Special Offences Task Force"),s.a.createElement("option",null,"Fire / Safety Services"),s.a.createElement("option",null,"Environmental / Noise Pollution"),s.a.createElement("option",null,"Broken Pipe / Water Leakage"),s.a.createElement("option",null,"Pothole / Collapsed Road"),s.a.createElement("option",null,"Domestic / Sexual Violence"),s.a.createElement("option",null,"None")),s.a.createElement("select",{style:Ce,className:"form-control laser-inline laser-150-width",id:"emergencies",name:"emergencies",value:this.props.selected_emergency,onChange:this.props.onEmergenciesChanged},s.a.createElement("option",null,"Emergencies (All)"),s.a.createElement("option",null,"Police Cases"),s.a.createElement("option",null,"Hospital Cases"),s.a.createElement("option",null,"Fire Cases"),s.a.createElement("option",null,"None")),s.a.createElement("button",{onClick:function(t){return e.props.logout(t)},className:"form-control laser-inline laser-100-width laser-grey-bg laserbtn"},"logout")))}}]),t}(n.Component),xe=new J,Ne={background:"rgba(0,0,0,0)",border:"0px solid #000000"};function Se(e){return s.a.createElement("button",{className:"laserItem",style:Ne,onClick:function(t){return e.itemClicked(t,e.item)}},s.a.createElement("h5",{style:Le(e.item.laser_type)},e.item.full_name," - ",xe.getTime(e.item.created)," - ",e.item.sub_admin_address))}function Le(e){switch(e){case"emergency":return{color:"#E74C3C",textAlign:"left"};case"call":return{color:"#3498DB",textAlign:"left"};default:return{color:"#000000",textAlign:"left"}}}var Oe=a(122),je=a.n(Oe),Me={width:"380px",height:"400px"},De=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={},a.itemClicked=a.itemClicked.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"itemClicked",value:function(e,t){e.preventDefault(),this.props.latestClicked(t)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"laser-latest-div laser-shadow"},s.a.createElement("h4",{className:"text-center laser-black-text"},"Latest Reports"),s.a.createElement(je.a,{style:Me},this.props.latest.map(function(t){return s.a.createElement(Se,{key:t._id,itemClicked:e.itemClicked,item:t})})))}}]),t}(n.Component),Fe={margin:"16px"},Pe={background:"#2E86C1",border:"0px solid #000000",color:"#FFFFFF",padding:"8px",borderRadius:"4px",float:"left",marginLeft:"20px"};function Re(e){return s.a.createElement("div",null,s.a.createElement(he.a,{isOpen:!0,className:"Modal",overlayClassName:"Overlay",contentLabel:"Minimal Modal Example"},s.a.createElement("h4",{className:"text-center"},"Message From Agent"),s.a.createElement("button",{className:"grey-bg bt-btn pull-right",style:Fe,onClick:e.closeRouteResponse},"close"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-8 col-sm-8"},s.a.createElement("h5",{className:"black-text"},e.route_response.agent.agent.firstname," ",e.route_response.agent.agent.lastname," has completed the route to ",e.route_response.user.full_name,"'s location")),s.a.createElement("div",{className:"col-md-4 col-sm-4"},s.a.createElement("h5",null,s.a.createElement("b",null,"Phone Number")),s.a.createElement("h5",null,e.route_response.agent.agent.phone_number))),s.a.createElement("div",{className:"row"},s.a.createElement("h5",null,s.a.createElement("button",{className:"green-bg bt-btn",style:Pe,onClick:function(t){return e.removeAgentFromRouteAndCloseRouteResponse(t,e.route_response.agent,e.route_response)}},"Remove Agent From Route")))))}he.a.setAppElement("#main"),he.a.setAppElement("#main");var Ie={marginLeft:"16px",marginRight:"8px"},Te={marginLeft:"8px",marginRight:"16px"};function Be(e){return s.a.createElement("div",null,s.a.createElement(he.a,{isOpen:!0,className:"ConfirmModal",overlayClassName:"Overlay",contentLabel:"Minimal Modal Example"},s.a.createElement("h4",{className:"text-center blue-text"},"Confirmation"),s.a.createElement("br",null),s.a.createElement("h5",{className:"text-center"},e.message),s.a.createElement("br",null),s.a.createElement("button",{className:"laser-inline laser-blue-bg laserbtn",style:Ie,onClick:e.yesClicked},"yes"),s.a.createElement("button",{className:"laser-inline grey-bg laserbtn",style:Te,onClick:e.noClicked},"no")))}var qe=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,[{key:"saveSelectedAgents",value:function(e){localStorage.setItem("selected_agents",JSON.stringify(e))}},{key:"getSelectedAgents",value:function(){return JSON.parse(localStorage.getItem("selected_agents"))}},{key:"saveTrackedUsers",value:function(e){localStorage.setItem("tracked_users",JSON.stringify(e))}},{key:"getTrackedUsers",value:function(){return JSON.parse(localStorage.getItem("tracked_users"))}}]),e}(),Ge=a(70),He=a.n(Ge),ze=a(123),Ue=a.n(ze),Ye=a(23),Je=a.n(Ye),We=(a(279),(new $).axios),Ve=function(e){return We("/getLocations",e).then(function(e){return e}).catch(function(e){return console.log({err:e}),"error"})},Ke=function(e){return We("/getEmergencies",e).then(function(e){return e}).catch(function(e){return console.log({err:e}),"error"})},Ze=function(e){return We("/create_agent",e).then(function(e){return e}).catch(function(e){return console.log(e),"error"})},$e=function(){return We("/get_departments").then(function(e){return e}).catch(function(e){return"error"})},Qe=function(e){return We("/create_admin",{name:e}).then(function(e){return e}).catch(function(e){return"error"})},Xe=new J,et=new qe,tt={height:"100vh",width:"100%"},at=(new Date).toISOString(),nt=null,st=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={showConfirm:{action:"",status:!1},latest:[],locations:[],emergencies:[],filtered_locations:[],filtered_emergencies:[],side_bar_open:!1,agent_side_bar_open:!1,location_side_bar_open:!1,manual_location_side_bar:!1,clicked_user:{},clicked_agent:{},center:{lat:6.5244,lng:3.3792},selected_call:"Calls (All)",selected_emergency:"Emergencies (All)",zoom:11,show_red_circle:!1,show_blue_circle:!1,clicked_marker_id:"",play_sound:!1,channels_list:["lllaser","agent_tracked","agent_untracked","users_monitored","issue_resolved","request_tracked","response_tracked"],laser_agents:[],selected_agents:[],route_responses_from_agents:[],tracked_users:[],action:"loading",action_message:"",tracked_area:"lllaser",date:new Date,message:"",selected_manual_call:"Emergency Management(LASEMA)",selected_manual_gender:"Male",manual_name:"",manual_phone:"",manual_address:"",showConfirmManualLocation:!1},a.pubnub=new Ue.a({publishKey:"pub-c-100b3918-0e25-4fac-ade6-c58d013cd019",subscribeKey:"sub-c-21e1e450-9457-11e9-bf84-1623aee89087"}),a.pubnub.init(Object(d.a)(a)),a.closeSideBar=a.closeSideBar.bind(Object(d.a)(a)),a.onCallsChanged=a.onCallsChanged.bind(Object(d.a)(a)),a.onEmergenciesChanged=a.onEmergenciesChanged.bind(Object(d.a)(a)),a.onAgentClicked=a.onAgentClicked.bind(Object(d.a)(a)),a.onDateChange=a.onDateChange.bind(Object(d.a)(a)),a.onCalendarOpen=a.onCalendarOpen.bind(Object(d.a)(a)),a.latestClicked=a.latestClicked.bind(Object(d.a)(a)),a.startMonitoring=a.startMonitoring.bind(Object(d.a)(a)),a.closeAction=a.closeAction.bind(Object(d.a)(a)),a.closeAgentSideBar=a.closeAgentSideBar.bind(Object(d.a)(a)),a.addAgentToMonitoring=a.addAgentToMonitoring.bind(Object(d.a)(a)),a.getAgentIcon=a.getAgentIcon.bind(Object(d.a)(a)),a.subscribeAndGetAllAgentsLocation=a.subscribeAndGetAllAgentsLocation.bind(Object(d.a)(a)),a.handleSongFinishedPlaying=a.handleSongFinishedPlaying.bind(Object(d.a)(a)),a.removeAgentFromRoute=a.removeAgentFromRoute.bind(Object(d.a)(a)),a.closeRouteResponse=a.closeRouteResponse.bind(Object(d.a)(a)),a.removeAgentFromRouteAndCloseRouteResponse=a.removeAgentFromRouteAndCloseRouteResponse.bind(Object(d.a)(a)),a.getEmergencies=a.getEmergencies.bind(Object(d.a)(a)),a.getLocations=a.getLocations.bind(Object(d.a)(a)),a.getLocationsDate=a.getLocationsDate.bind(Object(d.a)(a)),a.getEmergenciesDate=a.getEmergenciesDate.bind(Object(d.a)(a)),a.getLatestEmergencies=a.getLatestEmergencies.bind(Object(d.a)(a)),a.getLatestLocations=a.getLatestLocations.bind(Object(d.a)(a)),a.getSelectedAgentsIds=a.getSelectedAgentsIds.bind(Object(d.a)(a)),a.setSelectedAgentsFromIds=a.setSelectedAgentsFromIds.bind(Object(d.a)(a)),a.resolveCall=a.resolveCall.bind(Object(d.a)(a)),a.resolveEmergency=a.resolveEmergency.bind(Object(d.a)(a)),a.hideConfirm=a.hideConfirm.bind(Object(d.a)(a)),a.showConfirmResolveEmergency=a.showConfirmResolveEmergency.bind(Object(d.a)(a)),a.showConfirmResolveLocation=a.showConfirmResolveLocation.bind(Object(d.a)(a)),a.onManualCallChanged=a.onManualCallChanged.bind(Object(d.a)(a)),a.onManualGenderChanged=a.onManualGenderChanged.bind(Object(d.a)(a)),a.onSubmitManualCallDetails=a.onSubmitManualCallDetails.bind(Object(d.a)(a)),a.openManualLocation=a.openManualLocation.bind(Object(d.a)(a)),a.onFieldChanged=a.onFieldChanged.bind(Object(d.a)(a)),a.showConfirmManualLocation=a.showConfirmManualLocation.bind(Object(d.a)(a)),a.hideConfirmManualLocation=a.hideConfirmManualLocation.bind(Object(d.a)(a)),a.tryAgainClicked=a.tryAgainClicked.bind(Object(d.a)(a)),a.continueConfirmAddressNotFoundClicked=a.continueConfirmAddressNotFoundClicked.bind(Object(d.a)(a)),a.closeConfirmAddressNotFoundClicked=a.closeConfirmAddressNotFoundClicked.bind(Object(d.a)(a)),a.saveManualLocation=a.saveManualLocation.bind(Object(d.a)(a)),a.logout=a.logout.bind(Object(d.a)(a));var n=at.split(/T(.+)/)[0];return n+="T00:00:00.000Z",nt=new Date(n),Je.a.setApiKey("AIzaSyADNxHcgsHDyx_OSbqxBg5xB5lV2YJDcKI"),Je.a.setLanguage("en"),Je.a.setRegion("ngr"),Je.a.enableDebug(),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"logout",value:function(){this.props.logout()}},{key:"resolveEmergency",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t,a=this;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({showConfirm:{action:"",status:!1},message:"",action:"loading",action_message:""}),e.next=3,n={id:this.state.clicked_user._id},We("/resolveEmergency",n).then(function(e){return e}).catch(function(e){return console.log({err:e}),"error"});case 3:if("error"!=(t=e.sent)){e.next=7;break}return this.setState({action:"message",action_message:"Emergency could not be resolved. Try again later"}),e.abrupt("return");case 7:t&&(this.pubnub.publish({message:{},channel:"issue_resolved",sendByPost:!1,storeInHistory:!1},function(e,t){}),this.setState(function(e){var t=e.tracked_users;return t.splice(t.indexOf(a.state.clicked_user._id),1),et.saveTrackedUsers(t),{action:"close",side_bar_open:!1,tracked_users:t}}),this.getLocationsDate(this.state.date),this.getEmergenciesDate(this.state.date),this.setState({latest:[]}),this.getLatestLocations(),this.getLatestEmergencies());case 8:case"end":return e.stop()}var n},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"resolveCall",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({showConfirm:{action:"",status:!1},message:"",action:"loading",action_message:""}),e.next=3,a={id:this.state.clicked_user._id},We("/resolveCall",a).then(function(e){return e}).catch(function(e){return console.log({err:e}),"error"});case 3:"error"==(t=e.sent)&&this.setState({action:"message",action_message:"Call could not be resolved. Try again later"}),t&&(this.pubnub.publish({message:{},channel:"issue_resolved",sendByPost:!1,storeInHistory:!1},function(e,t){}),this.setState(function(e){var t=e.locations;return t.splice(t.indexOf(e.clicked_user)),{locations:t,action:"close",location_side_bar_open:!1}}),this.getLocationsDate(this.state.date),this.getEmergenciesDate(this.state.date),this.setState({latest:[]}),this.getLatestLocations(),this.getLatestEmergencies());case 6:case"end":return e.stop()}var a},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"hideConfirm",value:function(){this.setState({showConfirm:{action:"",status:!1},message:""})}},{key:"showConfirmResolveEmergency",value:function(e){e.preventDefault(),this.setState({showConfirm:{action:"emergency",status:!0},message:"Are you sure you want to mark this emergency issue as resolved ?"})}},{key:"showConfirmResolveLocation",value:function(){this.setState({showConfirm:{action:"location",status:!0},message:"Are you sure you want to mark this call as resolved ?"})}},{key:"removeAgentFromRoute",value:function(e,t){var a=this;e.preventDefault(),this.pubnub.publish({message:{pn_gcm:{data:{notification_body:"You need to abandon route. Tap to open app",data:{},action:"leave_route"}}},channel:t.agent._id,sendByPost:!1,storeInHistory:!1},function(e,t){}),this.pubnub.publish({message:{agent:t},channel:"agent_untracked",sendByPost:!1,storeInHistory:!1},function(e,t){}),this.setState(function(e){var n=e.selected_agents,s=e.channels_list,r=e.laser_agents,l=[];n.length>1&&(l=n.map(function(e){if(e&&e.agent._id!==t.agent._id)return e}));var i=s.splice(s.indexOf(t.agent._id),1),o=r.find(function(e){return e.agent._id===t.agent._id}),c=Object.assign({},o);c.is_on_route=!1;r.splice(r.indexOf(o),1,c);return a.pubnub.unsubscribe({channels:[t.agent._id]}),et.saveSelectedAgents(l),{selected_agents:l,laser_agents:r,channels_list:i,agent_side_bar_open:!1,clicked_agent:{},action:"message",action_message:"Agent "+t.agent.firstname+" "+t.agent.lastname+" has been removed from attending to "+a.state.clicked_user.full_name}})}},{key:"removeAgentFromRouteAndCloseRouteResponse",value:function(e,t,a){var n=this;e.preventDefault(),this.pubnub.publish({message:{pn_gcm:{data:{notification_body:"You need to abandon route. Tap to open app",data:{},action:"leave_route"}}},channel:t.agent._id,sendByPost:!1,storeInHistory:!1},function(e,t){}),this.pubnub.publish({message:{agent:t},channel:"agent_untracked",sendByPost:!1,storeInHistory:!1},function(e,t){}),this.setState(function(e){var s=e.selected_agents,r=e.channels_list,l=e.route_responses_from_agents;l.splice(l.indexOf(a),1);var i=[];s.length>1&&(i=s.map(function(e){if(e.agent._id!==t.agent._id)return e}));var o=r.splice(r.indexOf(t.agent._id),1);return n.pubnub.unsubscribe({channels:[t.agent._id]}),et.saveSelectedAgents(i),{selected_agents:i,channels_list:o,route_responses_from_agents:l,agent_side_bar_open:!1,clicked_agent:{},action:"message",action_message:"Agent "+t.agent.firstname+" "+t.agent.lastname+" has been removed from attending to "+n.state.clicked_user.full_name}})}},{key:"addAgentToMonitoring",value:function(e,t){var a=this;e.preventDefault(),this.pubnub.publish({message:{pn_gcm:{data:{notification_body:"You have a new route. Tap to open app.",data:this.state.clicked_user.phone_number?{full_name:this.state.clicked_user.full_name,_id:this.state.clicked_user.user,phone_number:this.state.clicked_user.phone_number,latitude:this.state.clicked_user.latitude,longitude:this.state.clicked_user.longitude}:{full_name:this.state.clicked_user.full_name,_id:this.state.clicked_user.user,latitude:this.state.clicked_user.latitude,longitude:this.state.clicked_user.longitude},action:"route_request"}}},channel:t.agent._id,sendByPost:!1,storeInHistory:!1},function(e,t){}),this.pubnub.publish({message:{agent:t},channel:"agent_tracked",sendByPost:!1,storeInHistory:!1},function(e,t){console.log({status:e}),console.log({response:t})}),this.setState(function(e){var n=e.selected_agents,s=e.channels_list,r=[];if(n.length>0){var l=!1;r=n.map(function(e){return e.agent._id===t.agent._id?(l=!0,t):e||void 0}),l||r.push(t)}else r.push(t);return-1===s.indexOf(t.agent._id)&&s.push(t.agent._id),a.pubnub.subscribe({channels:s}),et.saveSelectedAgents(r),{selected_agents:r,channels_list:s}})}},{key:"startMonitoring",value:function(e,t){var a=this;e.preventDefault(),this.pubnub.publish({message:{pn_gcm:{data:{notification_body:"Tap to open the laser App",data:{},action:"send_location"}}},channel:this.state.tracked_area,sendByPost:!1,storeInHistory:!1},function(e,t){}),this.setState(function(e){var n=e.channels_list,s=e.tracked_users;return-1===n.indexOf(t.user)&&n.push(t.user),s.find(function(e){return e===t.user})||s.push(t.user),et.saveTrackedUsers(s),a.pubnub.subscribe({channels:n}),{action:"message",action_message:"You are now monitoring "+t.full_name,channels_list:n,laser_agents:[],tracked_users:s}})}},{key:"latestClicked",value:function(e){switch(e.laser_type){case"emergency":this.setState({clicked_user:e,side_bar_open:!0,location_side_bar_open:!1,agent_side_bar_open:!1,center:{lat:e.latitude,lng:e.longitude},zoom:19,show_red_circle:!0,show_blue_circle:!1,clicked_marker_id:e._id});break;case"call":this.setState({clicked_user:e,side_bar_open:!1,location_side_bar_open:!0,agent_side_bar_open:!1,center:{lat:e.latitude,lng:e.longitude},zoom:19,show_red_circle:!1,show_blue_circle:!0,clicked_marker_id:e._id})}}},{key:"openManualLocation",value:function(){this.setState({manual_location_side_bar:!0,side_bar_open:!1,location_side_bar_open:!1,agent_side_bar_open:!1})}},{key:"onCalendarOpen",value:function(){this.setState({play_sound:!1,side_bar_open:!1,location_side_bar_open:!1,agent_side_bar_open:!1})}},{key:"onDateChange",value:function(e){(e=new Date(e)).setHours(e.getHours()+1),this.setState({play_sound:!1,date:e,show_red_circle:!1,show_blue_circle:!1,clicked_marker_id:"",action:"loading",action_message:"",selected_call:"Calls (All)",selected_emergency:"Emergencies (All)"}),this.getLocationsDate(e),this.getEmergenciesDate(e)}},{key:"onCallsChanged",value:function(e){var t=e.target,a=t.value,n=(t.name,[]);this.state.locations.length>0?"Calls (All)"===a?this.setState(function(e){return{play_sound:!1,filtered_locations:e.locations,side_bar_open:!1,selected_call:a,agent_side_bar_open:!1,location_side_bar_open:!1,show_blue_circle:!1}}):"None"===a?this.setState({play_sound:!1,filtered_locations:[],side_bar_open:!1,selected_call:a,agent_side_bar_open:!1,location_side_bar_open:!1,show_blue_circle:!1}):(this.state.locations.map(function(e){e.reason.includes(a.toLowerCase())&&n.push(e)}),n.length>0?this.setState({play_sound:!1,filtered_locations:n,selected_call:a,side_bar_open:!1,agent_side_bar_open:!1,location_side_bar_open:!1,show_blue_circle:!1}):this.setState({play_sound:!1,filtered_locations:[],selected_call:a,side_bar_open:!1,location_side_bar_open:!1,show_blue_circle:!1})):this.setState({selected_call:a})}},{key:"onEmergenciesChanged",value:function(e){var t=e.target,a=t.value,n=(t.name,[]);this.state.emergencies.length>0?"Emergencies (All)"===a?this.setState(function(e){return{play_sound:!1,filtered_emergencies:e.emergencies,side_bar_open:!1,selected_emergency:a,location_side_bar_open:!1,agent_side_bar_open:!1,show_red_circle:!1}}):"None"===a?this.setState({play_sound:!1,filtered_emergencies:[],selected_emergency:a,side_bar_open:!1,agent_side_bar_open:!1,location_side_bar_open:!1,show_red_circle:!1}):(this.state.emergencies.map(function(e){e.reasons&&e.reasons.length>0&&e.reasons.map(function(t){a.toLowerCase().includes(t)&&n.push(e)})}),n.length>0?this.setState({play_sound:!1,filtered_emergencies:n,selected_emergency:a,side_bar_open:!1,agent_side_bar_open:!1,location_side_bar_open:!1,show_red_circle:!1}):this.setState({play_sound:!1,filtered_emergencies:[],side_bar_open:!1,selected_emergency:a,agent_side_bar_open:!1,location_side_bar_open:!1,show_red_circle:!1})):this.setState({selected_emergency:a})}},{key:"onLocationClicked",value:function(e,t){this.setState({play_sound:!1,clicked_user:e,side_bar_open:!1,agent_side_bar_open:!1,manual_location_side_bar:!1,location_side_bar_open:!0,center:{lat:e.latitude,lng:e.longitude},zoom:19,show_red_circle:!1,show_blue_circle:!0,clicked_marker_id:e._id})}},{key:"onEmergencyClicked",value:function(e,t){this.setState({play_sound:!1,clicked_user:e,clicked_agent:{},side_bar_open:!0,manual_location_side_bar:!1,agent_side_bar_open:!1,location_side_bar_open:!1,center:{lat:e.latitude,lng:e.longitude},zoom:19,show_red_circle:!0,show_blue_circle:!1,clicked_marker_id:e._id})}},{key:"onAgentClicked",value:function(e,t){this.setState({play_sound:!1,clicked_agent:e,manual_location_side_bar:!1,agent_side_bar_open:!0})}},{key:"getLocationsMarkers",value:function(){var e=this;return this.state.filtered_locations.length>0?this.state.filtered_locations.map(function(t){return s.a.createElement(G.Marker,{key:t._id,onClick:function(a){return e.onLocationClicked(t,a)},name:t.reason,title:t.full_name,position:{lat:t.latitude,lng:t.longitude},icon:{url:e.state.clicked_marker_id===t._id?y.a:x.a}})}):""}},{key:"getEmergenciesMarkers",value:function(){var e=this;return this.state.filtered_emergencies.length>0?this.state.filtered_emergencies.map(function(t){return s.a.createElement(G.Marker,{key:t._id,onClick:function(a){return e.onEmergencyClicked(t,a)},name:t.reasons[0],title:t.full_name,position:{lat:t.latitude,lng:t.longitude},icon:{url:e.state.clicked_marker_id===t._id?v.a:C.a}})}):""}},{key:"getAgentMarkers",value:function(){var e=this;return this.state.laser_agents.length>0?this.state.laser_agents.map(function(t,a){return s.a.createElement(G.Marker,{key:a,onClick:function(a){return e.onAgentClicked(t,a)},name:t.full_address,title:t.full_address,position:{lat:t.latitude,lng:t.longitude},icon:{url:e.getAgentIcon(t),anchor:new e.props.google.maps.Point(40,40),scaledSize:new e.props.google.maps.Size(40,40)}})}):""}},{key:"getAgentIcon",value:function(e){if(e)switch(this.state.selected_agents.length>0&&this.state.selected_agents.map(function(t){t&&e.agent._id===t._id&&(e.is_on_route=!0)}),e.agent.department){case"police":return e.bearing>90||e.bearing,e.is_on_route?O.a:S.a;case"fire":return e.bearing>90||e.bearing,e.is_on_route?F.a:M.a;case"hospital":return e.bearing>90||e.bearing,e.is_on_route?T.a:R.a}}},{key:"closeAction",value:function(e){this.setState({action:"close",action_message:""})}},{key:"closeSideBar",value:function(e){this.setState({play_sound:!1,side_bar_open:!1,location_side_bar_open:!1,manual_location_side_bar:!1,agent_side_bar_open:!1,selected_location:{},selected_emergency:{},clicked_marker_id:""})}},{key:"closeAgentSideBar",value:function(e){this.setState({clicked_agent:{},agent_side_bar_open:!1})}},{key:"closeRouteResponse",value:function(e){this.setState(function(t){var a=t.route_responses_from_agents;return a.splice(a.indexOf(e),1),{route_responses_from_agents:a}})}},{key:"fetchPlaces",value:function(e,t){}},{key:"subscribeAndGetAllAgentsLocation",value:function(){this.pubnub.subscribe({channels:this.state.channels_list}),this.setState({laser_agents:[]}),this.pubnub.publish({message:{pn_gcm:{data:{notification_body:"Tap to open the Laser App",data:{},action:"send_location"}}},channel:this.state.tracked_area,sendByPost:!1,storeInHistory:!1},function(e,t){})}},{key:"getSelectedAgentsIds",value:function(){if(this.state.selected_agents.length>0){var e=[];return this.state.selected_agents.map(function(t){null!==t&&e.push(t.agent._id)}),e}return[]}},{key:"setSelectedAgentsFromIds",value:function(e){this.setState(function(t){var a=t.laser_agents,n=t.selected_agents;return a.map(function(t){var a=e.find(function(e){return e===t.agent._id});a&&(n.find(function(e){return e.agent._id===a})||n.push(t))}),et.saveSelectedAgents(n),{selected_agents:n}})}},{key:"componentWillUnmount",value:function(){this.pubnub.unsubscribe({channels:this.state.channels_list})}},{key:"componentDidMount",value:function(){var e=this,t=et.getSelectedAgents();null!==t&&t.length>0&&this.setState({selected_agents:t});var a=et.getTrackedUsers();null!==a&&a.length>0&&this.setState({tracked_users:a}),this.pubnub.subscribe({channels:this.state.channels_list}),this.subscribeAndGetAllAgentsLocation(),this.pubnub.addListener({status:function(t){"PNNetworkUpCategory"===t.category&&(e.pubnub.publish({message:{},channel:"request_tracked",sendByPost:!1,storeInHistory:!1},function(e,t){}),e.setState({action:"message",action_message:"You are online."})),"PNConnectedCategory"===t.category&&(e.pubnub.publish({message:{},channel:"request_tracked",sendByPost:!1,storeInHistory:!1},function(e,t){}),e.setState({action:"message",action_message:"You are online."})),"PNReconnectedCategory"===t.category&&(e.pubnub.publish({message:{},channel:"request_tracked",sendByPost:!1,storeInHistory:!1},function(e,t){}),e.setState({action:"message",action_message:"You are back online."})),"PNNetworkIssuesCategory"===t.category&&e.setState({action:"message",action_message:"It appears there is a network issue."}),"PNNetworkDownCategory"===t.category&&e.setState({action:"message",action_message:"It appears the network is down."}),"PNTimeoutCategory"===t.category&&e.setState({action:"message",action_message:"Could not connect to the internet."})},message:function(t){var a;"users_monitored"===t.channel&&((a=e.state.tracked_users.find(function(e){return e===t.message.user_id}))||e.setState(function(e){var a=e.tracked_users;return a.push(t.message.user_id),et.saveTrackedUsers(a),{tracked_users:a}}));if("agent_tracked"===t.channel&&e.setState(function(e){var a=e.laser_agents,n=[];return a.length>0&&(n=a.map(function(e){return e.agent._id===t.message.agent._id?(e.is_on_route=!0,e):e})),{laser_agents:n}}),"agent_untracked"===t.channel&&e.setState(function(e){var a=e.laser_agents,n=[];return a.length>0&&(n=a.map(function(e){return e.agent._id===t.message.agent._id?(e.is_on_route=!1,e):e})),{laser_agents:n}}),t.channel,"request_tracked"===t.channel&&(e.pubnub.publish({message:{agents:e.getSelectedAgentsIds()},channel:"response_tracked",sendByPost:!1,storeInHistory:!1},function(e,t){}),e.pubnub.publish({message:{users:e.state.tracked_users},channel:"response_tracked",sendByPost:!1,storeInHistory:!1},function(e,t){})),"response_tracked"===t.channel&&(t.message.agents&&t.message.agents.length>0&&e.setSelectedAgentsFromIds(t.message.agents),t.message.users&&t.message.users.length>0&&e.setState(function(e){var a=e.tracked_users;return t.message.users.map(function(e){a.find(function(t){return t===e})||a.push(e)}),et.saveTrackedUsers(a),{tracked_users:a}})),(a=e.state.tracked_users.find(function(e){return e===t.channel}))&&t.userMetadata&&"user_location_update"===t.userMetadata.action){var n=e.state.emergencies.map(function(e){return e.user===a?(e.latitude=t.message.latitude,e.longitude=t.message.longitude,e):e});e.setState(function(e){return{emergencies:n}})}if(t.channel===e.state.tracked_area&&t.userMetadata&&"agent_location_update"===t.userMetadata.action){var s,r=e.state.laser_agents;e.state.laser_agents.map(function(a){a.agent._id===t.message.agent._id&&(s=a,e.state.laser_agents.length<=0||!s?r.push(t.message):r=e.state.laser_agents.map(function(a){if(a.agent._id===t.message.agent._id){if(e.state.selected_agents.length>0)e.state.selected_agents.forEach(function(e,a){e&&e.agent._id===t.message.agent._id&&(n=e)}),t.message.is_on_route=!!n&&n.is_on_route;else t.message.is_on_route=!1;return t.message}var n;return e.state.selected_agents.length>0?(e.state.selected_agents.forEach(function(e,a){e&&e.agent._id===t.message.agent._id&&(n=e)}),a.is_on_route=!!n&&n.is_on_route):a.is_on_route=!1,a}))}),e.setState(function(e){return{laser_agents:r}})}e.state.selected_agents.length>0&&e.state.selected_agents.forEach(function(a,n){null!==a&&a.agent._id===t.channel&&(t.userMetadata&&"route_request_response"===t.userMetadata.action&&(!0===t.message.response?e.setState(function(t){var s=t.selected_agents;return s[n].is_on_route=!0,et.saveSelectedAgents(s),{selected_agents:s,action:"message",action_message:"Agent "+a.agent.firstname+" "+a.agent.lastname+" is now en route to "+e.state.clicked_user.full_name+"'s location"}}):e.setState(function(t){var s=t.selected_agents;return s[n].is_on_route=!1,et.saveSelectedAgents(s),{selected_agents:s,action:"message",action_message:"Agent "+a.agent.firstname+" "+a.agent.lastname+" declined the request to go to "+e.state.clicked_user.full_name+"'s location"}})),t.userMetadata&&"route_completed"===t.userMetadata.action&&t.message&&e.setState(function(e){var n=e.route_responses_from_agents,s=t.message;return n.push({user:s,agent:a}),{route_responses_from_agents:n}}))})}});var n=z()("http://52.59.255.174");n.on("connect",function(){return console.log("connected to socket io")}),n.on("reconnect",function(e){console.log("Socket IO Reconnected")}),n.on("emergency",function(t){t&&e.setState(function(e){var a=e.emergencies,n=e.latest;return n.push(t),a.push(t),{play_sound:!0,latest:n,clicked_marker_id:t._id,zoom:18,emergencies:a,center:{lat:t.latitude,lng:t.longitude}}})}),n.on("call",function(t){t&&e.setState(function(e){var a=e.locations,n=e.latest;return n.push(t),a.push(t),{play_sound:!0,latest:n,clicked_marker_id:t._id,zoom:18,locations:a,center:{lat:t.latitude,lng:t.longitude}}})}),this.getLocations(),this.getEmergencies()}},{key:"getLocationsDate",value:function(){var e=Object(f.a)(_.a.mark(function e(t){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve({date:t});case 2:if("error"!=(a=e.sent)){e.next=6;break}return this.setState({action:"err_calls_load",locations:[],filtered_locations:[]}),e.abrupt("return");case 6:a&&a.data&&a.data.locations?(console.log({response:a}),"loading"===this.state.action?this.setState({action:"close",locations:a.data.locations,filtered_locations:a.data.locations}):this.setState({locations:a.data.locations,filtered_locations:a.data.locations})):this.setState({action:"close",locations:[],filtered_locations:[]});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getEmergenciesDate",value:function(){var e=Object(f.a)(_.a.mark(function e(t){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke({date:t});case 2:if("error"!=(a=e.sent)){e.next=6;break}return this.setState({action:"err_emergency_load",emergencies:[],filtered_emergencies:[]}),e.abrupt("return");case 6:a&&a.data&&a.data.emergencies?(console.log({response:a}),"loading"===this.state.action?this.setState({action:"close",emergencies:a.data.emergencies,filtered_emergencies:a.data.emergencies}):this.setState({emergencies:a.data.emergencies,filtered_emergencies:a.data.emergencies})):this.setState({action:"close",emergencies:[],filtered_emergencies:[]});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getLatestLocations",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t,a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,Ve({date:nt});case 3:if("error"!=(a=e.sent)){e.next=6;break}return e.abrupt("return");case 6:a&&a.data&&a.data.locations&&a.data.locations.length>0&&t.setState(function(e){for(var t=e.latest,n=0;n<a.data.locations.length;n++)t.push(a.data.locations[n]);return{latest:t=Xe.sortDates(t)}});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getLatestEmergencies",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t,a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,Ke({date:nt});case 3:if("error"!=(a=e.sent)){e.next=6;break}return e.abrupt("return");case 6:a&&a.data&&a.data.emergencies&&a.data.emergencies.length>0&&t.setState(function(e){for(var t=e.latest,n=0;n<a.data.emergencies.length;n++)t.push(a.data.emergencies[n]);return{latest:t=Xe.sortDates(t)}});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getEmergencies",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t,a=this;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke({date:nt});case 2:if("error"!=(t=e.sent)){e.next=6;break}return this.setState({action:"err_emergency_load",emergencies:[],filtered_emergencies:[]}),e.abrupt("return");case 6:t&&t.data&&t.data.emergencies&&t.data.emergencies.length>0?this.setState(function(e){for(var n=e.latest,s=0;s<t.data.emergencies.length;s++)n.push(t.data.emergencies[s]);return n=Xe.sortDates(n),"loading"===a.state.action?{action:"close",latest:n,emergencies:t.data.emergencies,filtered_emergencies:t.data.emergencies}:{latest:n,emergencies:t.data.emergencies,filtered_emergencies:t.data.emergencies}}):this.setState({action:"close",emergencies:[],filtered_emergencies:[]});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getLocations",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t,a=this;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve({date:nt});case 2:if("error"!=(t=e.sent)){e.next=6;break}return this.setState({action:"err_calls_load",locations:[],filtered_locations:[]}),e.abrupt("return");case 6:t&&t.data&&t.data.locations&&t.data.locations.length>0?this.setState(function(e){for(var n=e.latest,s=0;s<t.data.locations.length;s++)n.push(t.data.locations[s]);return n=Xe.sortDates(n),"loading"===a.state.action?{action:"close",latest:n,locations:t.data.locations,filtered_locations:t.data.locations}:{latest:n,locations:t.data.locations,filtered_locations:t.data.locations}}):this.setState({action:"close",locations:[],filtered_locations:[]});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleSongFinishedPlaying",value:function(){this.setState({play_sound:!1})}},{key:"onFieldChanged",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;this.setState(Object(p.a)({},n,a))}},{key:"onManualCallChanged",value:function(e){var t=e.target.value;this.setState({selected_manual_call:t})}},{key:"onManualGenderChanged",value:function(e){var t=e.target.value;this.setState({selected_manual_gender:t})}},{key:"onSubmitManualCallDetails",value:function(e){var t=this;e.preventDefault(),this.state.selected_manual_call.length<=0?this.setState({action:"message",action_message:"Please enter a valid reason for call from the drop down"}):this.state.manual_phone.lenght<=0?this.setState({action:"message",action_message:"Please enter a valid phone number"}):this.state.selected_manual_gender.length<=0?this.setState({action:"message",action_message:"Please enter a valid gender"}):this.state.manual_name.length<=0?this.setState({action:"message",action_message:"Please enter a valid name"}):this.state.manual_address.length<=0?this.setState({action:"message",action_message:"Please enter an address"}):(this.setState({action:"loading",action_message:""}),Je.a.fromAddress(this.state.manual_address).then(function(e){var a=e.results[0].geometry.location,n=a.lat,s=a.lng,r={action:t.state.selected_manual_call,longitude:s,latitude:n,full_address:t.state.manual_address,full_name:t.state.manual_name,phone_number:t.state.manual_phone};t.saveManualLocation(r)},function(e){console.error(e),t.setState({action:"message",action_message:"We could not find that address",showConfirmManualLocation:!0})}))}},{key:"showConfirmManualLocation",value:function(){this.setState({showConfirmManualLocation:!0})}},{key:"hideConfirmManualLocation",value:function(){this.setState({showConfirmManualLocation:!1})}},{key:"tryAgainClicked",value:function(){var e=this;this.hideConfirmManualLocation(),this.setState({action:"loading",action_message:""}),Je.a.fromAddress(this.state.manual_address).then(function(t){var a=t.results[0].geometry.location,n=a.lat,s=a.lng,r={action:e.state.selected_manual_call,longitude:s,latitude:n,full_address:e.state.manual_address,full_name:e.state.manual_name,phone_number:e.state.manual_phone};e.saveManualLocation(r)},function(t){console.error(t),e.setState({action:"message",action_message:"We could not find that address"})})}},{key:"continueConfirmAddressNotFoundClicked",value:function(){this.hideConfirmManualLocation()}},{key:"closeConfirmAddressNotFoundClicked",value:function(){this.setState({action:"message",action_message:""}),this.hideConfirmManualLocation()}},{key:"saveManualLocation",value:function(){var e=Object(f.a)(_.a.mark(function e(t){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We("/create_manual_location",t).then(function(e){return e}).catch(function(e){return console.log({err:e}),"error"});case 2:if("error"!=(a=e.sent)){e.next=6;break}return this.setState({action:"message",action_message:"An error occurred saving the location. Please try again"}),e.abrupt("return");case 6:if(!a||!a.data){e.next=12;break}if(console.log({response:a}),"out_of_lagos"!==a.data.response){e.next=11;break}return this.setState({action:"message",action_message:"That location is outside Lagos State"}),e.abrupt("return");case 11:this.setState({action:"message",action_message:"The location has been saved and is displayed on the map",selected_manual_call:"Emergency Management(LASEMA)",selected_manual_gender:"Male",manual_name:"",manual_phone:"",manual_address:"",manual_location_side_bar:!1});case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a;return e=this.state.play_sound?s.a.createElement(He.a,{url:q.a,playStatus:He.a.status.PLAYING,playFromPosition:1,onLoading:this.handleSongLoading,onPlaying:this.handleSongPlaying,onFinishedPlaying:this.handleSongFinishedPlaying}):"",t=this.state.location_side_bar_open?s.a.createElement(ue,{closeSidebar:this.closeSideBar,location:this.state.clicked_user,resolve:this.showConfirmResolveLocation}):"",a=this.state.side_bar_open?s.a.createElement(ee,{closeSidebar:this.closeSideBar,emergency:this.state.clicked_user,startMonitoring:this.startMonitoring,resolve:this.showConfirmResolveEmergency}):"",s.a.createElement("div",{className:"laser-parent-div",style:tt},s.a.createElement(De,{latest:this.state.latest,latestClicked:this.latestClicked}),t,a,this.state.showConfirmManualLocation?s.a.createElement(_e,{closeConfirmAddressNotFoundClicked:this.continueConfirmAddressNotFoundClicked,tryAgainClicked:this.continueConfirmAddressNotFoundClicked,hideConfirmManualLocation:this.hideConfirmManualLocation}):"",this.state.manual_location_side_bar?s.a.createElement(me,{onFieldChanged:this.onFieldChanged,closeSidebar:this.closeSideBar,selected_manual_call:this.state.selected_manual_call,selected_manual_gender:this.state.selected_manual_gender,manual_address:this.state.manual_address,manual_name:this.state.manual_name,onManualCallChanged:this.onManualCallChanged,onManualGenderChanged:this.onManualGenderChanged,onSubmitManualCallDetails:this.onSubmitManualCallDetails}):"",this.state.agent_side_bar_open?s.a.createElement(ie,{removeAgentFromRoute:this.removeAgentFromRoute,closeAgentSideBar:this.closeAgentSideBar,addAgentToMonitoring:this.addAgentToMonitoring,agent:this.state.clicked_agent,user:this.state.clicked_user}):"",s.a.createElement(Ae,{openManualLocation:this.openManualLocation,logout:this.logout,onCalendarOpen:this.onCalendarOpen,onDateChange:this.onDateChange,date:this.state.date,selected_call:this.state.selected_call,onCallsChanged:this.onCallsChanged,selected_emergency:this.state.selected_emergency,onEmergenciesChanged:this.onEmergenciesChanged,getAllAgentsLocation:this.subscribeAndGetAllAgentsLocation}),e,s.a.createElement(G.Map,{google:this.props.google,style:tt,onReady:this.fetchPlaces,initialCenter:this.state.center,center:this.state.center,zoom:this.state.zoom},this.getLocationsMarkers(),this.getEmergenciesMarkers(),this.getAgentMarkers()),s.a.createElement(ne,{action:this.state.action,closeAction:this.closeAction,message:this.state.action_message}),this.state.route_responses_from_agents.length>0?s.a.createElement(Re,{route_response:this.state.route_responses_from_agents[this.state.route_responses_from_agents.length-1],removeAgentFromRouteAndCloseRouteResponse:this.removeAgentFromRouteAndCloseRouteResponse,closeRouteResponse:this.closeRouteResponse}):"",!0===this.state.showConfirm.status?s.a.createElement(Be,{yesClicked:"emergency"===this.state.showConfirm.action?this.resolveEmergency:this.resolveCall,noClicked:this.hideConfirm,message:this.state.message}):"")}}]),t}(n.Component),rt=Object(G.GoogleApiWrapper)({apiKey:"AIzaSyADNxHcgsHDyx_OSbqxBg5xB5lV2YJDcKI"})(st),lt=new J,it={marginLeft:"8px"};function ot(e){return s.a.createElement("div",{className:"col-md-4 col-sm-4"},s.a.createElement("div",{className:"laser-item shadow"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-7 col-sm-7"},s.a.createElement("h4",null,e.agent.firstname," ",e.agent.lastname),s.a.createElement("h5",null,lt.getDate(e.agent.created))),s.a.createElement("div",{className:"col-md-5 col-sm-5"},s.a.createElement("h5",null,e.agent.phone_number),s.a.createElement("h4",null,e.agent.department," department")),s.a.createElement("div",{className:"col-md-offset-6 col-md-6 col-sm-offset-6 col-sm-6"},s.a.createElement("button",{onClick:function(t){return e.deleteClicked(t,e.agent)},className:"laserbtn laser-red-bg laser-inline"},"delete"),s.a.createElement("button",{style:it,onClick:function(t){return e.editClicked(t,e.agent)},className:"laserbtn laser-blue-bg laser-inline"},"edit")))))}var ct=a(124),ut=a.n(ct);he.a.setAppElement("#main");var dt={display:"block",margin:"0 auto",border:"0px solid #000000"};function mt(e){return s.a.createElement("div",null,s.a.createElement(he.a,{isOpen:e.isLoading,className:"LoadingModal",overlayClassName:"LoadingOverlay",contentLabel:"Minimal Modal Example"},s.a.createElement(ut.a,{css:dt,sizeUnit:"px",size:80,color:"#2E86C1",loading:e.isLoading})))}he.a.setAppElement("#main");var gt={marginRight:"8px"},ht={marginLeft:"8px",marginRight:"16px"},pt={marginRight:"8px"},bt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={firstname:"",lastname:"",phone_number:"",department:"",password:"",password_again:"",error:"",isLoading:!1},a.submitClicked=a.submitClicked.bind(Object(d.a)(a)),a.onFieldChanged=a.onFieldChanged.bind(Object(d.a)(a)),a.showLoading=a.showLoading.bind(Object(d.a)(a)),a.hideLoading=a.hideLoading.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"showLoading",value:function(){this.setState({isLoading:!0})}},{key:"hideLoading",value:function(){this.setState({isLoading:!1})}},{key:"submitClicked",value:function(){var e=Object(f.a)(_.a.mark(function e(t){var a,n;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),this.setState({error:""}),!(this.state.firstname.length<=0||this.state.lastname.length<=0)){e.next=5;break}return this.setState({error:"Please enter a valid first and last name"}),e.abrupt("return");case 5:if(!(this.state.phone_number.length<11)){e.next=8;break}return this.setState({error:"Please enter a valid phone number"}),e.abrupt("return");case 8:if(!(this.state.department.length<0)){e.next=11;break}return this.setState({error:"Please enter a valid department"}),e.abrupt("return");case 11:if(!(this.state.password.length<8||this.state.password_again.length<8)){e.next=14;break}return this.setState({error:"Please enter a valid password with 8 characters or more"}),e.abrupt("return");case 14:if(this.state.password===this.state.password_again){e.next=17;break}return this.setState({error:"Passwords dont match"}),e.abrupt("return");case 17:return a={firstname:this.state.firstname,lastname:this.state.lastname,phone_number:this.state.phone_number,department:this.state.department,password:this.state.password,password_again:this.state.password_again},this.showLoading(),e.next=21,Ze(a);case 21:if("error"!=(n=e.sent)){e.next=25;break}return this.setState({action:"message",action_message:"An error occurred creating agent, Please try again later"}),e.abrupt("return");case 25:n&&n.data?(this.hideLoading(),this.props.closeModalGetAgents()):this.setState({action:"close"});case 26:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this;this.props.departments.length>0&&this.setState(function(t){return{department:e.props.departments[0]}})}},{key:"onFieldChanged",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;this.setState(Object(p.a)({},n,a))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(he.a,{isOpen:!0,className:"Modal",overlayClassName:"Overlay",contentLabel:"Minimal Modal Example"},s.a.createElement("h4",{className:"text-center blue-text"},"Add Agent"),s.a.createElement("br",null),s.a.createElement("h5",{className:"laser-red-text"},this.state.error?this.state.error:""),s.a.createElement("br",null),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-6"},s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"First Name")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"firstname",type:"text",name:"firstname",onChange:this.onFieldChanged,value:this.state.firstname,className:"form-control bt-login-input",placeholder:"First Name"})),s.a.createElement("div",{className:"col-md-6"},s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"Last Name")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"lastname",type:"text",name:"lastname",onChange:this.onFieldChanged,value:this.state.lastname,className:"form-control bt-login-input",placeholder:"Last Name"}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-6"},s.a.createElement("br",null),s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"Phone Number")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"phone_number",type:"phone",name:"phone_number",onChange:this.onFieldChanged,value:this.state.phone_number,className:"form-control bt-login-input",placeholder:"Phone Number"})),s.a.createElement("div",{className:"col-md-6"},s.a.createElement("br",null),s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"Department")),s.a.createElement("select",{style:pt,className:"form-control",id:"department",name:"department",value:this.state.department,onChange:this.onFieldChanged},this.props.departments.map(function(e){return s.a.createElement("option",null,e)})))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-6"},s.a.createElement("br",null),s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"Password")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"password",type:"password",name:"password",onChange:this.onFieldChanged,value:this.state.password,className:"form-control bt-login-input",placeholder:"Password"})),s.a.createElement("div",{className:"col-md-6"},s.a.createElement("br",null),s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"Password Again")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"password_again",type:"password",name:"password_again",onChange:this.onFieldChanged,value:this.state.password_again,className:"form-control bt-login-input",placeholder:"Password Again"}))),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("button",{className:"laser-inline laser-blue-bg laserbtn",style:gt,onClick:function(t){return e.submitClicked(t)}},"create"),s.a.createElement("button",{className:"laser-inline grey-bg laserbtn laser-black-text",style:ht,onClick:this.props.closeModal},"cancel")),s.a.createElement(mt,{isLoading:this.state.isLoading}))}}]),t}(n.Component),_t=(a(289),{marginLeft:"8px",marginRight:"8px"}),ft=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={agents:[],departments:[],agents_filter:[],selected_department:"",selected_agent:{},showConfirm:!1,showAddAgent:!1,showDeleteAgent:!1,showEditAgent:!1,confirmMessage:"",isLoading:!1},a.getAgents=a.getAgents.bind(Object(d.a)(a)),a.getAgentsDepartment=a.getAgentsDepartment.bind(Object(d.a)(a)),a.getDepartments=a.getDepartments.bind(Object(d.a)(a)),a.deleteAgent=a.deleteAgent.bind(Object(d.a)(a)),a.closeModal=a.closeModal.bind(Object(d.a)(a)),a.closeModalGetAgents=a.closeModalGetAgents.bind(Object(d.a)(a)),a.showDeleteAgent=a.showDeleteAgent.bind(Object(d.a)(a)),a.showAddAgent=a.showAddAgent.bind(Object(d.a)(a)),a.showEditAgent=a.showEditAgent.bind(Object(d.a)(a)),a.onDepartmentChanged=a.onDepartmentChanged.bind(Object(d.a)(a)),a.showLoading=a.showLoading.bind(Object(d.a)(a)),a.hideLoading=a.hideLoading.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"showLoading",value:function(){this.setState({isLoading:!0})}},{key:"hideLoading",value:function(){this.setState({isLoading:!1})}},{key:"getAgents",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoading(),e.next=3,We("/get_agents").then(function(e){return e}).catch(function(e){return console.log({err:e}),"error"});case 3:if(t=e.sent,this.hideLoading(),"error"!==t){e.next=7;break}return e.abrupt("return");case 7:t&&t.data&&t.data.length>0&&this.setState({agents:t.data});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAgentsDepartment",value:function(){var e=Object(f.a)(_.a.mark(function e(t){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoading(),e.next=3,We("/get_agents_departments",{department:t}).then(function(e){return e}).catch(function(e){return console.log({err:e}),"error"});case 3:if(a=e.sent,this.hideLoading(),"error"!==a){e.next=7;break}return e.abrupt("return");case 7:a&&a.data&&a.data.length>0&&this.setState({agents:a.data});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getDepartments",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoading(),e.next=3,$e();case 3:if(t=e.sent,this.hideLoading(),"error"!==t){e.next=7;break}return e.abrupt("return");case 7:t&&t.data&&t.data.length>0&&this.setState(function(e){var a=["All"];return t.data.map(function(e){a.push(e.name)}),{departments:a}});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"deleteAgent",value:function(){var e=Object(f.a)(_.a.mark(function e(t){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoading(),e.next=3,t=this.state.selected_agent._id,We("/delete_agent",{id:t}).then(function(e){return e}).catch(function(e){return console.log(e),"error"});case 3:if(a=e.sent,this.hideLoading(),"error"!==a){e.next=7;break}return e.abrupt("return");case 7:a&&a.data&&a.data.length>0&&(this.closeModal(),this.setState(function(e){var t=e.agents;return t.splice(t.indexOf(e.selected_agent),1),{agents:t,selected_agent:{}}}));case 8:case"end":return e.stop()}var t},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"closeModal",value:function(){this.setState({showConfirm:!1,showAddAgent:!1,showDeleteAgent:!1,showEditAgent:!1})}},{key:"closeModalGetAgents",value:function(){this.setState({showConfirm:!1,showAddAgent:!1,showDeleteAgent:!1,showEditAgent:!1}),this.getAgents()}},{key:"showDeleteAgent",value:function(e,t){e.preventDefault(),this.setState({selected_agent:t,showDeleteAgent:!0,confirmMessage:"Are you sure you want to delete agent "+t.firstname+"'s profile? This cant be undone."})}},{key:"showAddAgent",value:function(){this.setState({showAddAgent:!0})}},{key:"showEditAgent",value:function(e,t){e.preventDefault(),this.setState({showEditAgent:!0,selected_agent:t})}},{key:"onDepartmentChanged",value:function(e){var t=e.target.value;this.setState({selected_department:t}),"All"===t?this.getAgents():this.getAgentsDepartment(t)}},{key:"componentDidMount",value:function(){this.getAgents(),this.getDepartments()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"laser-parent-div"},s.a.createElement("div",{className:"laser-top-panel"},s.a.createElement("h4",{className:"laser-inline"},"Laser Emergency Admin - Agents"),s.a.createElement("div",{className:"laser-controls"},s.a.createElement(g.b,{style:_t,to:"/",className:"nav-link white-text link laser-inline laser-150-width"},s.a.createElement("button",{className:"laserbtn laser-white_border-blue-bg"},"View Map")),s.a.createElement("select",{style:_t,className:"form-control laser-inline laser-150-width",id:"filter",name:"filter",value:this.state.selected_department,onChange:this.onDepartmentChanged},this.state.departments.map(function(e){return s.a.createElement("option",null,e)})),s.a.createElement("button",{onClick:this.showAddAgent,style:_t,className:"laser-inline laser-100-width laserbtn laser-white_border-blue-bg"},"Add Agent"),s.a.createElement(g.b,{style:_t,to:"/admins",className:"nav-link white-text link"},s.a.createElement("button",{className:"laserbtn laser-white_border-blue-bg"},"Admins")),s.a.createElement(g.b,{style:_t,to:"/departments",className:"nav-link white-text link"},s.a.createElement("button",{className:"laserbtn laser-white_border-blue-bg"},"Departments")),s.a.createElement("button",{onClick:function(t){return e.props.logout(t)},className:"form-control laser-inline laser-100-width laser-grey-bg laserbtn pull-right"},"logout"))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"container"},this.state.agents.map(function(t){return s.a.createElement(ot,{agent:t,key:t._id,deleteClicked:e.showDeleteAgent,editClicked:e.showEditAgent})}))),s.a.createElement(mt,{isLoading:this.state.isLoading}),this.state.showAddAgent?s.a.createElement(bt,{closeModal:this.closeModal,departments:this.state.departments,closeModalGetAgents:this.closeModalGetAgents}):"",this.state.showDeleteAgent?s.a.createElement(Be,{yesClicked:this.deleteAgent,noClicked:this.closeModal,message:this.state.confirmMessage}):"")}}]),t}(n.Component),Et=new J,vt={marginLeft:"8px"};function kt(e){return s.a.createElement("div",{className:"col-md-6 col-sm-6"},s.a.createElement("div",{className:"laser-item shadow"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-7 col-sm-7"},s.a.createElement("h4",null,e.admin.username)),s.a.createElement("div",{className:"col-md-5 col-sm-5"},s.a.createElement("h5",null,e.admin.phone_number),s.a.createElement("h4",null,e.admin.priviledge," priviledge")),s.a.createElement("div",{className:"col-md-7 col-sm-7"},s.a.createElement("h4",null,e.admin.firstname," ",e.admin.lastname),s.a.createElement("h5",null,Et.getDate(e.admin.created)))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-offset-6 col-md-6 col-sm-offset-6 col-sm-6"},s.a.createElement("button",{onClick:e.deleteClicked(e.admin),className:"laserbtn laser-red-bg laser-inline"},"delete"),s.a.createElement("button",{style:vt,onClick:e.editClicked(e.admin),className:"laserbtn laser-blue-bg laser-inline"},"edit")))))}he.a.setAppElement("#main");var yt={marginRight:"8px"},wt={marginLeft:"8px",marginRight:"16px"},Ct={marginRight:"8px"},At=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={firstname:"",lastname:"",username:"",phone_number:"",password:"",password_again:"",priviledge:"",error:"",isLoading:!1},a.submitClicked=a.submitClicked.bind(Object(d.a)(a)),a.onFieldChanged=a.onFieldChanged.bind(Object(d.a)(a)),a.showLoading=a.showLoading.bind(Object(d.a)(a)),a.hideLoading=a.hideLoading.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"showLoading",value:function(){this.setState({isLoading:!0})}},{key:"hideLoading",value:function(){this.setState({isLoading:!1})}},{key:"submitClicked",value:function(){var e=Object(f.a)(_.a.mark(function e(t){var a,n;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),this.setState({error:""}),!(this.state.firstname.length<=0||this.state.lastname.length<=0)){e.next=5;break}return this.setState({error:"Please enter a valid first and last name"}),e.abrupt("return");case 5:if(!(this.state.phone_number.length<11)){e.next=8;break}return this.setState({error:"Please enter a valid phone number"}),e.abrupt("return");case 8:if(!(this.state.priviledge.length<0)){e.next=11;break}return this.setState({error:"Please enter a valid department"}),e.abrupt("return");case 11:if(!(this.state.username.length<0)){e.next=14;break}return this.setState({error:"Please enter a valid Username"}),e.abrupt("return");case 14:if(!(this.state.password.length<8||this.state.password_again.length<8)){e.next=17;break}return this.setState({error:"Please enter a valid password with 8 characters or more"}),e.abrupt("return");case 17:if(this.state.password===this.state.password_again){e.next=20;break}return this.setState({error:"Passwords dont match"}),e.abrupt("return");case 20:return a={firstname:this.state.firstname,lastname:this.state.lastname,phone_number:this.state.phone_number,username:this.state.username,priviledge:this.state.priviledge,password:this.state.password,password_again:this.state.password_again},e.next=23,Qe(a);case 23:if("error"!=(n=e.sent)){e.next=27;break}return this.setState({action:"message",action_message:"An error occurred creating agent, Please try again later"}),e.abrupt("return");case 27:n&&n.data?(this.hideLoading(),this.props.closeModalGetAgents()):this.setState({action:"close"});case 28:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onFieldChanged",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;this.setState(Object(p.a)({},n,a))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(he.a,{isOpen:!0,className:"AdminModal",overlayClassName:"Overlay",contentLabel:"Minimal Modal Example"},s.a.createElement("h4",{className:"text-center blue-text"},"Add Admin"),s.a.createElement("br",null),s.a.createElement("h5",{className:"laser-red-text"},this.state.error?this.state.error:""),s.a.createElement("br",null),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-6"},s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"User Name")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"username",type:"text",name:"username",onChange:this.onFieldChanged,value:this.state.username,className:"form-control bt-login-input",placeholder:"User Name"}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-6"},s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"First Name")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"firstname",type:"text",name:"firstname",onChange:this.onFieldChanged,value:this.state.firstname,className:"form-control bt-login-input",placeholder:"First Name"})),s.a.createElement("div",{className:"col-md-6"},s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"Last Name")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"lastname",type:"text",name:"lastname",onChange:this.onFieldChanged,value:this.state.lastname,className:"form-control bt-login-input",placeholder:"Last Name"}))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-6"},s.a.createElement("br",null),s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"Phone Number")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"phone_number",type:"phone",name:"phone_number",onChange:this.onFieldChanged,value:this.state.phone_number,className:"form-control bt-login-input",placeholder:"Phone Number"})),s.a.createElement("div",{className:"col-md-6"},s.a.createElement("br",null),s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"Priviledge")),s.a.createElement("select",{style:Ct,className:"form-control",id:"department",name:"department",value:this.state.department,onChange:this.onFieldChanged},s.a.createElement("option",null,"full_control"),s.a.createElement("option",null,"view_control")))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-6"},s.a.createElement("br",null),s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"Password")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"password",type:"password",name:"password",onChange:this.onFieldChanged,value:this.state.password,className:"form-control bt-login-input",placeholder:"Password"})),s.a.createElement("div",{className:"col-md-6"},s.a.createElement("br",null),s.a.createElement("label",{htmlFor:"category"},s.a.createElement("h5",null,"Password Again")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"password_again",type:"password",name:"password_again",onChange:this.onFieldChanged,value:this.state.password_again,className:"form-control bt-login-input",placeholder:"Password Again"}))),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("button",{className:"laser-inline laser-blue-bg laserbtn",style:yt,onClick:function(t){return e.submitClicked(t)}},"create"),s.a.createElement("button",{className:"laser-inline grey-bg laserbtn laser-black-text",style:wt,onClick:this.props.closeModal},"cancel")),s.a.createElement(mt,{isLoading:this.state.isLoading}))}}]),t}(n.Component);he.a.setAppElement("#main");var xt={marginRight:"8px"},Nt={marginLeft:"8px",marginRight:"16px"},St={marginRight:"8px"},Lt=(n.Component,{marginLeft:"8px",marginRight:"8px"}),Ot=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={admins:[],selected_admin:{},showConfirm:!1,showAddAdmin:!1,showDeleteAdmin:!1,showEditAdmin:!1,confirmMessage:"",isLoading:!1},a.getAdmins=a.getAdmins.bind(Object(d.a)(a)),a.deleteAdmin=a.deleteAdmin.bind(Object(d.a)(a)),a.closeModal=a.closeModal.bind(Object(d.a)(a)),a.closeModalGetAdmins=a.closeModalGetAdmins.bind(Object(d.a)(a)),a.showDeleteAdmin=a.showDeleteAdmin.bind(Object(d.a)(a)),a.showAddAdmin=a.showAddAdmin.bind(Object(d.a)(a)),a.showEditAdmin=a.showEditAdmin.bind(Object(d.a)(a)),a.showLoading=a.showLoading.bind(Object(d.a)(a)),a.hideLoading=a.hideLoading.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"showLoading",value:function(){this.setState({isLoading:!0})}},{key:"hideLoading",value:function(){this.setState({isLoading:!1})}},{key:"getAdmins",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoading(),e.next=3,We("/get_admins",{count:void 0}).then(function(e){return e}).catch(function(e){return"error"});case 3:if(t=e.sent,this.hideLoading(),"error"!==t){e.next=7;break}return e.abrupt("return");case 7:t&&t.data&&t.data.length>0&&this.setState({admins:t.data});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"deleteAdmin",value:function(){var e=Object(f.a)(_.a.mark(function e(t){var a;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoading(),e.next=3,t=this.state.selected_admin._id,We("/delete_admin",{id:t}).then(function(e){return e}).catch(function(e){return"error"});case 3:if(a=e.sent,this.hideLoading(),"error"!==a){e.next=7;break}return e.abrupt("return");case 7:a&&a.data&&a.data.length>0&&(this.closeModal(),this.setState(function(e){var t=e.admins;return t.splice(t.indexOf(e.selected_admin),1),{admins:t,selected_admin:{}}}));case 8:case"end":return e.stop()}var t},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"closeModal",value:function(){this.setState({showConfirm:!1,showAddAdmin:!1,showDeleteAdmin:!1,showEditAdmin:!1})}},{key:"closeModalGetAdmins",value:function(){this.setState({showConfirm:!1,showAddAdmin:!1,showDeleteAdmin:!1,showEditAdmin:!1}),this.getAdmins()}},{key:"showDeleteAdmin",value:function(e){this.setState({selected_admin:e,showDeleteAdmin:!0,confirmMessage:"Are you sure you want to delete admin "+e.firstname+"'s profile? This cant be undone."})}},{key:"showAddAdmin",value:function(){this.setState({showAddAdmin:!0})}},{key:"showEditAdmin",value:function(e){this.setState({showEditAdmin:!0,selected_admin:e})}},{key:"componentDidMount",value:function(){this.getAdmins()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"laser-parent-div"},s.a.createElement("div",{className:"laser-top-panel"},s.a.createElement("h4",{className:"laser-inline"},"Laser Emergency Admins"),s.a.createElement("div",{className:"laser-controls"},s.a.createElement(g.b,{style:Lt,to:"/",className:"nav-link white-text link laser-inline laser-150-width"},s.a.createElement("button",{className:"laserbtn laser-white_border-blue-bg"},"View Map")),s.a.createElement("button",{onClick:this.showAddAdmin,style:Lt,className:"laser-inline laser-150-width laserbtn laser-white_border-blue-bg"},"Add Admin"),s.a.createElement(g.b,{style:Lt,to:"/agents",className:"nav-link white-text link"},s.a.createElement("button",{className:"laserbtn laser-white_border-blue-bg"},"Agents")),s.a.createElement(g.b,{style:Lt,to:"/departments",className:"nav-link white-text link"},s.a.createElement("button",{className:"laserbtn laser-white_border-blue-bg"},"Departments")),s.a.createElement("button",{onClick:function(t){return e.props.logout(t)},className:"form-control laser-inline laser-100-width laser-grey-bg laserbtn pull-right"},"logout"))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"container"},this.state.admins.map(function(t){return s.a.createElement(kt,{admin:t,key:t._id,deleteClicked:e.deleteAdmin,editClicked:e.showEditAdmin})}))),s.a.createElement(mt,{isLoading:this.state.isLoading}),this.state.showAddAdmin?s.a.createElement(At,{closeModal:this.closeModal,departments:this.state.departments,closeModalGetAdmins:this.closeModalGetAdmins}):"",this.state.showDeleteAdmin?s.a.createElement(Be,{yesClicked:this.deleteAdmin,noClicked:this.closeModal,message:this.state.confirmMessage}):"")}}]),t}(n.Component),jt=new J,Mt={marginLeft:"16px"};function Dt(e){return s.a.createElement("div",{className:"col-md-4 col-sm-4"},s.a.createElement("div",{className:"laser-item shadow"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-7 col-sm-7"},s.a.createElement("h4",{className:"laser-black-text"},e.department.name)),s.a.createElement("div",{className:"col-md-5 col-sm-5"},s.a.createElement("h5",null,jt.getDate(e.department.created)))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-offset-6 col-md-6 col-sm-offset-6 col-sm-6"},s.a.createElement("button",{onClick:function(t){return e.deleteClicked(t,e.department)},className:"laserbtn laser-red-bg laser-inline"},"delete"),s.a.createElement("button",{style:Mt,onClick:function(t){return e.editClicked(t,e.department)},className:"laserbtn laser-blue-bg laser-inline"},"edit")))))}he.a.setAppElement("#main");var Ft={marginLeft:"16px",marginRight:"8px"},Pt={marginLeft:"8px",marginRight:"16px"},Rt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={name:"",action:"loading",action_message:"",isLoading:!1},a.showLoading=a.showLoading.bind(Object(d.a)(a)),a.hideLoading=a.hideLoading.bind(Object(d.a)(a)),a.onFieldChanged=a.onFieldChanged.bind(Object(d.a)(a)),a.saveDepartment=a.saveDepartment.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"showLoading",value:function(){this.setState({isLoading:!0})}},{key:"hideLoading",value:function(){this.setState({isLoading:!1})}},{key:"saveDepartment",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.state.name.length>0)){e.next=8;break}return e.next=3,a=this.state.name,We("/create_department",{name:a}).then(function(e){return e}).catch(function(e){return"error"});case 3:if("error"!=(t=e.sent)){e.next=7;break}return this.setState({action:"message",action_message:"An error occurred creating department, Please try again later"}),e.abrupt("return");case 7:t&&t.data?(this.props.closeModal(),this.props.getDepartments()):this.setState({action:"close"});case 8:case"end":return e.stop()}var a},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onFieldChanged",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;this.setState(Object(p.a)({},n,a))}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(he.a,{isOpen:!0,className:"ConfirmModal",overlayClassName:"Overlay",contentLabel:"Minimal Modal Example"},s.a.createElement("h4",{className:"text-center blue-text"},"Add Department"),s.a.createElement("label",{className:"laser-white-text",htmlFor:"category"},s.a.createElement("h5",null,"Department Name")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"name",type:"text",name:"name",onChange:this.onFieldChanged,value:this.state.name,className:"form-control bt-login-input",placeholder:"Department Name"}),s.a.createElement("br",null),s.a.createElement("button",{className:"laser-inline laser-blue-bg laserbtn",style:Ft,onClick:this.saveDepartment},"save"),s.a.createElement("button",{className:"laser-inline grey-bg laserbtn",style:Pt,onClick:this.props.closeModal},"cancel")),s.a.createElement(mt,{isLoading:this.state.isLoading}))}}]),t}(n.Component),It={marginLeft:"8px",marginRight:"8px"},Tt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={departments:[],selected_department:{},showConfirm:!1,showAddDepartment:!1,showDeleteDepartment:!1,showEditDepartment:!1,confirmMessage:"",isLoading:!1},a.getDepartments=a.getDepartments.bind(Object(d.a)(a)),a.deleteDepartment=a.deleteDepartment.bind(Object(d.a)(a)),a.closeModal=a.closeModal.bind(Object(d.a)(a)),a.showDeleteDepartment=a.showDeleteDepartment.bind(Object(d.a)(a)),a.showAddDepartment=a.showAddDepartment.bind(Object(d.a)(a)),a.showEditDepartment=a.showEditDepartment.bind(Object(d.a)(a)),a.showLoading=a.showLoading.bind(Object(d.a)(a)),a.hideLoading=a.hideLoading.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"showLoading",value:function(){this.setState({isLoading:!0})}},{key:"hideLoading",value:function(){this.setState({isLoading:!1})}},{key:"getDepartments",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoading(),e.next=3,$e();case 3:if(t=e.sent,this.hideLoading(),"error"!==t){e.next=7;break}return e.abrupt("return");case 7:t&&t.data&&t.data.length>0&&this.setState({departments:t.data});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"deleteDepartment",value:function(){var e=Object(f.a)(_.a.mark(function e(){var t;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.showLoading(),e.next=3,a=this.state.selected_department._id,We("/delete_department",{id:a}).then(function(e){return e}).catch(function(e){return"error"});case 3:if(t=e.sent,this.hideLoading(),"error"!==t){e.next=7;break}return e.abrupt("return");case 7:t&&t.data&&t.data&&(this.closeModal(),this.setState(function(e){var t=e.departments;return t.splice(t.indexOf(e.selected_department),1),{departments:t,selected_department:{}}}));case 8:case"end":return e.stop()}var a},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showDeleteDepartment",value:function(e,t){this.setState({selected_department:t,showDeleteDepartment:!0,confirmMessage:"Are you sure you want to delete the selected department?"}),e.preventDefault()}},{key:"showAddDepartment",value:function(){this.setState({showAddDepartment:!0})}},{key:"showEditDepartment",value:function(e,t){this.setState({showEditDepartment:!0,selected_department:t}),e.preventDefault()}},{key:"closeModal",value:function(){this.setState({showConfirm:!1,showAddDepartment:!1,showDeleteDepartment:!1,showEditDepartment:!1})}},{key:"componentDidMount",value:function(){this.getDepartments()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"laser-parent-div"},s.a.createElement("div",{className:"laser-top-panel"},s.a.createElement("h4",{className:"laser-inline"},"Laser Emergency Admin - Departments"),s.a.createElement("div",{className:"laser-controls"},s.a.createElement(g.b,{style:It,to:"/",className:"nav-link white-text link laser-inline laser-150-width"},s.a.createElement("button",{className:"laserbtn laser-white_border-blue-bg"},"View Map")),s.a.createElement(g.b,{style:It,to:"/agents",className:"nav-link white-text link"},s.a.createElement("button",{className:"laserbtn laser-white_border-blue-bg"},"Agents")),s.a.createElement(g.b,{style:It,to:"/admins",className:"nav-link white-text link"},s.a.createElement("button",{className:"laserbtn laser-white_border-blue-bg"},"Admins")),s.a.createElement(g.b,{style:It,to:"/departments",className:"nav-link white-text link"},s.a.createElement("button",{className:"laserbtn laser-white_border-blue-bg"},"Departments")),s.a.createElement("button",{style:It,onClick:this.showAddDepartment,className:"laser-inline laser-150-width laserbtn laser-white_border-blue-bg"},"Add Department"),s.a.createElement("button",{onClick:function(t){return e.props.logout(t)},className:"form-control laser-inline laser-100-width laser-grey-bg laserbtn pull-right"},"logout"))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"container"},s.a.createElement("br",null),this.state.departments.map(function(t){return s.a.createElement(Dt,{key:t._id,department:t,deleteClicked:e.showDeleteDepartment,editClicked:e.showEditDepartment})}))),this.state.showAddDepartment?s.a.createElement(Rt,{getDepartments:this.getDepartments,closeModal:this.closeModal}):"",this.state.showDeleteDepartment?s.a.createElement(Be,{yesClicked:this.deleteDepartment,noClicked:this.closeModal,message:this.state.confirmMessage}):"",s.a.createElement(mt,{isLoading:this.state.isLoading}))}}]),t}(n.Component),Bt=new $,qt={marginBottom:"0px",marginTop:"0px"},Gt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={username:"",password:"",error:"",isLoading:!1},a.submitClicked=a.submitClicked.bind(Object(d.a)(a)),a.onFieldChanged=a.onFieldChanged.bind(Object(d.a)(a)),a.showLoading=a.showLoading.bind(Object(d.a)(a)),a.hideLoading=a.hideLoading.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"showLoading",value:function(){this.setState({isLoading:!0})}},{key:"hideLoading",value:function(){this.setState({isLoading:!1})}},{key:"submitClicked",value:function(){var e=Object(f.a)(_.a.mark(function e(t,a){var n;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),this.setState({error:""}),!(this.state.username.length<=0||this.state.password.length<=0)){e.next=5;break}return this.setState({error:"Please make sure all fields are completed"}),e.abrupt("return");case 5:return this.showLoading(),e.next=8,Bt.login(this.state.username,this.state.password);case 8:if(n=e.sent,this.hideLoading(),"error"!==n){e.next=13;break}return this.setState({error:"An error occurred login you in. Please try again later."}),e.abrupt("return");case 13:n&&n.data&&(this.props.login(),this.props.history.push("/"));case 14:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"onFieldChanged",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;this.setState(Object(p.a)({},n,a))}},{key:"render",value:function(){return s.a.createElement("div",{className:"laser-login-bg"},s.a.createElement("div",{className:"laser-login-div laser-shadow"},s.a.createElement("h2",{className:"bt-blue-text laser-white-text",style:qt},"Admin"),s.a.createElement("h2",{className:"bt-blue-text laser-white-text",style:qt},"Login"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("h5",{className:"laser-red-text"},this.state.error?this.state.error:""),s.a.createElement("br",null),s.a.createElement("label",{className:"laser-white-text",htmlFor:"category"},s.a.createElement("h5",null,"User Name")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"username",type:"text",name:"username",onChange:this.onFieldChanged,value:this.state.username,className:"form-control bt-login-input",placeholder:"User Name"}),s.a.createElement("br",null),s.a.createElement("label",{className:"laser-white-text",htmlFor:"category"},s.a.createElement("h5",null,"Password")),s.a.createElement("input",{required:!0,autoComplete:"off",id:"password",type:"password",name:"password",onChange:this.onFieldChanged,value:this.state.password,className:"form-control bt-login-input",placeholder:"Password"}),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("button",{className:"laser-blue-bg laserbtn",onClick:this.submitClicked},"CONTINUE")),s.a.createElement(mt,{isLoading:this.state.isLoading}))}}]),t}(n.Component),Ht=new $,zt=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).logout=function(){Ht.logout(),a.setState({isLogin:!0})},a.login=function(){a.setState({isLogin:!1})},a.state={isLogin:!1},a.logout=a.logout.bind(Object(d.a)(a)),a.login=a.login.bind(Object(d.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(g.a,null,s.a.createElement(h.b,{path:"/",exact:!0,render:function(t){return!0===Ht.loggedIn()?s.a.createElement(rt,Object.assign({},t,{logout:e.logout})):s.a.createElement(h.a,{to:"/login",login:e.login})}}),s.a.createElement(h.b,{path:"/agents",exact:!0,render:function(t){return!0===Ht.loggedIn()?"full_control"===Ht.getPriviledge()?s.a.createElement(ft,Object.assign({},t,{logout:e.logout})):s.a.createElement(h.a,{to:"/",login:e.login}):s.a.createElement(h.a,{to:"/login",login:e.login})}}),s.a.createElement(h.b,{path:"/admins",exact:!0,render:function(t){return!0===Ht.loggedIn()?"full_control"===Ht.getPriviledge()?s.a.createElement(Ot,Object.assign({},t,{logout:e.logout})):s.a.createElement(h.a,{to:"/",login:e.login}):s.a.createElement(h.a,{to:"/login",login:e.login})}}),s.a.createElement(h.b,{path:"/departments",exact:!0,render:function(t){return!0===Ht.loggedIn()?"full_control"===Ht.getPriviledge()?s.a.createElement(Tt,Object.assign({},t,{logout:e.logout})):s.a.createElement(h.a,{to:"/",login:e.login}):s.a.createElement(h.a,{to:"/login",login:e.login})}}),s.a.createElement(h.b,{path:"/login",exact:!0,render:function(t){return!1===Ht.loggedIn()?s.a.createElement(Gt,Object.assign({},t,{login:e.login})):s.a.createElement(h.a,Object.assign({to:"/"},t,{logout:e.logout}))}}),1==this.state.isLogin?s.a.createElement(h.a,{to:"/login",login:this.login}):""))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(zt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},62:function(e,t,a){e.exports=a.p+"static/media/police_car.d5d82e20.png"},63:function(e,t,a){e.exports=a.p+"static/media/police_car_yellow.303f7897.png"},64:function(e,t,a){e.exports=a.p+"static/media/fire_truck.651626d2.png"},65:function(e,t,a){e.exports=a.p+"static/media/fire_truck_yellow.4a7d4051.png"},66:function(e,t,a){e.exports=a.p+"static/media/ambulance.3ff333a4.png"},67:function(e,t,a){e.exports=a.p+"static/media/ambulance_yellow.8b74e8df.png"}},[[127,1,2]]]);
//# sourceMappingURL=main.cc626b6b.chunk.js.map